<style> code { white-space: pre-wrap; display: block; background-color: #eee; }.executed { background-color: #afa; }.reverted { background-color: #ffa; }.unexecuted { background-color: #faa; }.neutral { background-color: #eee; }</style><b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/lib/openzeppelin-contracts/contracts/access/AccessControl.sol</b>
<code>
   1 |     | <span class='unexecuted'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'></span>
   3 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
   4 |     | <span class='neutral'></span>
   5 |     | <span class='neutral'>import &quot;./IAccessControl.sol&quot;;</span>
   6 |     | <span class='neutral'>import &quot;../utils/Context.sol&quot;;</span>
   7 |     | <span class='neutral'>import &quot;../utils/Strings.sol&quot;;</span>
   8 |     | <span class='neutral'>import &quot;../utils/introspection/ERC165.sol&quot;;</span>
   9 |     | <span class='neutral'></span>
  10 |     | <span class='neutral'>/**</span>
  11 |     | <span class='neutral'> * @dev Contract module that allows children to implement role-based access</span>
  12 |     | <span class='neutral'> * control mechanisms. This is a lightweight version that doesn&#39;t allow enumerating role</span>
  13 |     | <span class='neutral'> * members except through off-chain means by accessing the contract event logs. Some</span>
  14 |     | <span class='neutral'> * applications may benefit from on-chain enumerability, for those cases see</span>
  15 |     | <span class='neutral'> * {AccessControlEnumerable}.</span>
  16 |     | <span class='neutral'> *</span>
  17 |     | <span class='neutral'> * Roles are referred to by their `bytes32` identifier. These should be exposed</span>
  18 |     | <span class='neutral'> * in the external API and be unique. The best way to achieve this is by</span>
  19 |     | <span class='neutral'> * using `public constant` hash digests:</span>
  20 |     | <span class='neutral'> *</span>
  21 |     | <span class='neutral'> * ```</span>
  22 |     | <span class='neutral'> * bytes32 public constant MY_ROLE = keccak256(&quot;MY_ROLE&quot;);</span>
  23 |     | <span class='neutral'> * ```</span>
  24 |     | <span class='neutral'> *</span>
  25 |     | <span class='neutral'> * Roles can be used to represent a set of permissions. To restrict access to a</span>
  26 |     | <span class='neutral'> * function call, use {hasRole}:</span>
  27 |     | <span class='neutral'> *</span>
  28 |     | <span class='neutral'> * ```</span>
  29 |     | <span class='neutral'> * function foo() public {</span>
  30 |     | <span class='neutral'> *     require(hasRole(MY_ROLE, msg.sender));</span>
  31 |     | <span class='neutral'> *     ...</span>
  32 |     | <span class='neutral'> * }</span>
  33 |     | <span class='neutral'> * ```</span>
  34 |     | <span class='neutral'> *</span>
  35 |     | <span class='neutral'> * Roles can be granted and revoked dynamically via the {grantRole} and</span>
  36 |     | <span class='neutral'> * {revokeRole} functions. Each role has an associated admin role, and only</span>
  37 |     | <span class='neutral'> * accounts that have a role&#39;s admin role can call {grantRole} and {revokeRole}.</span>
  38 |     | <span class='neutral'> *</span>
  39 |     | <span class='neutral'> * By default, the admin role for all roles is `DEFAULT_ADMIN_ROLE`, which means</span>
  40 |     | <span class='neutral'> * that only accounts with this role will be able to grant or revoke other</span>
  41 |     | <span class='neutral'> * roles. More complex role relationships can be created by using</span>
  42 |     | <span class='neutral'> * {_setRoleAdmin}.</span>
  43 |     | <span class='neutral'> *</span>
  44 |     | <span class='neutral'> * WARNING: The `DEFAULT_ADMIN_ROLE` is also its own admin: it has permission to</span>
  45 |     | <span class='neutral'> * grant and revoke this role. Extra precautions should be taken to secure</span>
  46 |     | <span class='neutral'> * accounts that have been granted it.</span>
  47 |     | <span class='neutral'> */</span>
  48 |     | <span class='neutral'>abstract contract AccessControl is Context, IAccessControl, ERC165 {</span>
  49 |     | <span class='neutral'>    struct RoleData {</span>
  50 |     | <span class='neutral'>        mapping(address =&gt; bool) members;</span>
  51 |     | <span class='neutral'>        bytes32 adminRole;</span>
  52 |     | <span class='neutral'>    }</span>
  53 |     | <span class='neutral'></span>
  54 |     | <span class='neutral'>    mapping(bytes32 =&gt; RoleData) private _roles;</span>
  55 |     | <span class='neutral'></span>
  56 | *   | <span class='executed'>    bytes32 public constant DEFAULT_ADMIN_ROLE = 0x00;</span>
  57 |     | <span class='neutral'></span>
  58 |     | <span class='neutral'>    /**</span>
  59 |     | <span class='neutral'>     * @dev Modifier that checks that an account has a specific role. Reverts</span>
  60 |     | <span class='neutral'>     * with a standardized message including the required role.</span>
  61 |     | <span class='neutral'>     *</span>
  62 |     | <span class='neutral'>     * The format of the revert reason is given by the following regular expression:</span>
  63 |     | <span class='neutral'>     *</span>
  64 |     | <span class='neutral'>     *  /^AccessControl: account (0x[0-9a-f]{40}) is missing role (0x[0-9a-f]{64})$/</span>
  65 |     | <span class='neutral'>     *</span>
  66 |     | <span class='neutral'>     * _Available since v4.1._</span>
  67 |     | <span class='neutral'>     */</span>
  68 |     | <span class='neutral'>    modifier onlyRole(bytes32 role) {</span>
  69 | *   | <span class='executed'>        _checkRole(role, _msgSender());</span>
  70 |     | <span class='neutral'>        _;</span>
  71 |     | <span class='neutral'>    }</span>
  72 |     | <span class='neutral'></span>
  73 |     | <span class='neutral'>    /**</span>
  74 |     | <span class='neutral'>     * @dev See {IERC165-supportsInterface}.</span>
  75 |     | <span class='neutral'>     */</span>
  76 | *   | <span class='executed'>    function supportsInterface(bytes4 interfaceId) public view virtual override returns (bool) {</span>
  77 | *   | <span class='executed'>        return interfaceId == type(IAccessControl).interfaceId || super.supportsInterface(interfaceId);</span>
  78 |     | <span class='neutral'>    }</span>
  79 |     | <span class='neutral'></span>
  80 |     | <span class='neutral'>    /**</span>
  81 |     | <span class='neutral'>     * @dev Returns `true` if `account` has been granted `role`.</span>
  82 |     | <span class='neutral'>     */</span>
  83 | *   | <span class='executed'>    function hasRole(bytes32 role, address account) public view override returns (bool) {</span>
  84 | *   | <span class='executed'>        return _roles[role].members[account];</span>
  85 |     | <span class='neutral'>    }</span>
  86 |     | <span class='neutral'></span>
  87 |     | <span class='neutral'>    /**</span>
  88 |     | <span class='neutral'>     * @dev Revert with a standard message if `account` is missing `role`.</span>
  89 |     | <span class='neutral'>     *</span>
  90 |     | <span class='neutral'>     * The format of the revert reason is given by the following regular expression:</span>
  91 |     | <span class='neutral'>     *</span>
  92 |     | <span class='neutral'>     *  /^AccessControl: account (0x[0-9a-f]{40}) is missing role (0x[0-9a-f]{64})$/</span>
  93 |     | <span class='neutral'>     */</span>
  94 | *   | <span class='executed'>    function _checkRole(bytes32 role, address account) internal view {</span>
  95 | *   | <span class='executed'>        if (!hasRole(role, account)) {</span>
  96 | *r  | <span class='executed'>            revert(</span>
  97 |     | <span class='neutral'>                string(</span>
  98 | *   | <span class='executed'>                    abi.encodePacked(</span>
  99 |     | <span class='neutral'>                        &quot;AccessControl: account &quot;,</span>
 100 | *   | <span class='executed'>                        Strings.toHexString(uint160(account), 20),</span>
 101 |     | <span class='neutral'>                        &quot; is missing role &quot;,</span>
 102 | *   | <span class='executed'>                        Strings.toHexString(uint256(role), 32)</span>
 103 |     | <span class='neutral'>                    )</span>
 104 |     | <span class='neutral'>                )</span>
 105 |     | <span class='neutral'>            );</span>
 106 |     | <span class='neutral'>        }</span>
 107 |     | <span class='neutral'>    }</span>
 108 |     | <span class='neutral'></span>
 109 |     | <span class='neutral'>    /**</span>
 110 |     | <span class='neutral'>     * @dev Returns the admin role that controls `role`. See {grantRole} and</span>
 111 |     | <span class='neutral'>     * {revokeRole}.</span>
 112 |     | <span class='neutral'>     *</span>
 113 |     | <span class='neutral'>     * To change a role&#39;s admin, use {_setRoleAdmin}.</span>
 114 |     | <span class='neutral'>     */</span>
 115 | *   | <span class='executed'>    function getRoleAdmin(bytes32 role) public view override returns (bytes32) {</span>
 116 | *   | <span class='executed'>        return _roles[role].adminRole;</span>
 117 |     | <span class='neutral'>    }</span>
 118 |     | <span class='neutral'></span>
 119 |     | <span class='neutral'>    /**</span>
 120 |     | <span class='neutral'>     * @dev Grants `role` to `account`.</span>
 121 |     | <span class='neutral'>     *</span>
 122 |     | <span class='neutral'>     * If `account` had not been already granted `role`, emits a {RoleGranted}</span>
 123 |     | <span class='neutral'>     * event.</span>
 124 |     | <span class='neutral'>     *</span>
 125 |     | <span class='neutral'>     * Requirements:</span>
 126 |     | <span class='neutral'>     *</span>
 127 |     | <span class='neutral'>     * - the caller must have ``role``&#39;s admin role.</span>
 128 |     | <span class='neutral'>     */</span>
 129 | *   | <span class='executed'>    function grantRole(bytes32 role, address account) public virtual override onlyRole(getRoleAdmin(role)) {</span>
 130 |     | <span class='unexecuted'>        _grantRole(role, account);</span>
 131 |     | <span class='neutral'>    }</span>
 132 |     | <span class='neutral'></span>
 133 |     | <span class='neutral'>    /**</span>
 134 |     | <span class='neutral'>     * @dev Revokes `role` from `account`.</span>
 135 |     | <span class='neutral'>     *</span>
 136 |     | <span class='neutral'>     * If `account` had been granted `role`, emits a {RoleRevoked} event.</span>
 137 |     | <span class='neutral'>     *</span>
 138 |     | <span class='neutral'>     * Requirements:</span>
 139 |     | <span class='neutral'>     *</span>
 140 |     | <span class='neutral'>     * - the caller must have ``role``&#39;s admin role.</span>
 141 |     | <span class='neutral'>     */</span>
 142 | *   | <span class='executed'>    function revokeRole(bytes32 role, address account) public virtual override onlyRole(getRoleAdmin(role)) {</span>
 143 |     | <span class='unexecuted'>        _revokeRole(role, account);</span>
 144 |     | <span class='neutral'>    }</span>
 145 |     | <span class='neutral'></span>
 146 |     | <span class='neutral'>    /**</span>
 147 |     | <span class='neutral'>     * @dev Revokes `role` from the calling account.</span>
 148 |     | <span class='neutral'>     *</span>
 149 |     | <span class='neutral'>     * Roles are often managed via {grantRole} and {revokeRole}: this function&#39;s</span>
 150 |     | <span class='neutral'>     * purpose is to provide a mechanism for accounts to lose their privileges</span>
 151 |     | <span class='neutral'>     * if they are compromised (such as when a trusted device is misplaced).</span>
 152 |     | <span class='neutral'>     *</span>
 153 |     | <span class='neutral'>     * If the calling account had been granted `role`, emits a {RoleRevoked}</span>
 154 |     | <span class='neutral'>     * event.</span>
 155 |     | <span class='neutral'>     *</span>
 156 |     | <span class='neutral'>     * Requirements:</span>
 157 |     | <span class='neutral'>     *</span>
 158 |     | <span class='neutral'>     * - the caller must be `account`.</span>
 159 |     | <span class='neutral'>     */</span>
 160 | *   | <span class='executed'>    function renounceRole(bytes32 role, address account) public virtual override {</span>
 161 | *r  | <span class='executed'>        require(account == _msgSender(), &quot;AccessControl: can only renounce roles for self&quot;);</span>
 162 |     | <span class='neutral'></span>
 163 | *   | <span class='executed'>        _revokeRole(role, account);</span>
 164 |     | <span class='neutral'>    }</span>
 165 |     | <span class='neutral'></span>
 166 |     | <span class='neutral'>    /**</span>
 167 |     | <span class='neutral'>     * @dev Grants `role` to `account`.</span>
 168 |     | <span class='neutral'>     *</span>
 169 |     | <span class='neutral'>     * If `account` had not been already granted `role`, emits a {RoleGranted}</span>
 170 |     | <span class='neutral'>     * event. Note that unlike {grantRole}, this function doesn&#39;t perform any</span>
 171 |     | <span class='neutral'>     * checks on the calling account.</span>
 172 |     | <span class='neutral'>     *</span>
 173 |     | <span class='neutral'>     * [WARNING]</span>
 174 |     | <span class='neutral'>     * ====</span>
 175 |     | <span class='neutral'>     * This function should only be called from the constructor when setting</span>
 176 |     | <span class='neutral'>     * up the initial roles for the system.</span>
 177 |     | <span class='neutral'>     *</span>
 178 |     | <span class='neutral'>     * Using this function in any other way is effectively circumventing the admin</span>
 179 |     | <span class='neutral'>     * system imposed by {AccessControl}.</span>
 180 |     | <span class='neutral'>     * ====</span>
 181 |     | <span class='neutral'>     */</span>
 182 | *   | <span class='executed'>    function _setupRole(bytes32 role, address account) internal virtual {</span>
 183 | *   | <span class='executed'>        _grantRole(role, account);</span>
 184 |     | <span class='neutral'>    }</span>
 185 |     | <span class='neutral'></span>
 186 |     | <span class='neutral'>    /**</span>
 187 |     | <span class='neutral'>     * @dev Sets `adminRole` as ``role``&#39;s admin role.</span>
 188 |     | <span class='neutral'>     *</span>
 189 |     | <span class='neutral'>     * Emits a {RoleAdminChanged} event.</span>
 190 |     | <span class='neutral'>     */</span>
 191 |     | <span class='neutral'>    function _setRoleAdmin(bytes32 role, bytes32 adminRole) internal virtual {</span>
 192 |     | <span class='neutral'>        bytes32 previousAdminRole = getRoleAdmin(role);</span>
 193 |     | <span class='neutral'>        _roles[role].adminRole = adminRole;</span>
 194 |     | <span class='neutral'>        emit RoleAdminChanged(role, previousAdminRole, adminRole);</span>
 195 |     | <span class='neutral'>    }</span>
 196 |     | <span class='neutral'></span>
 197 | *   | <span class='executed'>    function _grantRole(bytes32 role, address account) private {</span>
 198 | *   | <span class='executed'>        if (!hasRole(role, account)) {</span>
 199 | *   | <span class='executed'>            _roles[role].members[account] = true;</span>
 200 | *   | <span class='executed'>            emit RoleGranted(role, account, _msgSender());</span>
 201 |     | <span class='neutral'>        }</span>
 202 |     | <span class='neutral'>    }</span>
 203 |     | <span class='neutral'></span>
 204 | *   | <span class='executed'>    function _revokeRole(bytes32 role, address account) private {</span>
 205 | *   | <span class='executed'>        if (hasRole(role, account)) {</span>
 206 |     | <span class='unexecuted'>            _roles[role].members[account] = false;</span>
 207 |     | <span class='unexecuted'>            emit RoleRevoked(role, account, _msgSender());</span>
 208 |     | <span class='neutral'>        }</span>
 209 |     | <span class='neutral'>    }</span>
 210 |     | <span class='neutral'>}</span>
 211 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/lib/openzeppelin-contracts/contracts/access/IAccessControl.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v5.1.0) (access/IAccessControl.sol)</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>pragma solidity ^0.8.20;</span>
   5 |     | <span class='neutral'></span>
   6 |     | <span class='neutral'>/**</span>
   7 |     | <span class='neutral'> * @dev External interface of AccessControl declared to support ERC-165 detection.</span>
   8 |     | <span class='neutral'> */</span>
   9 |     | <span class='neutral'>interface IAccessControl {</span>
  10 |     | <span class='neutral'>    /**</span>
  11 |     | <span class='neutral'>     * @dev The `account` is missing a role.</span>
  12 |     | <span class='neutral'>     */</span>
  13 |     | <span class='neutral'>    error AccessControlUnauthorizedAccount(address account, bytes32 neededRole);</span>
  14 |     | <span class='neutral'></span>
  15 |     | <span class='neutral'>    /**</span>
  16 |     | <span class='neutral'>     * @dev The caller of a function is not the expected one.</span>
  17 |     | <span class='neutral'>     *</span>
  18 |     | <span class='neutral'>     * NOTE: Don&#39;t confuse with {AccessControlUnauthorizedAccount}.</span>
  19 |     | <span class='neutral'>     */</span>
  20 |     | <span class='neutral'>    error AccessControlBadConfirmation();</span>
  21 |     | <span class='neutral'></span>
  22 |     | <span class='neutral'>    /**</span>
  23 |     | <span class='neutral'>     * @dev Emitted when `newAdminRole` is set as ``role``&#39;s admin role, replacing `previousAdminRole`</span>
  24 |     | <span class='neutral'>     *</span>
  25 |     | <span class='neutral'>     * `DEFAULT_ADMIN_ROLE` is the starting admin for all roles, despite</span>
  26 |     | <span class='neutral'>     * {RoleAdminChanged} not being emitted signaling this.</span>
  27 |     | <span class='neutral'>     */</span>
  28 |     | <span class='neutral'>    event RoleAdminChanged(bytes32 indexed role, bytes32 indexed previousAdminRole, bytes32 indexed newAdminRole);</span>
  29 |     | <span class='neutral'></span>
  30 |     | <span class='neutral'>    /**</span>
  31 |     | <span class='neutral'>     * @dev Emitted when `account` is granted `role`.</span>
  32 |     | <span class='neutral'>     *</span>
  33 |     | <span class='neutral'>     * `sender` is the account that originated the contract call. This account bears the admin role (for the granted role).</span>
  34 |     | <span class='neutral'>     * Expected in cases where the role was granted using the internal {AccessControl-_grantRole}.</span>
  35 |     | <span class='neutral'>     */</span>
  36 |     | <span class='neutral'>    event RoleGranted(bytes32 indexed role, address indexed account, address indexed sender);</span>
  37 |     | <span class='neutral'></span>
  38 |     | <span class='neutral'>    /**</span>
  39 |     | <span class='neutral'>     * @dev Emitted when `account` is revoked `role`.</span>
  40 |     | <span class='neutral'>     *</span>
  41 |     | <span class='neutral'>     * `sender` is the account that originated the contract call:</span>
  42 |     | <span class='neutral'>     *   - if using `revokeRole`, it is the admin role bearer</span>
  43 |     | <span class='neutral'>     *   - if using `renounceRole`, it is the role bearer (i.e. `account`)</span>
  44 |     | <span class='neutral'>     */</span>
  45 |     | <span class='neutral'>    event RoleRevoked(bytes32 indexed role, address indexed account, address indexed sender);</span>
  46 |     | <span class='neutral'></span>
  47 |     | <span class='neutral'>    /**</span>
  48 |     | <span class='neutral'>     * @dev Returns `true` if `account` has been granted `role`.</span>
  49 |     | <span class='neutral'>     */</span>
  50 |     | <span class='neutral'>    function hasRole(bytes32 role, address account) external view returns (bool);</span>
  51 |     | <span class='neutral'></span>
  52 |     | <span class='neutral'>    /**</span>
  53 |     | <span class='neutral'>     * @dev Returns the admin role that controls `role`. See {grantRole} and</span>
  54 |     | <span class='neutral'>     * {revokeRole}.</span>
  55 |     | <span class='neutral'>     *</span>
  56 |     | <span class='neutral'>     * To change a role&#39;s admin, use {AccessControl-_setRoleAdmin}.</span>
  57 |     | <span class='neutral'>     */</span>
  58 |     | <span class='neutral'>    function getRoleAdmin(bytes32 role) external view returns (bytes32);</span>
  59 |     | <span class='neutral'></span>
  60 |     | <span class='neutral'>    /**</span>
  61 |     | <span class='neutral'>     * @dev Grants `role` to `account`.</span>
  62 |     | <span class='neutral'>     *</span>
  63 |     | <span class='neutral'>     * If `account` had not been already granted `role`, emits a {RoleGranted}</span>
  64 |     | <span class='neutral'>     * event.</span>
  65 |     | <span class='neutral'>     *</span>
  66 |     | <span class='neutral'>     * Requirements:</span>
  67 |     | <span class='neutral'>     *</span>
  68 |     | <span class='neutral'>     * - the caller must have ``role``&#39;s admin role.</span>
  69 |     | <span class='neutral'>     */</span>
  70 |     | <span class='neutral'>    function grantRole(bytes32 role, address account) external;</span>
  71 |     | <span class='neutral'></span>
  72 |     | <span class='neutral'>    /**</span>
  73 |     | <span class='neutral'>     * @dev Revokes `role` from `account`.</span>
  74 |     | <span class='neutral'>     *</span>
  75 |     | <span class='neutral'>     * If `account` had been granted `role`, emits a {RoleRevoked} event.</span>
  76 |     | <span class='neutral'>     *</span>
  77 |     | <span class='neutral'>     * Requirements:</span>
  78 |     | <span class='neutral'>     *</span>
  79 |     | <span class='neutral'>     * - the caller must have ``role``&#39;s admin role.</span>
  80 |     | <span class='neutral'>     */</span>
  81 |     | <span class='neutral'>    function revokeRole(bytes32 role, address account) external;</span>
  82 |     | <span class='neutral'></span>
  83 |     | <span class='neutral'>    /**</span>
  84 |     | <span class='neutral'>     * @dev Revokes `role` from the calling account.</span>
  85 |     | <span class='neutral'>     *</span>
  86 |     | <span class='neutral'>     * Roles are often managed via {grantRole} and {revokeRole}: this function&#39;s</span>
  87 |     | <span class='neutral'>     * purpose is to provide a mechanism for accounts to lose their privileges</span>
  88 |     | <span class='neutral'>     * if they are compromised (such as when a trusted device is misplaced).</span>
  89 |     | <span class='neutral'>     *</span>
  90 |     | <span class='neutral'>     * If the calling account had been granted `role`, emits a {RoleRevoked}</span>
  91 |     | <span class='neutral'>     * event.</span>
  92 |     | <span class='neutral'>     *</span>
  93 |     | <span class='neutral'>     * Requirements:</span>
  94 |     | <span class='neutral'>     *</span>
  95 |     | <span class='neutral'>     * - the caller must be `callerConfirmation`.</span>
  96 |     | <span class='neutral'>     */</span>
  97 |     | <span class='neutral'>    function renounceRole(bytes32 role, address callerConfirmation) external;</span>
  98 |     | <span class='neutral'>}</span>
  99 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'></span>
   3 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
   4 |     | <span class='neutral'></span>
   5 |     | <span class='neutral'>import &quot;./IERC20.sol&quot;;</span>
   6 |     | <span class='neutral'>import &quot;./extensions/IERC20Metadata.sol&quot;;</span>
   7 |     | <span class='neutral'>import &quot;../../utils/Context.sol&quot;;</span>
   8 |     | <span class='neutral'></span>
   9 |     | <span class='neutral'>/**</span>
  10 |     | <span class='neutral'> * @dev Implementation of the {IERC20} interface.</span>
  11 |     | <span class='neutral'> *</span>
  12 |     | <span class='neutral'> * This implementation is agnostic to the way tokens are created. This means</span>
  13 |     | <span class='neutral'> * that a supply mechanism has to be added in a derived contract using {_mint}.</span>
  14 |     | <span class='neutral'> * For a generic mechanism see {ERC20PresetMinterPauser}.</span>
  15 |     | <span class='neutral'> *</span>
  16 |     | <span class='neutral'> * TIP: For a detailed writeup see our guide</span>
  17 |     | <span class='neutral'> * https://forum.zeppelin.solutions/t/how-to-implement-erc20-supply-mechanisms/226[How</span>
  18 |     | <span class='neutral'> * to implement supply mechanisms].</span>
  19 |     | <span class='neutral'> *</span>
  20 |     | <span class='neutral'> * We have followed general OpenZeppelin Contracts guidelines: functions revert</span>
  21 |     | <span class='neutral'> * instead returning `false` on failure. This behavior is nonetheless</span>
  22 |     | <span class='neutral'> * conventional and does not conflict with the expectations of ERC20</span>
  23 |     | <span class='neutral'> * applications.</span>
  24 |     | <span class='neutral'> *</span>
  25 |     | <span class='neutral'> * Additionally, an {Approval} event is emitted on calls to {transferFrom}.</span>
  26 |     | <span class='neutral'> * This allows applications to reconstruct the allowance for all accounts just</span>
  27 |     | <span class='neutral'> * by listening to said events. Other implementations of the EIP may not emit</span>
  28 |     | <span class='neutral'> * these events, as it isn&#39;t required by the specification.</span>
  29 |     | <span class='neutral'> *</span>
  30 |     | <span class='neutral'> * Finally, the non-standard {decreaseAllowance} and {increaseAllowance}</span>
  31 |     | <span class='neutral'> * functions have been added to mitigate the well-known issues around setting</span>
  32 |     | <span class='neutral'> * allowances. See {IERC20-approve}.</span>
  33 |     | <span class='neutral'> */</span>
  34 | *r  | <span class='executed'>contract ERC20 is Context, IERC20, IERC20Metadata {</span>
  35 |     | <span class='neutral'>    mapping(address =&gt; uint256) private _balances;</span>
  36 |     | <span class='neutral'></span>
  37 |     | <span class='neutral'>    mapping(address =&gt; mapping(address =&gt; uint256)) private _allowances;</span>
  38 |     | <span class='neutral'></span>
  39 |     | <span class='neutral'>    uint256 private _totalSupply;</span>
  40 |     | <span class='neutral'></span>
  41 |     | <span class='neutral'>    string private _name;</span>
  42 |     | <span class='neutral'>    string private _symbol;</span>
  43 |     | <span class='neutral'></span>
  44 |     | <span class='neutral'>    /**</span>
  45 |     | <span class='neutral'>     * @dev Sets the values for {name} and {symbol}.</span>
  46 |     | <span class='neutral'>     *</span>
  47 |     | <span class='neutral'>     * The default value of {decimals} is 18. To select a different value for</span>
  48 |     | <span class='neutral'>     * {decimals} you should overload it.</span>
  49 |     | <span class='neutral'>     *</span>
  50 |     | <span class='neutral'>     * All two of these values are immutable: they can only be set once during</span>
  51 |     | <span class='neutral'>     * construction.</span>
  52 |     | <span class='neutral'>     */</span>
  53 | *   | <span class='executed'>    constructor(string memory name_, string memory symbol_) {</span>
  54 | *   | <span class='executed'>        _name = name_;</span>
  55 | *   | <span class='executed'>        _symbol = symbol_;</span>
  56 |     | <span class='neutral'>    }</span>
  57 |     | <span class='neutral'></span>
  58 |     | <span class='neutral'>    /**</span>
  59 |     | <span class='neutral'>     * @dev Returns the name of the token.</span>
  60 |     | <span class='neutral'>     */</span>
  61 | *   | <span class='executed'>    function name() public view virtual override returns (string memory) {</span>
  62 | *   | <span class='executed'>        return _name;</span>
  63 |     | <span class='neutral'>    }</span>
  64 |     | <span class='neutral'></span>
  65 |     | <span class='neutral'>    /**</span>
  66 |     | <span class='neutral'>     * @dev Returns the symbol of the token, usually a shorter version of the</span>
  67 |     | <span class='neutral'>     * name.</span>
  68 |     | <span class='neutral'>     */</span>
  69 | *   | <span class='executed'>    function symbol() public view virtual override returns (string memory) {</span>
  70 | *   | <span class='executed'>        return _symbol;</span>
  71 |     | <span class='neutral'>    }</span>
  72 |     | <span class='neutral'></span>
  73 |     | <span class='neutral'>    /**</span>
  74 |     | <span class='neutral'>     * @dev Returns the number of decimals used to get its user representation.</span>
  75 |     | <span class='neutral'>     * For example, if `decimals` equals `2`, a balance of `505` tokens should</span>
  76 |     | <span class='neutral'>     * be displayed to a user as `5.05` (`505 / 10 ** 2`).</span>
  77 |     | <span class='neutral'>     *</span>
  78 |     | <span class='neutral'>     * Tokens usually opt for a value of 18, imitating the relationship between</span>
  79 |     | <span class='neutral'>     * Ether and Wei. This is the value {ERC20} uses, unless this function is</span>
  80 |     | <span class='neutral'>     * overridden;</span>
  81 |     | <span class='neutral'>     *</span>
  82 |     | <span class='neutral'>     * NOTE: This information is only used for _display_ purposes: it in</span>
  83 |     | <span class='neutral'>     * no way affects any of the arithmetic of the contract, including</span>
  84 |     | <span class='neutral'>     * {IERC20-balanceOf} and {IERC20-transfer}.</span>
  85 |     | <span class='neutral'>     */</span>
  86 | *   | <span class='executed'>    function decimals() public view virtual override returns (uint8) {</span>
  87 | *   | <span class='executed'>        return 18;</span>
  88 |     | <span class='neutral'>    }</span>
  89 |     | <span class='neutral'></span>
  90 |     | <span class='neutral'>    /**</span>
  91 |     | <span class='neutral'>     * @dev See {IERC20-totalSupply}.</span>
  92 |     | <span class='neutral'>     */</span>
  93 | *   | <span class='executed'>    function totalSupply() public view virtual override returns (uint256) {</span>
  94 | *   | <span class='executed'>        return _totalSupply;</span>
  95 |     | <span class='neutral'>    }</span>
  96 |     | <span class='neutral'></span>
  97 |     | <span class='neutral'>    /**</span>
  98 |     | <span class='neutral'>     * @dev See {IERC20-balanceOf}.</span>
  99 |     | <span class='neutral'>     */</span>
 100 | *   | <span class='executed'>    function balanceOf(address account) public view virtual override returns (uint256) {</span>
 101 | *   | <span class='executed'>        return _balances[account];</span>
 102 |     | <span class='neutral'>    }</span>
 103 |     | <span class='neutral'></span>
 104 |     | <span class='neutral'>    /**</span>
 105 |     | <span class='neutral'>     * @dev See {IERC20-transfer}.</span>
 106 |     | <span class='neutral'>     *</span>
 107 |     | <span class='neutral'>     * Requirements:</span>
 108 |     | <span class='neutral'>     *</span>
 109 |     | <span class='neutral'>     * - `recipient` cannot be the zero address.</span>
 110 |     | <span class='neutral'>     * - the caller must have a balance of at least `amount`.</span>
 111 |     | <span class='neutral'>     */</span>
 112 | *   | <span class='executed'>    function transfer(address recipient, uint256 amount) public virtual override returns (bool) {</span>
 113 | *   | <span class='executed'>        _transfer(_msgSender(), recipient, amount);</span>
 114 | *   | <span class='executed'>        return true;</span>
 115 |     | <span class='neutral'>    }</span>
 116 |     | <span class='neutral'></span>
 117 |     | <span class='neutral'>    /**</span>
 118 |     | <span class='neutral'>     * @dev See {IERC20-allowance}.</span>
 119 |     | <span class='neutral'>     */</span>
 120 | *   | <span class='executed'>    function allowance(address owner, address spender) public view virtual override returns (uint256) {</span>
 121 | *   | <span class='executed'>        return _allowances[owner][spender];</span>
 122 |     | <span class='neutral'>    }</span>
 123 |     | <span class='neutral'></span>
 124 |     | <span class='neutral'>    /**</span>
 125 |     | <span class='neutral'>     * @dev See {IERC20-approve}.</span>
 126 |     | <span class='neutral'>     *</span>
 127 |     | <span class='neutral'>     * Requirements:</span>
 128 |     | <span class='neutral'>     *</span>
 129 |     | <span class='neutral'>     * - `spender` cannot be the zero address.</span>
 130 |     | <span class='neutral'>     */</span>
 131 | *   | <span class='executed'>    function approve(address spender, uint256 amount) public virtual override returns (bool) {</span>
 132 | *   | <span class='executed'>        _approve(_msgSender(), spender, amount);</span>
 133 | *   | <span class='executed'>        return true;</span>
 134 |     | <span class='neutral'>    }</span>
 135 |     | <span class='neutral'></span>
 136 |     | <span class='neutral'>    /**</span>
 137 |     | <span class='neutral'>     * @dev See {IERC20-transferFrom}.</span>
 138 |     | <span class='neutral'>     *</span>
 139 |     | <span class='neutral'>     * Emits an {Approval} event indicating the updated allowance. This is not</span>
 140 |     | <span class='neutral'>     * required by the EIP. See the note at the beginning of {ERC20}.</span>
 141 |     | <span class='neutral'>     *</span>
 142 |     | <span class='neutral'>     * Requirements:</span>
 143 |     | <span class='neutral'>     *</span>
 144 |     | <span class='neutral'>     * - `sender` and `recipient` cannot be the zero address.</span>
 145 |     | <span class='neutral'>     * - `sender` must have a balance of at least `amount`.</span>
 146 |     | <span class='neutral'>     * - the caller must have allowance for ``sender``&#39;s tokens of at least</span>
 147 |     | <span class='neutral'>     * `amount`.</span>
 148 |     | <span class='neutral'>     */</span>
 149 | *   | <span class='executed'>    function transferFrom(</span>
 150 |     | <span class='neutral'>        address sender,</span>
 151 |     | <span class='neutral'>        address recipient,</span>
 152 |     | <span class='neutral'>        uint256 amount</span>
 153 | *   | <span class='executed'>    ) public virtual override returns (bool) {</span>
 154 | *   | <span class='executed'>        _transfer(sender, recipient, amount);</span>
 155 |     | <span class='neutral'></span>
 156 | *   | <span class='executed'>        uint256 currentAllowance = _allowances[sender][_msgSender()];</span>
 157 | *   | <span class='executed'>        require(currentAllowance &gt;= amount, &quot;ERC20: transfer amount exceeds allowance&quot;);</span>
 158 |     | <span class='neutral'>        unchecked {</span>
 159 | *   | <span class='executed'>            _approve(sender, _msgSender(), currentAllowance - amount);</span>
 160 |     | <span class='neutral'>        }</span>
 161 |     | <span class='neutral'></span>
 162 | *   | <span class='executed'>        return true;</span>
 163 |     | <span class='neutral'>    }</span>
 164 |     | <span class='neutral'></span>
 165 |     | <span class='neutral'>    /**</span>
 166 |     | <span class='neutral'>     * @dev Atomically increases the allowance granted to `spender` by the caller.</span>
 167 |     | <span class='neutral'>     *</span>
 168 |     | <span class='neutral'>     * This is an alternative to {approve} that can be used as a mitigation for</span>
 169 |     | <span class='neutral'>     * problems described in {IERC20-approve}.</span>
 170 |     | <span class='neutral'>     *</span>
 171 |     | <span class='neutral'>     * Emits an {Approval} event indicating the updated allowance.</span>
 172 |     | <span class='neutral'>     *</span>
 173 |     | <span class='neutral'>     * Requirements:</span>
 174 |     | <span class='neutral'>     *</span>
 175 |     | <span class='neutral'>     * - `spender` cannot be the zero address.</span>
 176 |     | <span class='neutral'>     */</span>
 177 | *   | <span class='executed'>    function increaseAllowance(address spender, uint256 addedValue) public virtual returns (bool) {</span>
 178 | *   | <span class='executed'>        _approve(_msgSender(), spender, _allowances[_msgSender()][spender] + addedValue);</span>
 179 | *   | <span class='executed'>        return true;</span>
 180 |     | <span class='neutral'>    }</span>
 181 |     | <span class='neutral'></span>
 182 |     | <span class='neutral'>    /**</span>
 183 |     | <span class='neutral'>     * @dev Atomically decreases the allowance granted to `spender` by the caller.</span>
 184 |     | <span class='neutral'>     *</span>
 185 |     | <span class='neutral'>     * This is an alternative to {approve} that can be used as a mitigation for</span>
 186 |     | <span class='neutral'>     * problems described in {IERC20-approve}.</span>
 187 |     | <span class='neutral'>     *</span>
 188 |     | <span class='neutral'>     * Emits an {Approval} event indicating the updated allowance.</span>
 189 |     | <span class='neutral'>     *</span>
 190 |     | <span class='neutral'>     * Requirements:</span>
 191 |     | <span class='neutral'>     *</span>
 192 |     | <span class='neutral'>     * - `spender` cannot be the zero address.</span>
 193 |     | <span class='neutral'>     * - `spender` must have allowance for the caller of at least</span>
 194 |     | <span class='neutral'>     * `subtractedValue`.</span>
 195 |     | <span class='neutral'>     */</span>
 196 | *   | <span class='executed'>    function decreaseAllowance(address spender, uint256 subtractedValue) public virtual returns (bool) {</span>
 197 | *   | <span class='executed'>        uint256 currentAllowance = _allowances[_msgSender()][spender];</span>
 198 | *r  | <span class='executed'>        require(currentAllowance &gt;= subtractedValue, &quot;ERC20: decreased allowance below zero&quot;);</span>
 199 |     | <span class='neutral'>        unchecked {</span>
 200 | *   | <span class='executed'>            _approve(_msgSender(), spender, currentAllowance - subtractedValue);</span>
 201 |     | <span class='neutral'>        }</span>
 202 |     | <span class='neutral'></span>
 203 | *   | <span class='executed'>        return true;</span>
 204 |     | <span class='neutral'>    }</span>
 205 |     | <span class='neutral'></span>
 206 |     | <span class='neutral'>    /**</span>
 207 |     | <span class='neutral'>     * @dev Moves `amount` of tokens from `sender` to `recipient`.</span>
 208 |     | <span class='neutral'>     *</span>
 209 |     | <span class='neutral'>     * This internal function is equivalent to {transfer}, and can be used to</span>
 210 |     | <span class='neutral'>     * e.g. implement automatic token fees, slashing mechanisms, etc.</span>
 211 |     | <span class='neutral'>     *</span>
 212 |     | <span class='neutral'>     * Emits a {Transfer} event.</span>
 213 |     | <span class='neutral'>     *</span>
 214 |     | <span class='neutral'>     * Requirements:</span>
 215 |     | <span class='neutral'>     *</span>
 216 |     | <span class='neutral'>     * - `sender` cannot be the zero address.</span>
 217 |     | <span class='neutral'>     * - `recipient` cannot be the zero address.</span>
 218 |     | <span class='neutral'>     * - `sender` must have a balance of at least `amount`.</span>
 219 |     | <span class='neutral'>     */</span>
 220 | *   | <span class='executed'>    function _transfer(</span>
 221 |     | <span class='neutral'>        address sender,</span>
 222 |     | <span class='neutral'>        address recipient,</span>
 223 |     | <span class='neutral'>        uint256 amount</span>
 224 | *   | <span class='executed'>    ) internal virtual {</span>
 225 | *   | <span class='executed'>        require(sender != address(0), &quot;ERC20: transfer from the zero address&quot;);</span>
 226 | *r  | <span class='executed'>        require(recipient != address(0), &quot;ERC20: transfer to the zero address&quot;);</span>
 227 |     | <span class='neutral'></span>
 228 | *   | <span class='executed'>        _beforeTokenTransfer(sender, recipient, amount);</span>
 229 |     | <span class='neutral'></span>
 230 | *   | <span class='executed'>        uint256 senderBalance = _balances[sender];</span>
 231 | *r  | <span class='executed'>        require(senderBalance &gt;= amount, &quot;ERC20: transfer amount exceeds balance&quot;);</span>
 232 |     | <span class='neutral'>        unchecked {</span>
 233 | *   | <span class='executed'>            _balances[sender] = senderBalance - amount;</span>
 234 |     | <span class='neutral'>        }</span>
 235 | *   | <span class='executed'>        _balances[recipient] += amount;</span>
 236 |     | <span class='neutral'></span>
 237 | *   | <span class='executed'>        emit Transfer(sender, recipient, amount);</span>
 238 |     | <span class='neutral'></span>
 239 | *   | <span class='executed'>        _afterTokenTransfer(sender, recipient, amount);</span>
 240 |     | <span class='neutral'>    }</span>
 241 |     | <span class='neutral'></span>
 242 |     | <span class='neutral'>    /** @dev Creates `amount` tokens and assigns them to `account`, increasing</span>
 243 |     | <span class='neutral'>     * the total supply.</span>
 244 |     | <span class='neutral'>     *</span>
 245 |     | <span class='neutral'>     * Emits a {Transfer} event with `from` set to the zero address.</span>
 246 |     | <span class='neutral'>     *</span>
 247 |     | <span class='neutral'>     * Requirements:</span>
 248 |     | <span class='neutral'>     *</span>
 249 |     | <span class='neutral'>     * - `account` cannot be the zero address.</span>
 250 |     | <span class='neutral'>     */</span>
 251 | *   | <span class='executed'>    function _mint(address account, uint256 amount) internal virtual {</span>
 252 | *   | <span class='executed'>        require(account != address(0), &quot;ERC20: mint to the zero address&quot;);</span>
 253 |     | <span class='neutral'></span>
 254 | *   | <span class='executed'>        _beforeTokenTransfer(address(0), account, amount);</span>
 255 |     | <span class='neutral'></span>
 256 | *   | <span class='executed'>        _totalSupply += amount;</span>
 257 | *   | <span class='executed'>        _balances[account] += amount;</span>
 258 | *   | <span class='executed'>        emit Transfer(address(0), account, amount);</span>
 259 |     | <span class='neutral'></span>
 260 | *   | <span class='executed'>        _afterTokenTransfer(address(0), account, amount);</span>
 261 |     | <span class='neutral'>    }</span>
 262 |     | <span class='neutral'></span>
 263 |     | <span class='neutral'>    /**</span>
 264 |     | <span class='neutral'>     * @dev Destroys `amount` tokens from `account`, reducing the</span>
 265 |     | <span class='neutral'>     * total supply.</span>
 266 |     | <span class='neutral'>     *</span>
 267 |     | <span class='neutral'>     * Emits a {Transfer} event with `to` set to the zero address.</span>
 268 |     | <span class='neutral'>     *</span>
 269 |     | <span class='neutral'>     * Requirements:</span>
 270 |     | <span class='neutral'>     *</span>
 271 |     | <span class='neutral'>     * - `account` cannot be the zero address.</span>
 272 |     | <span class='neutral'>     * - `account` must have at least `amount` tokens.</span>
 273 |     | <span class='neutral'>     */</span>
 274 | *   | <span class='executed'>    function _burn(address account, uint256 amount) internal virtual {</span>
 275 | *   | <span class='executed'>        require(account != address(0), &quot;ERC20: burn from the zero address&quot;);</span>
 276 |     | <span class='neutral'></span>
 277 | *   | <span class='executed'>        _beforeTokenTransfer(account, address(0), amount);</span>
 278 |     | <span class='neutral'></span>
 279 | *   | <span class='executed'>        uint256 accountBalance = _balances[account];</span>
 280 | *   | <span class='executed'>        require(accountBalance &gt;= amount, &quot;ERC20: burn amount exceeds balance&quot;);</span>
 281 |     | <span class='neutral'>        unchecked {</span>
 282 | *   | <span class='executed'>            _balances[account] = accountBalance - amount;</span>
 283 |     | <span class='neutral'>        }</span>
 284 | *   | <span class='executed'>        _totalSupply -= amount;</span>
 285 |     | <span class='neutral'></span>
 286 | *   | <span class='executed'>        emit Transfer(account, address(0), amount);</span>
 287 |     | <span class='neutral'></span>
 288 | *   | <span class='executed'>        _afterTokenTransfer(account, address(0), amount);</span>
 289 |     | <span class='neutral'>    }</span>
 290 |     | <span class='neutral'></span>
 291 |     | <span class='neutral'>    /**</span>
 292 |     | <span class='neutral'>     * @dev Sets `amount` as the allowance of `spender` over the `owner` s tokens.</span>
 293 |     | <span class='neutral'>     *</span>
 294 |     | <span class='neutral'>     * This internal function is equivalent to `approve`, and can be used to</span>
 295 |     | <span class='neutral'>     * e.g. set automatic allowances for certain subsystems, etc.</span>
 296 |     | <span class='neutral'>     *</span>
 297 |     | <span class='neutral'>     * Emits an {Approval} event.</span>
 298 |     | <span class='neutral'>     *</span>
 299 |     | <span class='neutral'>     * Requirements:</span>
 300 |     | <span class='neutral'>     *</span>
 301 |     | <span class='neutral'>     * - `owner` cannot be the zero address.</span>
 302 |     | <span class='neutral'>     * - `spender` cannot be the zero address.</span>
 303 |     | <span class='neutral'>     */</span>
 304 | *   | <span class='executed'>    function _approve(</span>
 305 |     | <span class='neutral'>        address owner,</span>
 306 |     | <span class='neutral'>        address spender,</span>
 307 |     | <span class='neutral'>        uint256 amount</span>
 308 |     | <span class='neutral'>    ) internal virtual {</span>
 309 | *   | <span class='executed'>        require(owner != address(0), &quot;ERC20: approve from the zero address&quot;);</span>
 310 | *r  | <span class='executed'>        require(spender != address(0), &quot;ERC20: approve to the zero address&quot;);</span>
 311 |     | <span class='neutral'></span>
 312 | *   | <span class='executed'>        _allowances[owner][spender] = amount;</span>
 313 | *   | <span class='executed'>        emit Approval(owner, spender, amount);</span>
 314 |     | <span class='neutral'>    }</span>
 315 |     | <span class='neutral'></span>
 316 |     | <span class='neutral'>    /**</span>
 317 |     | <span class='neutral'>     * @dev Hook that is called before any transfer of tokens. This includes</span>
 318 |     | <span class='neutral'>     * minting and burning.</span>
 319 |     | <span class='neutral'>     *</span>
 320 |     | <span class='neutral'>     * Calling conditions:</span>
 321 |     | <span class='neutral'>     *</span>
 322 |     | <span class='neutral'>     * - when `from` and `to` are both non-zero, `amount` of ``from``&#39;s tokens</span>
 323 |     | <span class='neutral'>     * will be transferred to `to`.</span>
 324 |     | <span class='neutral'>     * - when `from` is zero, `amount` tokens will be minted for `to`.</span>
 325 |     | <span class='neutral'>     * - when `to` is zero, `amount` of ``from``&#39;s tokens will be burned.</span>
 326 |     | <span class='neutral'>     * - `from` and `to` are never both zero.</span>
 327 |     | <span class='neutral'>     *</span>
 328 |     | <span class='neutral'>     * To learn more about hooks, head to xref:ROOT:extending-contracts.adoc#using-hooks[Using Hooks].</span>
 329 |     | <span class='neutral'>     */</span>
 330 | *   | <span class='executed'>    function _beforeTokenTransfer(</span>
 331 |     | <span class='neutral'>        address from,</span>
 332 |     | <span class='neutral'>        address to,</span>
 333 |     | <span class='neutral'>        uint256 amount</span>
 334 |     | <span class='neutral'>    ) internal virtual {}</span>
 335 |     | <span class='neutral'></span>
 336 |     | <span class='neutral'>    /**</span>
 337 |     | <span class='neutral'>     * @dev Hook that is called after any transfer of tokens. This includes</span>
 338 |     | <span class='neutral'>     * minting and burning.</span>
 339 |     | <span class='neutral'>     *</span>
 340 |     | <span class='neutral'>     * Calling conditions:</span>
 341 |     | <span class='neutral'>     *</span>
 342 |     | <span class='neutral'>     * - when `from` and `to` are both non-zero, `amount` of ``from``&#39;s tokens</span>
 343 |     | <span class='neutral'>     * has been transferred to `to`.</span>
 344 |     | <span class='neutral'>     * - when `from` is zero, `amount` tokens have been minted for `to`.</span>
 345 |     | <span class='neutral'>     * - when `to` is zero, `amount` of ``from``&#39;s tokens have been burned.</span>
 346 |     | <span class='neutral'>     * - `from` and `to` are never both zero.</span>
 347 |     | <span class='neutral'>     *</span>
 348 |     | <span class='neutral'>     * To learn more about hooks, head to xref:ROOT:extending-contracts.adoc#using-hooks[Using Hooks].</span>
 349 |     | <span class='neutral'>     */</span>
 350 | *   | <span class='executed'>    function _afterTokenTransfer(</span>
 351 |     | <span class='neutral'>        address from,</span>
 352 |     | <span class='neutral'>        address to,</span>
 353 |     | <span class='neutral'>        uint256 amount</span>
 354 |     | <span class='neutral'>    ) internal virtual {}</span>
 355 |     | <span class='neutral'>}</span>
 356 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/lib/openzeppelin-contracts/contracts/token/ERC20/IERC20.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'></span>
  3 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  4 |     | <span class='neutral'></span>
  5 |     | <span class='neutral'>/**</span>
  6 |     | <span class='neutral'> * @dev Interface of the ERC20 standard as defined in the EIP.</span>
  7 |     | <span class='neutral'> */</span>
  8 |     | <span class='neutral'>interface IERC20 {</span>
  9 |     | <span class='neutral'>    /**</span>
 10 |     | <span class='neutral'>     * @dev Returns the amount of tokens in existence.</span>
 11 |     | <span class='neutral'>     */</span>
 12 |     | <span class='neutral'>    function totalSupply() external view returns (uint256);</span>
 13 |     | <span class='neutral'></span>
 14 |     | <span class='neutral'>    /**</span>
 15 |     | <span class='neutral'>     * @dev Returns the amount of tokens owned by `account`.</span>
 16 |     | <span class='neutral'>     */</span>
 17 |     | <span class='neutral'>    function balanceOf(address account) external view returns (uint256);</span>
 18 |     | <span class='neutral'></span>
 19 |     | <span class='neutral'>    /**</span>
 20 |     | <span class='neutral'>     * @dev Moves `amount` tokens from the caller&#39;s account to `recipient`.</span>
 21 |     | <span class='neutral'>     *</span>
 22 |     | <span class='neutral'>     * Returns a boolean value indicating whether the operation succeeded.</span>
 23 |     | <span class='neutral'>     *</span>
 24 |     | <span class='neutral'>     * Emits a {Transfer} event.</span>
 25 |     | <span class='neutral'>     */</span>
 26 |     | <span class='neutral'>    function transfer(address recipient, uint256 amount) external returns (bool);</span>
 27 |     | <span class='neutral'></span>
 28 |     | <span class='neutral'>    /**</span>
 29 |     | <span class='neutral'>     * @dev Returns the remaining number of tokens that `spender` will be</span>
 30 |     | <span class='neutral'>     * allowed to spend on behalf of `owner` through {transferFrom}. This is</span>
 31 |     | <span class='neutral'>     * zero by default.</span>
 32 |     | <span class='neutral'>     *</span>
 33 |     | <span class='neutral'>     * This value changes when {approve} or {transferFrom} are called.</span>
 34 |     | <span class='neutral'>     */</span>
 35 |     | <span class='neutral'>    function allowance(address owner, address spender) external view returns (uint256);</span>
 36 |     | <span class='neutral'></span>
 37 |     | <span class='neutral'>    /**</span>
 38 |     | <span class='neutral'>     * @dev Sets `amount` as the allowance of `spender` over the caller&#39;s tokens.</span>
 39 |     | <span class='neutral'>     *</span>
 40 |     | <span class='neutral'>     * Returns a boolean value indicating whether the operation succeeded.</span>
 41 |     | <span class='neutral'>     *</span>
 42 |     | <span class='neutral'>     * IMPORTANT: Beware that changing an allowance with this method brings the risk</span>
 43 |     | <span class='neutral'>     * that someone may use both the old and the new allowance by unfortunate</span>
 44 |     | <span class='neutral'>     * transaction ordering. One possible solution to mitigate this race</span>
 45 |     | <span class='neutral'>     * condition is to first reduce the spender&#39;s allowance to 0 and set the</span>
 46 |     | <span class='neutral'>     * desired value afterwards:</span>
 47 |     | <span class='neutral'>     * https://github.com/ethereum/EIPs/issues/20#issuecomment-263524729</span>
 48 |     | <span class='neutral'>     *</span>
 49 |     | <span class='neutral'>     * Emits an {Approval} event.</span>
 50 |     | <span class='neutral'>     */</span>
 51 |     | <span class='neutral'>    function approve(address spender, uint256 amount) external returns (bool);</span>
 52 |     | <span class='neutral'></span>
 53 |     | <span class='neutral'>    /**</span>
 54 |     | <span class='neutral'>     * @dev Moves `amount` tokens from `sender` to `recipient` using the</span>
 55 |     | <span class='neutral'>     * allowance mechanism. `amount` is then deducted from the caller&#39;s</span>
 56 |     | <span class='neutral'>     * allowance.</span>
 57 |     | <span class='neutral'>     *</span>
 58 |     | <span class='neutral'>     * Returns a boolean value indicating whether the operation succeeded.</span>
 59 |     | <span class='neutral'>     *</span>
 60 |     | <span class='neutral'>     * Emits a {Transfer} event.</span>
 61 |     | <span class='neutral'>     */</span>
 62 |     | <span class='neutral'>    function transferFrom(</span>
 63 |     | <span class='neutral'>        address sender,</span>
 64 |     | <span class='neutral'>        address recipient,</span>
 65 |     | <span class='neutral'>        uint256 amount</span>
 66 |     | <span class='neutral'>    ) external returns (bool);</span>
 67 |     | <span class='neutral'></span>
 68 |     | <span class='neutral'>    /**</span>
 69 |     | <span class='neutral'>     * @dev Emitted when `value` tokens are moved from one account (`from`) to</span>
 70 |     | <span class='neutral'>     * another (`to`).</span>
 71 |     | <span class='neutral'>     *</span>
 72 |     | <span class='neutral'>     * Note that `value` may be zero.</span>
 73 |     | <span class='neutral'>     */</span>
 74 |     | <span class='neutral'>    event Transfer(address indexed from, address indexed to, uint256 value);</span>
 75 |     | <span class='neutral'></span>
 76 |     | <span class='neutral'>    /**</span>
 77 |     | <span class='neutral'>     * @dev Emitted when the allowance of a `spender` for an `owner` is set by</span>
 78 |     | <span class='neutral'>     * a call to {approve}. `value` is the new allowance.</span>
 79 |     | <span class='neutral'>     */</span>
 80 |     | <span class='neutral'>    event Approval(address indexed owner, address indexed spender, uint256 value);</span>
 81 |     | <span class='neutral'>}</span>
 82 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Snapshot.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'></span>
   3 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
   4 |     | <span class='neutral'></span>
   5 |     | <span class='neutral'>import &quot;../ERC20.sol&quot;;</span>
   6 |     | <span class='neutral'>import &quot;../../../utils/Arrays.sol&quot;;</span>
   7 |     | <span class='neutral'>import &quot;../../../utils/Counters.sol&quot;;</span>
   8 |     | <span class='neutral'></span>
   9 |     | <span class='neutral'>/**</span>
  10 |     | <span class='neutral'> * @dev This contract extends an ERC20 token with a snapshot mechanism. When a snapshot is created, the balances and</span>
  11 |     | <span class='neutral'> * total supply at the time are recorded for later access.</span>
  12 |     | <span class='neutral'> *</span>
  13 |     | <span class='neutral'> * This can be used to safely create mechanisms based on token balances such as trustless dividends or weighted voting.</span>
  14 |     | <span class='neutral'> * In naive implementations it&#39;s possible to perform a &quot;double spend&quot; attack by reusing the same balance from different</span>
  15 |     | <span class='neutral'> * accounts. By using snapshots to calculate dividends or voting power, those attacks no longer apply. It can also be</span>
  16 |     | <span class='neutral'> * used to create an efficient ERC20 forking mechanism.</span>
  17 |     | <span class='neutral'> *</span>
  18 |     | <span class='neutral'> * Snapshots are created by the internal {_snapshot} function, which will emit the {Snapshot} event and return a</span>
  19 |     | <span class='neutral'> * snapshot id. To get the total supply at the time of a snapshot, call the function {totalSupplyAt} with the snapshot</span>
  20 |     | <span class='neutral'> * id. To get the balance of an account at the time of a snapshot, call the {balanceOfAt} function with the snapshot id</span>
  21 |     | <span class='neutral'> * and the account address.</span>
  22 |     | <span class='neutral'> *</span>
  23 |     | <span class='neutral'> * NOTE: Snapshot policy can be customized by overriding the {_getCurrentSnapshotId} method. For example, having it</span>
  24 |     | <span class='neutral'> * return `block.number` will trigger the creation of snapshot at the begining of each new block. When overridding this</span>
  25 |     | <span class='neutral'> * function, be careful about the monotonicity of its result. Non-monotonic snapshot ids will break the contract.</span>
  26 |     | <span class='neutral'> *</span>
  27 |     | <span class='neutral'> * Implementing snapshots for every block using this method will incur significant gas costs. For a gas-efficient</span>
  28 |     | <span class='neutral'> * alternative consider {ERC20Votes}.</span>
  29 |     | <span class='neutral'> *</span>
  30 |     | <span class='neutral'> * ==== Gas Costs</span>
  31 |     | <span class='neutral'> *</span>
  32 |     | <span class='neutral'> * Snapshots are efficient. Snapshot creation is _O(1)_. Retrieval of balances or total supply from a snapshot is _O(log</span>
  33 |     | <span class='neutral'> * n)_ in the number of snapshots that have been created, although _n_ for a specific account will generally be much</span>
  34 |     | <span class='neutral'> * smaller since identical balances in subsequent snapshots are stored as a single entry.</span>
  35 |     | <span class='neutral'> *</span>
  36 |     | <span class='neutral'> * There is a constant overhead for normal ERC20 transfers due to the additional snapshot bookkeeping. This overhead is</span>
  37 |     | <span class='neutral'> * only significant for the first transfer that immediately follows a snapshot for a particular account. Subsequent</span>
  38 |     | <span class='neutral'> * transfers will have normal cost until the next snapshot, and so on.</span>
  39 |     | <span class='neutral'> */</span>
  40 |     | <span class='neutral'></span>
  41 |     | <span class='neutral'>abstract contract ERC20Snapshot is ERC20 {</span>
  42 |     | <span class='neutral'>    // Inspired by Jordi Baylina&#39;s MiniMeToken to record historical balances:</span>
  43 |     | <span class='neutral'>    // https://github.com/Giveth/minimd/blob/ea04d950eea153a04c51fa510b068b9dded390cb/contracts/MiniMeToken.sol</span>
  44 |     | <span class='neutral'></span>
  45 |     | <span class='neutral'>    using Arrays for uint256[];</span>
  46 |     | <span class='neutral'>    using Counters for Counters.Counter;</span>
  47 |     | <span class='neutral'></span>
  48 |     | <span class='neutral'>    // Snapshotted values have arrays of ids and the value corresponding to that id. These could be an array of a</span>
  49 |     | <span class='neutral'>    // Snapshot struct, but that would impede usage of functions that work on an array.</span>
  50 |     | <span class='neutral'>    struct Snapshots {</span>
  51 |     | <span class='neutral'>        uint256[] ids;</span>
  52 |     | <span class='neutral'>        uint256[] values;</span>
  53 |     | <span class='neutral'>    }</span>
  54 |     | <span class='neutral'></span>
  55 |     | <span class='neutral'>    mapping(address =&gt; Snapshots) private _accountBalanceSnapshots;</span>
  56 |     | <span class='neutral'>    Snapshots private _totalSupplySnapshots;</span>
  57 |     | <span class='neutral'></span>
  58 |     | <span class='neutral'>    // Snapshot ids increase monotonically, with the first value being 1. An id of 0 is invalid.</span>
  59 |     | <span class='neutral'>    Counters.Counter private _currentSnapshotId;</span>
  60 |     | <span class='neutral'></span>
  61 |     | <span class='neutral'>    /**</span>
  62 |     | <span class='neutral'>     * @dev Emitted by {_snapshot} when a snapshot identified by `id` is created.</span>
  63 |     | <span class='neutral'>     */</span>
  64 |     | <span class='neutral'>    event Snapshot(uint256 id);</span>
  65 |     | <span class='neutral'></span>
  66 |     | <span class='neutral'>    /**</span>
  67 |     | <span class='neutral'>     * @dev Creates a new snapshot and returns its snapshot id.</span>
  68 |     | <span class='neutral'>     *</span>
  69 |     | <span class='neutral'>     * Emits a {Snapshot} event that contains the same id.</span>
  70 |     | <span class='neutral'>     *</span>
  71 |     | <span class='neutral'>     * {_snapshot} is `internal` and you have to decide how to expose it externally. Its usage may be restricted to a</span>
  72 |     | <span class='neutral'>     * set of accounts, for example using {AccessControl}, or it may be open to the public.</span>
  73 |     | <span class='neutral'>     *</span>
  74 |     | <span class='neutral'>     * [WARNING]</span>
  75 |     | <span class='neutral'>     * ====</span>
  76 |     | <span class='neutral'>     * While an open way of calling {_snapshot} is required for certain trust minimization mechanisms such as forking,</span>
  77 |     | <span class='neutral'>     * you must consider that it can potentially be used by attackers in two ways.</span>
  78 |     | <span class='neutral'>     *</span>
  79 |     | <span class='neutral'>     * First, it can be used to increase the cost of retrieval of values from snapshots, although it will grow</span>
  80 |     | <span class='neutral'>     * logarithmically thus rendering this attack ineffective in the long term. Second, it can be used to target</span>
  81 |     | <span class='neutral'>     * specific accounts and increase the cost of ERC20 transfers for them, in the ways specified in the Gas Costs</span>
  82 |     | <span class='neutral'>     * section above.</span>
  83 |     | <span class='neutral'>     *</span>
  84 |     | <span class='neutral'>     * We haven&#39;t measured the actual numbers; if this is something you&#39;re interested in please reach out to us.</span>
  85 |     | <span class='neutral'>     * ====</span>
  86 |     | <span class='neutral'>     */</span>
  87 | *   | <span class='executed'>    function _snapshot() internal virtual returns (uint256) {</span>
  88 | *   | <span class='executed'>        _currentSnapshotId.increment();</span>
  89 |     | <span class='neutral'></span>
  90 | *   | <span class='executed'>        uint256 currentId = _getCurrentSnapshotId();</span>
  91 | *   | <span class='executed'>        emit Snapshot(currentId);</span>
  92 | *   | <span class='executed'>        return currentId;</span>
  93 |     | <span class='neutral'>    }</span>
  94 |     | <span class='neutral'></span>
  95 |     | <span class='neutral'>    /**</span>
  96 |     | <span class='neutral'>     * @dev Get the current snapshotId</span>
  97 |     | <span class='neutral'>     */</span>
  98 | *   | <span class='executed'>    function _getCurrentSnapshotId() internal view virtual returns (uint256) {</span>
  99 | *   | <span class='executed'>        return _currentSnapshotId.current();</span>
 100 |     | <span class='neutral'>    }</span>
 101 |     | <span class='neutral'></span>
 102 |     | <span class='neutral'>    /**</span>
 103 |     | <span class='neutral'>     * @dev Retrieves the balance of `account` at the time `snapshotId` was created.</span>
 104 |     | <span class='neutral'>     */</span>
 105 | *   | <span class='executed'>    function balanceOfAt(address account, uint256 snapshotId) public view virtual returns (uint256) {</span>
 106 | *   | <span class='executed'>        (bool snapshotted, uint256 value) = _valueAt(snapshotId, _accountBalanceSnapshots[account]);</span>
 107 |     | <span class='neutral'></span>
 108 | *   | <span class='executed'>        return snapshotted ? value : balanceOf(account);</span>
 109 |     | <span class='neutral'>    }</span>
 110 |     | <span class='neutral'></span>
 111 |     | <span class='neutral'>    /**</span>
 112 |     | <span class='neutral'>     * @dev Retrieves the total supply at the time `snapshotId` was created.</span>
 113 |     | <span class='neutral'>     */</span>
 114 | *   | <span class='executed'>    function totalSupplyAt(uint256 snapshotId) public view virtual returns (uint256) {</span>
 115 | *   | <span class='executed'>        (bool snapshotted, uint256 value) = _valueAt(snapshotId, _totalSupplySnapshots);</span>
 116 |     | <span class='neutral'></span>
 117 | *   | <span class='executed'>        return snapshotted ? value : totalSupply();</span>
 118 |     | <span class='neutral'>    }</span>
 119 |     | <span class='neutral'></span>
 120 |     | <span class='neutral'>    // Update balance and/or total supply snapshots before the values are modified. This is implemented</span>
 121 |     | <span class='neutral'>    // in the _beforeTokenTransfer hook, which is executed for _mint, _burn, and _transfer operations.</span>
 122 | *   | <span class='executed'>    function _beforeTokenTransfer(</span>
 123 |     | <span class='neutral'>        address from,</span>
 124 |     | <span class='neutral'>        address to,</span>
 125 |     | <span class='neutral'>        uint256 amount</span>
 126 |     | <span class='neutral'>    ) internal virtual override {</span>
 127 | *   | <span class='executed'>        super._beforeTokenTransfer(from, to, amount);</span>
 128 |     | <span class='neutral'></span>
 129 | *   | <span class='executed'>        if (from == address(0)) {</span>
 130 |     | <span class='neutral'>            // mint</span>
 131 | *   | <span class='executed'>            _updateAccountSnapshot(to);</span>
 132 | *   | <span class='executed'>            _updateTotalSupplySnapshot();</span>
 133 | *   | <span class='executed'>        } else if (to == address(0)) {</span>
 134 |     | <span class='neutral'>            // burn</span>
 135 | *   | <span class='executed'>            _updateAccountSnapshot(from);</span>
 136 | *   | <span class='executed'>            _updateTotalSupplySnapshot();</span>
 137 |     | <span class='neutral'>        } else {</span>
 138 |     | <span class='neutral'>            // transfer</span>
 139 | *   | <span class='executed'>            _updateAccountSnapshot(from);</span>
 140 | *   | <span class='executed'>            _updateAccountSnapshot(to);</span>
 141 |     | <span class='neutral'>        }</span>
 142 |     | <span class='neutral'>    }</span>
 143 |     | <span class='neutral'></span>
 144 | *   | <span class='executed'>    function _valueAt(uint256 snapshotId, Snapshots storage snapshots) private view returns (bool, uint256) {</span>
 145 | *r  | <span class='executed'>        require(snapshotId &gt; 0, &quot;ERC20Snapshot: id is 0&quot;);</span>
 146 | *r  | <span class='executed'>        require(snapshotId &lt;= _getCurrentSnapshotId(), &quot;ERC20Snapshot: nonexistent id&quot;);</span>
 147 |     | <span class='neutral'></span>
 148 |     | <span class='neutral'>        // When a valid snapshot is queried, there are three possibilities:</span>
 149 |     | <span class='neutral'>        //  a) The queried value was not modified after the snapshot was taken. Therefore, a snapshot entry was never</span>
 150 |     | <span class='neutral'>        //  created for this id, and all stored snapshot ids are smaller than the requested one. The value that corresponds</span>
 151 |     | <span class='neutral'>        //  to this id is the current one.</span>
 152 |     | <span class='neutral'>        //  b) The queried value was modified after the snapshot was taken. Therefore, there will be an entry with the</span>
 153 |     | <span class='neutral'>        //  requested id, and its value is the one to return.</span>
 154 |     | <span class='neutral'>        //  c) More snapshots were created after the requested one, and the queried value was later modified. There will be</span>
 155 |     | <span class='neutral'>        //  no entry for the requested id: the value that corresponds to it is that of the smallest snapshot id that is</span>
 156 |     | <span class='neutral'>        //  larger than the requested one.</span>
 157 |     | <span class='neutral'>        //</span>
 158 |     | <span class='neutral'>        // In summary, we need to find an element in an array, returning the index of the smallest value that is larger if</span>
 159 |     | <span class='neutral'>        // it is not found, unless said value doesn&#39;t exist (e.g. when all values are smaller). Arrays.findUpperBound does</span>
 160 |     | <span class='neutral'>        // exactly this.</span>
 161 |     | <span class='neutral'></span>
 162 | *   | <span class='executed'>        uint256 index = snapshots.ids.findUpperBound(snapshotId);</span>
 163 |     | <span class='neutral'></span>
 164 | *   | <span class='executed'>        if (index == snapshots.ids.length) {</span>
 165 | *   | <span class='executed'>            return (false, 0);</span>
 166 |     | <span class='neutral'>        } else {</span>
 167 | *   | <span class='executed'>            return (true, snapshots.values[index]);</span>
 168 |     | <span class='neutral'>        }</span>
 169 |     | <span class='neutral'>    }</span>
 170 |     | <span class='neutral'></span>
 171 | *   | <span class='executed'>    function _updateAccountSnapshot(address account) private {</span>
 172 | *   | <span class='executed'>        _updateSnapshot(_accountBalanceSnapshots[account], balanceOf(account));</span>
 173 |     | <span class='neutral'>    }</span>
 174 |     | <span class='neutral'></span>
 175 | *   | <span class='executed'>    function _updateTotalSupplySnapshot() private {</span>
 176 | *   | <span class='executed'>        _updateSnapshot(_totalSupplySnapshots, totalSupply());</span>
 177 |     | <span class='neutral'>    }</span>
 178 |     | <span class='neutral'></span>
 179 | *   | <span class='executed'>    function _updateSnapshot(Snapshots storage snapshots, uint256 currentValue) private {</span>
 180 | *   | <span class='executed'>        uint256 currentId = _getCurrentSnapshotId();</span>
 181 | *   | <span class='executed'>        if (_lastSnapshotId(snapshots.ids) &lt; currentId) {</span>
 182 | *   | <span class='executed'>            snapshots.ids.push(currentId);</span>
 183 | *   | <span class='executed'>            snapshots.values.push(currentValue);</span>
 184 |     | <span class='neutral'>        }</span>
 185 |     | <span class='neutral'>    }</span>
 186 |     | <span class='neutral'></span>
 187 | *   | <span class='executed'>    function _lastSnapshotId(uint256[] storage ids) private view returns (uint256) {</span>
 188 | *   | <span class='executed'>        if (ids.length == 0) {</span>
 189 | *   | <span class='executed'>            return 0;</span>
 190 |     | <span class='neutral'>        } else {</span>
 191 | *   | <span class='executed'>            return ids[ids.length - 1];</span>
 192 |     | <span class='neutral'>        }</span>
 193 |     | <span class='neutral'>    }</span>
 194 |     | <span class='neutral'>}</span>
 195 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/lib/openzeppelin-contracts/contracts/token/ERC20/extensions/IERC20Metadata.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v5.1.0) (token/ERC20/extensions/IERC20Metadata.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.20;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>import {IERC20} from &quot;../IERC20.sol&quot;;</span>
  7 |     | <span class='neutral'></span>
  8 |     | <span class='neutral'>/**</span>
  9 |     | <span class='neutral'> * @dev Interface for the optional metadata functions from the ERC-20 standard.</span>
 10 |     | <span class='neutral'> */</span>
 11 |     | <span class='neutral'>interface IERC20Metadata is IERC20 {</span>
 12 |     | <span class='neutral'>    /**</span>
 13 |     | <span class='neutral'>     * @dev Returns the name of the token.</span>
 14 |     | <span class='neutral'>     */</span>
 15 |     | <span class='neutral'>    function name() external view returns (string memory);</span>
 16 |     | <span class='neutral'></span>
 17 |     | <span class='neutral'>    /**</span>
 18 |     | <span class='neutral'>     * @dev Returns the symbol of the token.</span>
 19 |     | <span class='neutral'>     */</span>
 20 |     | <span class='neutral'>    function symbol() external view returns (string memory);</span>
 21 |     | <span class='neutral'></span>
 22 |     | <span class='neutral'>    /**</span>
 23 |     | <span class='neutral'>     * @dev Returns the decimals places of the token.</span>
 24 |     | <span class='neutral'>     */</span>
 25 |     | <span class='neutral'>    function decimals() external view returns (uint8);</span>
 26 |     | <span class='neutral'>}</span>
 27 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/lib/openzeppelin-contracts/contracts/utils/Address.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'></span>
   3 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
   4 |     | <span class='neutral'></span>
   5 |     | <span class='neutral'>/**</span>
   6 |     | <span class='neutral'> * @dev Collection of functions related to the address type</span>
   7 |     | <span class='neutral'> */</span>
   8 |     | <span class='unexecuted'>library Address {</span>
   9 |     | <span class='neutral'>    /**</span>
  10 |     | <span class='neutral'>     * @dev Returns true if `account` is a contract.</span>
  11 |     | <span class='neutral'>     *</span>
  12 |     | <span class='neutral'>     * [IMPORTANT]</span>
  13 |     | <span class='neutral'>     * ====</span>
  14 |     | <span class='neutral'>     * It is unsafe to assume that an address for which this function returns</span>
  15 |     | <span class='neutral'>     * false is an externally-owned account (EOA) and not a contract.</span>
  16 |     | <span class='neutral'>     *</span>
  17 |     | <span class='neutral'>     * Among others, `isContract` will return false for the following</span>
  18 |     | <span class='neutral'>     * types of addresses:</span>
  19 |     | <span class='neutral'>     *</span>
  20 |     | <span class='neutral'>     *  - an externally-owned account</span>
  21 |     | <span class='neutral'>     *  - a contract in construction</span>
  22 |     | <span class='neutral'>     *  - an address where a contract will be created</span>
  23 |     | <span class='neutral'>     *  - an address where a contract lived, but was destroyed</span>
  24 |     | <span class='neutral'>     * ====</span>
  25 |     | <span class='neutral'>     */</span>
  26 | *   | <span class='executed'>    function isContract(address account) internal view returns (bool) {</span>
  27 |     | <span class='neutral'>        // This method relies on extcodesize, which returns 0 for contracts in</span>
  28 |     | <span class='neutral'>        // construction, since the code is only stored at the end of the</span>
  29 |     | <span class='neutral'>        // constructor execution.</span>
  30 |     | <span class='neutral'></span>
  31 | *   | <span class='executed'>        uint256 size;</span>
  32 |     | <span class='neutral'>        assembly {</span>
  33 | *   | <span class='executed'>            size := extcodesize(account)</span>
  34 |     | <span class='neutral'>        }</span>
  35 | *   | <span class='executed'>        return size &gt; 0;</span>
  36 |     | <span class='neutral'>    }</span>
  37 |     | <span class='neutral'></span>
  38 |     | <span class='neutral'>    /**</span>
  39 |     | <span class='neutral'>     * @dev Replacement for Solidity&#39;s `transfer`: sends `amount` wei to</span>
  40 |     | <span class='neutral'>     * `recipient`, forwarding all available gas and reverting on errors.</span>
  41 |     | <span class='neutral'>     *</span>
  42 |     | <span class='neutral'>     * https://eips.ethereum.org/EIPS/eip-1884[EIP1884] increases the gas cost</span>
  43 |     | <span class='neutral'>     * of certain opcodes, possibly making contracts go over the 2300 gas limit</span>
  44 |     | <span class='neutral'>     * imposed by `transfer`, making them unable to receive funds via</span>
  45 |     | <span class='neutral'>     * `transfer`. {sendValue} removes this limitation.</span>
  46 |     | <span class='neutral'>     *</span>
  47 |     | <span class='neutral'>     * https://diligence.consensys.net/posts/2019/09/stop-using-soliditys-transfer-now/[Learn more].</span>
  48 |     | <span class='neutral'>     *</span>
  49 |     | <span class='neutral'>     * IMPORTANT: because control is transferred to `recipient`, care must be</span>
  50 |     | <span class='neutral'>     * taken to not create reentrancy vulnerabilities. Consider using</span>
  51 |     | <span class='neutral'>     * {ReentrancyGuard} or the</span>
  52 |     | <span class='neutral'>     * https://solidity.readthedocs.io/en/v0.5.11/security-considerations.html#use-the-checks-effects-interactions-pattern[checks-effects-interactions pattern].</span>
  53 |     | <span class='neutral'>     */</span>
  54 |     | <span class='unexecuted'>    function sendValue(address payable recipient, uint256 amount) internal {</span>
  55 |     | <span class='unexecuted'>        require(address(this).balance &gt;= amount, &quot;Address: insufficient balance&quot;);</span>
  56 |     | <span class='neutral'></span>
  57 |     | <span class='unexecuted'>        (bool success, ) = recipient.call{value: amount}(&quot;&quot;);</span>
  58 |     | <span class='unexecuted'>        require(success, &quot;Address: unable to send value, recipient may have reverted&quot;);</span>
  59 |     | <span class='neutral'>    }</span>
  60 |     | <span class='neutral'></span>
  61 |     | <span class='neutral'>    /**</span>
  62 |     | <span class='neutral'>     * @dev Performs a Solidity function call using a low level `call`. A</span>
  63 |     | <span class='neutral'>     * plain `call` is an unsafe replacement for a function call: use this</span>
  64 |     | <span class='neutral'>     * function instead.</span>
  65 |     | <span class='neutral'>     *</span>
  66 |     | <span class='neutral'>     * If `target` reverts with a revert reason, it is bubbled up by this</span>
  67 |     | <span class='neutral'>     * function (like regular Solidity function calls).</span>
  68 |     | <span class='neutral'>     *</span>
  69 |     | <span class='neutral'>     * Returns the raw returned data. To convert to the expected return value,</span>
  70 |     | <span class='neutral'>     * use https://solidity.readthedocs.io/en/latest/units-and-global-variables.html?highlight=abi.decode#abi-encoding-and-decoding-functions[`abi.decode`].</span>
  71 |     | <span class='neutral'>     *</span>
  72 |     | <span class='neutral'>     * Requirements:</span>
  73 |     | <span class='neutral'>     *</span>
  74 |     | <span class='neutral'>     * - `target` must be a contract.</span>
  75 |     | <span class='neutral'>     * - calling `target` with `data` must not revert.</span>
  76 |     | <span class='neutral'>     *</span>
  77 |     | <span class='neutral'>     * _Available since v3.1._</span>
  78 |     | <span class='neutral'>     */</span>
  79 | *   | <span class='executed'>    function functionCall(address target, bytes memory data) internal returns (bytes memory) {</span>
  80 | *   | <span class='executed'>        return functionCall(target, data, &quot;Address: low-level call failed&quot;);</span>
  81 |     | <span class='neutral'>    }</span>
  82 |     | <span class='neutral'></span>
  83 |     | <span class='neutral'>    /**</span>
  84 |     | <span class='neutral'>     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`], but with</span>
  85 |     | <span class='neutral'>     * `errorMessage` as a fallback revert reason when `target` reverts.</span>
  86 |     | <span class='neutral'>     *</span>
  87 |     | <span class='neutral'>     * _Available since v3.1._</span>
  88 |     | <span class='neutral'>     */</span>
  89 | *   | <span class='executed'>    function functionCall(</span>
  90 |     | <span class='neutral'>        address target,</span>
  91 |     | <span class='neutral'>        bytes memory data,</span>
  92 |     | <span class='neutral'>        string memory errorMessage</span>
  93 | *   | <span class='executed'>    ) internal returns (bytes memory) {</span>
  94 | *   | <span class='executed'>        return functionCallWithValue(target, data, 0, errorMessage);</span>
  95 |     | <span class='neutral'>    }</span>
  96 |     | <span class='neutral'></span>
  97 |     | <span class='neutral'>    /**</span>
  98 |     | <span class='neutral'>     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],</span>
  99 |     | <span class='neutral'>     * but also transferring `value` wei to `target`.</span>
 100 |     | <span class='neutral'>     *</span>
 101 |     | <span class='neutral'>     * Requirements:</span>
 102 |     | <span class='neutral'>     *</span>
 103 |     | <span class='neutral'>     * - the calling contract must have an ETH balance of at least `value`.</span>
 104 |     | <span class='neutral'>     * - the called Solidity function must be `payable`.</span>
 105 |     | <span class='neutral'>     *</span>
 106 |     | <span class='neutral'>     * _Available since v3.1._</span>
 107 |     | <span class='neutral'>     */</span>
 108 |     | <span class='unexecuted'>    function functionCallWithValue(</span>
 109 |     | <span class='neutral'>        address target,</span>
 110 |     | <span class='neutral'>        bytes memory data,</span>
 111 |     | <span class='neutral'>        uint256 value</span>
 112 |     | <span class='unexecuted'>    ) internal returns (bytes memory) {</span>
 113 |     | <span class='unexecuted'>        return functionCallWithValue(target, data, value, &quot;Address: low-level call with value failed&quot;);</span>
 114 |     | <span class='neutral'>    }</span>
 115 |     | <span class='neutral'></span>
 116 |     | <span class='neutral'>    /**</span>
 117 |     | <span class='neutral'>     * @dev Same as {xref-Address-functionCallWithValue-address-bytes-uint256-}[`functionCallWithValue`], but</span>
 118 |     | <span class='neutral'>     * with `errorMessage` as a fallback revert reason when `target` reverts.</span>
 119 |     | <span class='neutral'>     *</span>
 120 |     | <span class='neutral'>     * _Available since v3.1._</span>
 121 |     | <span class='neutral'>     */</span>
 122 | *   | <span class='executed'>    function functionCallWithValue(</span>
 123 |     | <span class='neutral'>        address target,</span>
 124 |     | <span class='neutral'>        bytes memory data,</span>
 125 |     | <span class='neutral'>        uint256 value,</span>
 126 |     | <span class='neutral'>        string memory errorMessage</span>
 127 | *   | <span class='executed'>    ) internal returns (bytes memory) {</span>
 128 | *   | <span class='executed'>        require(address(this).balance &gt;= value, &quot;Address: insufficient balance for call&quot;);</span>
 129 | *   | <span class='executed'>        require(isContract(target), &quot;Address: call to non-contract&quot;);</span>
 130 |     | <span class='neutral'></span>
 131 | *   | <span class='executed'>        (bool success, bytes memory returndata) = target.call{value: value}(data);</span>
 132 | *   | <span class='executed'>        return verifyCallResult(success, returndata, errorMessage);</span>
 133 |     | <span class='neutral'>    }</span>
 134 |     | <span class='neutral'></span>
 135 |     | <span class='neutral'>    /**</span>
 136 |     | <span class='neutral'>     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],</span>
 137 |     | <span class='neutral'>     * but performing a static call.</span>
 138 |     | <span class='neutral'>     *</span>
 139 |     | <span class='neutral'>     * _Available since v3.3._</span>
 140 |     | <span class='neutral'>     */</span>
 141 |     | <span class='neutral'>    function functionStaticCall(address target, bytes memory data) internal view returns (bytes memory) {</span>
 142 |     | <span class='neutral'>        return functionStaticCall(target, data, &quot;Address: low-level static call failed&quot;);</span>
 143 |     | <span class='neutral'>    }</span>
 144 |     | <span class='neutral'></span>
 145 |     | <span class='neutral'>    /**</span>
 146 |     | <span class='neutral'>     * @dev Same as {xref-Address-functionCall-address-bytes-string-}[`functionCall`],</span>
 147 |     | <span class='neutral'>     * but performing a static call.</span>
 148 |     | <span class='neutral'>     *</span>
 149 |     | <span class='neutral'>     * _Available since v3.3._</span>
 150 |     | <span class='neutral'>     */</span>
 151 |     | <span class='neutral'>    function functionStaticCall(</span>
 152 |     | <span class='neutral'>        address target,</span>
 153 |     | <span class='neutral'>        bytes memory data,</span>
 154 |     | <span class='neutral'>        string memory errorMessage</span>
 155 |     | <span class='neutral'>    ) internal view returns (bytes memory) {</span>
 156 |     | <span class='neutral'>        require(isContract(target), &quot;Address: static call to non-contract&quot;);</span>
 157 |     | <span class='neutral'></span>
 158 |     | <span class='neutral'>        (bool success, bytes memory returndata) = target.staticcall(data);</span>
 159 |     | <span class='neutral'>        return verifyCallResult(success, returndata, errorMessage);</span>
 160 |     | <span class='neutral'>    }</span>
 161 |     | <span class='neutral'></span>
 162 |     | <span class='neutral'>    /**</span>
 163 |     | <span class='neutral'>     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],</span>
 164 |     | <span class='neutral'>     * but performing a delegate call.</span>
 165 |     | <span class='neutral'>     *</span>
 166 |     | <span class='neutral'>     * _Available since v3.4._</span>
 167 |     | <span class='neutral'>     */</span>
 168 |     | <span class='neutral'>    function functionDelegateCall(address target, bytes memory data) internal returns (bytes memory) {</span>
 169 |     | <span class='neutral'>        return functionDelegateCall(target, data, &quot;Address: low-level delegate call failed&quot;);</span>
 170 |     | <span class='neutral'>    }</span>
 171 |     | <span class='neutral'></span>
 172 |     | <span class='neutral'>    /**</span>
 173 |     | <span class='neutral'>     * @dev Same as {xref-Address-functionCall-address-bytes-string-}[`functionCall`],</span>
 174 |     | <span class='neutral'>     * but performing a delegate call.</span>
 175 |     | <span class='neutral'>     *</span>
 176 |     | <span class='neutral'>     * _Available since v3.4._</span>
 177 |     | <span class='neutral'>     */</span>
 178 |     | <span class='neutral'>    function functionDelegateCall(</span>
 179 |     | <span class='neutral'>        address target,</span>
 180 |     | <span class='neutral'>        bytes memory data,</span>
 181 |     | <span class='neutral'>        string memory errorMessage</span>
 182 |     | <span class='neutral'>    ) internal returns (bytes memory) {</span>
 183 |     | <span class='neutral'>        require(isContract(target), &quot;Address: delegate call to non-contract&quot;);</span>
 184 |     | <span class='neutral'></span>
 185 |     | <span class='neutral'>        (bool success, bytes memory returndata) = target.delegatecall(data);</span>
 186 |     | <span class='neutral'>        return verifyCallResult(success, returndata, errorMessage);</span>
 187 |     | <span class='neutral'>    }</span>
 188 |     | <span class='neutral'></span>
 189 |     | <span class='neutral'>    /**</span>
 190 |     | <span class='neutral'>     * @dev Tool to verifies that a low level call was successful, and revert if it wasn&#39;t, either by bubbling the</span>
 191 |     | <span class='neutral'>     * revert reason using the provided one.</span>
 192 |     | <span class='neutral'>     *</span>
 193 |     | <span class='neutral'>     * _Available since v4.3._</span>
 194 |     | <span class='neutral'>     */</span>
 195 | *   | <span class='executed'>    function verifyCallResult(</span>
 196 |     | <span class='neutral'>        bool success,</span>
 197 |     | <span class='neutral'>        bytes memory returndata,</span>
 198 |     | <span class='neutral'>        string memory errorMessage</span>
 199 | *   | <span class='executed'>    ) internal pure returns (bytes memory) {</span>
 200 | *   | <span class='executed'>        if (success) {</span>
 201 | *   | <span class='executed'>            return returndata;</span>
 202 |     | <span class='neutral'>        } else {</span>
 203 |     | <span class='neutral'>            // Look for revert reason and bubble it up if present</span>
 204 | *   | <span class='executed'>            if (returndata.length &gt; 0) {</span>
 205 |     | <span class='neutral'>                // The easiest way to bubble the revert reason is using memory via assembly</span>
 206 |     | <span class='neutral'></span>
 207 |     | <span class='neutral'>                assembly {</span>
 208 | *   | <span class='executed'>                    let returndata_size := mload(returndata)</span>
 209 | *   | <span class='executed'>                    revert(add(32, returndata), returndata_size)</span>
 210 |     | <span class='neutral'>                }</span>
 211 |     | <span class='neutral'>            } else {</span>
 212 |     | <span class='unexecuted'>                revert(errorMessage);</span>
 213 |     | <span class='neutral'>            }</span>
 214 |     | <span class='neutral'>        }</span>
 215 |     | <span class='neutral'>    }</span>
 216 |     | <span class='neutral'>}</span>
 217 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/lib/openzeppelin-contracts/contracts/utils/Arrays.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v5.1.0) (utils/Arrays.sol)</span>
   3 |     | <span class='neutral'>// This file was procedurally generated from scripts/generate/templates/Arrays.js.</span>
   4 |     | <span class='neutral'></span>
   5 |     | <span class='neutral'>pragma solidity ^0.8.20;</span>
   6 |     | <span class='neutral'></span>
   7 |     | <span class='neutral'>import {Comparators} from &quot;./Comparators.sol&quot;;</span>
   8 |     | <span class='neutral'>import {SlotDerivation} from &quot;./SlotDerivation.sol&quot;;</span>
   9 |     | <span class='neutral'>import {StorageSlot} from &quot;./StorageSlot.sol&quot;;</span>
  10 |     | <span class='neutral'>import {Math} from &quot;./math/Math.sol&quot;;</span>
  11 |     | <span class='neutral'></span>
  12 |     | <span class='neutral'>/**</span>
  13 |     | <span class='neutral'> * @dev Collection of functions related to array types.</span>
  14 |     | <span class='neutral'> */</span>
  15 |     | <span class='unexecuted'>library Arrays {</span>
  16 |     | <span class='neutral'>    using SlotDerivation for bytes32;</span>
  17 |     | <span class='neutral'>    using StorageSlot for bytes32;</span>
  18 |     | <span class='neutral'></span>
  19 |     | <span class='neutral'>    /**</span>
  20 |     | <span class='neutral'>     * @dev Sort an array of uint256 (in memory) following the provided comparator function.</span>
  21 |     | <span class='neutral'>     *</span>
  22 |     | <span class='neutral'>     * This function does the sorting &quot;in place&quot;, meaning that it overrides the input. The object is returned for</span>
  23 |     | <span class='neutral'>     * convenience, but that returned value can be discarded safely if the caller has a memory pointer to the array.</span>
  24 |     | <span class='neutral'>     *</span>
  25 |     | <span class='neutral'>     * NOTE: this function&#39;s cost is `O(n  log(n))` in average and `O(n)` in the worst case, with n the length of the</span>
  26 |     | <span class='neutral'>     * array. Using it in view functions that are executed through `eth_call` is safe, but one should be very careful</span>
  27 |     | <span class='neutral'>     * when executing this as part of a transaction. If the array being sorted is too large, the sort operation may</span>
  28 |     | <span class='neutral'>     * consume more gas than is available in a block, leading to potential DoS.</span>
  29 |     | <span class='neutral'>     *</span>
  30 |     | <span class='neutral'>     * IMPORTANT: Consider memory side-effects when using custom comparator functions that access memory in an unsafe way.</span>
  31 |     | <span class='neutral'>     */</span>
  32 |     | <span class='neutral'>    function sort(</span>
  33 |     | <span class='neutral'>        uint256[] memory array,</span>
  34 |     | <span class='neutral'>        function(uint256, uint256) pure returns (bool) comp</span>
  35 |     | <span class='neutral'>    ) internal pure returns (uint256[] memory) {</span>
  36 |     | <span class='neutral'>        _quickSort(_begin(array), _end(array), comp);</span>
  37 |     | <span class='neutral'>        return array;</span>
  38 |     | <span class='neutral'>    }</span>
  39 |     | <span class='neutral'></span>
  40 |     | <span class='neutral'>    /**</span>
  41 |     | <span class='neutral'>     * @dev Variant of {sort} that sorts an array of uint256 in increasing order.</span>
  42 |     | <span class='neutral'>     */</span>
  43 |     | <span class='neutral'>    function sort(uint256[] memory array) internal pure returns (uint256[] memory) {</span>
  44 |     | <span class='neutral'>        sort(array, Comparators.lt);</span>
  45 |     | <span class='neutral'>        return array;</span>
  46 |     | <span class='neutral'>    }</span>
  47 |     | <span class='neutral'></span>
  48 |     | <span class='neutral'>    /**</span>
  49 |     | <span class='neutral'>     * @dev Sort an array of address (in memory) following the provided comparator function.</span>
  50 |     | <span class='neutral'>     *</span>
  51 |     | <span class='neutral'>     * This function does the sorting &quot;in place&quot;, meaning that it overrides the input. The object is returned for</span>
  52 |     | <span class='neutral'>     * convenience, but that returned value can be discarded safely if the caller has a memory pointer to the array.</span>
  53 |     | <span class='neutral'>     *</span>
  54 |     | <span class='neutral'>     * NOTE: this function&#39;s cost is `O(n  log(n))` in average and `O(n)` in the worst case, with n the length of the</span>
  55 |     | <span class='neutral'>     * array. Using it in view functions that are executed through `eth_call` is safe, but one should be very careful</span>
  56 |     | <span class='neutral'>     * when executing this as part of a transaction. If the array being sorted is too large, the sort operation may</span>
  57 |     | <span class='neutral'>     * consume more gas than is available in a block, leading to potential DoS.</span>
  58 |     | <span class='neutral'>     *</span>
  59 |     | <span class='neutral'>     * IMPORTANT: Consider memory side-effects when using custom comparator functions that access memory in an unsafe way.</span>
  60 |     | <span class='neutral'>     */</span>
  61 |     | <span class='neutral'>    function sort(</span>
  62 |     | <span class='neutral'>        address[] memory array,</span>
  63 |     | <span class='neutral'>        function(address, address) pure returns (bool) comp</span>
  64 |     | <span class='neutral'>    ) internal pure returns (address[] memory) {</span>
  65 |     | <span class='neutral'>        sort(_castToUint256Array(array), _castToUint256Comp(comp));</span>
  66 |     | <span class='neutral'>        return array;</span>
  67 |     | <span class='neutral'>    }</span>
  68 |     | <span class='neutral'></span>
  69 |     | <span class='neutral'>    /**</span>
  70 |     | <span class='neutral'>     * @dev Variant of {sort} that sorts an array of address in increasing order.</span>
  71 |     | <span class='neutral'>     */</span>
  72 |     | <span class='neutral'>    function sort(address[] memory array) internal pure returns (address[] memory) {</span>
  73 |     | <span class='neutral'>        sort(_castToUint256Array(array), Comparators.lt);</span>
  74 |     | <span class='neutral'>        return array;</span>
  75 |     | <span class='neutral'>    }</span>
  76 |     | <span class='neutral'></span>
  77 |     | <span class='neutral'>    /**</span>
  78 |     | <span class='neutral'>     * @dev Sort an array of bytes32 (in memory) following the provided comparator function.</span>
  79 |     | <span class='neutral'>     *</span>
  80 |     | <span class='neutral'>     * This function does the sorting &quot;in place&quot;, meaning that it overrides the input. The object is returned for</span>
  81 |     | <span class='neutral'>     * convenience, but that returned value can be discarded safely if the caller has a memory pointer to the array.</span>
  82 |     | <span class='neutral'>     *</span>
  83 |     | <span class='neutral'>     * NOTE: this function&#39;s cost is `O(n  log(n))` in average and `O(n)` in the worst case, with n the length of the</span>
  84 |     | <span class='neutral'>     * array. Using it in view functions that are executed through `eth_call` is safe, but one should be very careful</span>
  85 |     | <span class='neutral'>     * when executing this as part of a transaction. If the array being sorted is too large, the sort operation may</span>
  86 |     | <span class='neutral'>     * consume more gas than is available in a block, leading to potential DoS.</span>
  87 |     | <span class='neutral'>     *</span>
  88 |     | <span class='neutral'>     * IMPORTANT: Consider memory side-effects when using custom comparator functions that access memory in an unsafe way.</span>
  89 |     | <span class='neutral'>     */</span>
  90 |     | <span class='neutral'>    function sort(</span>
  91 |     | <span class='neutral'>        bytes32[] memory array,</span>
  92 |     | <span class='neutral'>        function(bytes32, bytes32) pure returns (bool) comp</span>
  93 |     | <span class='neutral'>    ) internal pure returns (bytes32[] memory) {</span>
  94 |     | <span class='neutral'>        sort(_castToUint256Array(array), _castToUint256Comp(comp));</span>
  95 |     | <span class='neutral'>        return array;</span>
  96 |     | <span class='neutral'>    }</span>
  97 |     | <span class='neutral'></span>
  98 |     | <span class='neutral'>    /**</span>
  99 |     | <span class='neutral'>     * @dev Variant of {sort} that sorts an array of bytes32 in increasing order.</span>
 100 |     | <span class='neutral'>     */</span>
 101 |     | <span class='neutral'>    function sort(bytes32[] memory array) internal pure returns (bytes32[] memory) {</span>
 102 |     | <span class='neutral'>        sort(_castToUint256Array(array), Comparators.lt);</span>
 103 |     | <span class='neutral'>        return array;</span>
 104 |     | <span class='neutral'>    }</span>
 105 |     | <span class='neutral'></span>
 106 |     | <span class='neutral'>    /**</span>
 107 |     | <span class='neutral'>     * @dev Performs a quick sort of a segment of memory. The segment sorted starts at `begin` (inclusive), and stops</span>
 108 |     | <span class='neutral'>     * at end (exclusive). Sorting follows the `comp` comparator.</span>
 109 |     | <span class='neutral'>     *</span>
 110 |     | <span class='neutral'>     * Invariant: `begin &lt;= end`. This is the case when initially called by {sort} and is preserved in subcalls.</span>
 111 |     | <span class='neutral'>     *</span>
 112 |     | <span class='neutral'>     * IMPORTANT: Memory locations between `begin` and `end` are not validated/zeroed. This function should</span>
 113 |     | <span class='neutral'>     * be used only if the limits are within a memory array.</span>
 114 |     | <span class='neutral'>     */</span>
 115 |     | <span class='neutral'>    function _quickSort(uint256 begin, uint256 end, function(uint256, uint256) pure returns (bool) comp) private pure {</span>
 116 |     | <span class='neutral'>        unchecked {</span>
 117 |     | <span class='neutral'>            if (end - begin &lt; 0x40) return;</span>
 118 |     | <span class='neutral'></span>
 119 |     | <span class='neutral'>            // Use first element as pivot</span>
 120 |     | <span class='neutral'>            uint256 pivot = _mload(begin);</span>
 121 |     | <span class='neutral'>            // Position where the pivot should be at the end of the loop</span>
 122 |     | <span class='neutral'>            uint256 pos = begin;</span>
 123 |     | <span class='neutral'></span>
 124 |     | <span class='neutral'>            for (uint256 it = begin + 0x20; it &lt; end; it += 0x20) {</span>
 125 |     | <span class='neutral'>                if (comp(_mload(it), pivot)) {</span>
 126 |     | <span class='neutral'>                    // If the value stored at the iterator&#39;s position comes before the pivot, we increment the</span>
 127 |     | <span class='neutral'>                    // position of the pivot and move the value there.</span>
 128 |     | <span class='neutral'>                    pos += 0x20;</span>
 129 |     | <span class='neutral'>                    _swap(pos, it);</span>
 130 |     | <span class='neutral'>                }</span>
 131 |     | <span class='neutral'>            }</span>
 132 |     | <span class='neutral'></span>
 133 |     | <span class='neutral'>            _swap(begin, pos); // Swap pivot into place</span>
 134 |     | <span class='neutral'>            _quickSort(begin, pos, comp); // Sort the left side of the pivot</span>
 135 |     | <span class='neutral'>            _quickSort(pos + 0x20, end, comp); // Sort the right side of the pivot</span>
 136 |     | <span class='neutral'>        }</span>
 137 |     | <span class='neutral'>    }</span>
 138 |     | <span class='neutral'></span>
 139 |     | <span class='neutral'>    /**</span>
 140 |     | <span class='neutral'>     * @dev Pointer to the memory location of the first element of `array`.</span>
 141 |     | <span class='neutral'>     */</span>
 142 |     | <span class='neutral'>    function _begin(uint256[] memory array) private pure returns (uint256 ptr) {</span>
 143 |     | <span class='neutral'>        assembly (&quot;memory-safe&quot;) {</span>
 144 |     | <span class='neutral'>            ptr := add(array, 0x20)</span>
 145 |     | <span class='neutral'>        }</span>
 146 |     | <span class='neutral'>    }</span>
 147 |     | <span class='neutral'></span>
 148 |     | <span class='neutral'>    /**</span>
 149 |     | <span class='neutral'>     * @dev Pointer to the memory location of the first memory word (32bytes) after `array`. This is the memory word</span>
 150 |     | <span class='neutral'>     * that comes just after the last element of the array.</span>
 151 |     | <span class='neutral'>     */</span>
 152 |     | <span class='neutral'>    function _end(uint256[] memory array) private pure returns (uint256 ptr) {</span>
 153 |     | <span class='neutral'>        unchecked {</span>
 154 |     | <span class='neutral'>            return _begin(array) + array.length * 0x20;</span>
 155 |     | <span class='neutral'>        }</span>
 156 |     | <span class='neutral'>    }</span>
 157 |     | <span class='neutral'></span>
 158 |     | <span class='neutral'>    /**</span>
 159 |     | <span class='neutral'>     * @dev Load memory word (as a uint256) at location `ptr`.</span>
 160 |     | <span class='neutral'>     */</span>
 161 |     | <span class='neutral'>    function _mload(uint256 ptr) private pure returns (uint256 value) {</span>
 162 |     | <span class='neutral'>        assembly {</span>
 163 |     | <span class='neutral'>            value := mload(ptr)</span>
 164 |     | <span class='neutral'>        }</span>
 165 |     | <span class='neutral'>    }</span>
 166 |     | <span class='neutral'></span>
 167 |     | <span class='neutral'>    /**</span>
 168 |     | <span class='neutral'>     * @dev Swaps the elements memory location `ptr1` and `ptr2`.</span>
 169 |     | <span class='neutral'>     */</span>
 170 |     | <span class='neutral'>    function _swap(uint256 ptr1, uint256 ptr2) private pure {</span>
 171 |     | <span class='neutral'>        assembly {</span>
 172 |     | <span class='neutral'>            let value1 := mload(ptr1)</span>
 173 |     | <span class='neutral'>            let value2 := mload(ptr2)</span>
 174 |     | <span class='neutral'>            mstore(ptr1, value2)</span>
 175 |     | <span class='neutral'>            mstore(ptr2, value1)</span>
 176 |     | <span class='neutral'>        }</span>
 177 |     | <span class='neutral'>    }</span>
 178 |     | <span class='neutral'></span>
 179 |     | <span class='neutral'>    /// @dev Helper: low level cast address memory array to uint256 memory array</span>
 180 |     | <span class='neutral'>    function _castToUint256Array(address[] memory input) private pure returns (uint256[] memory output) {</span>
 181 |     | <span class='neutral'>        assembly {</span>
 182 |     | <span class='neutral'>            output := input</span>
 183 |     | <span class='neutral'>        }</span>
 184 |     | <span class='neutral'>    }</span>
 185 |     | <span class='neutral'></span>
 186 |     | <span class='neutral'>    /// @dev Helper: low level cast bytes32 memory array to uint256 memory array</span>
 187 |     | <span class='neutral'>    function _castToUint256Array(bytes32[] memory input) private pure returns (uint256[] memory output) {</span>
 188 |     | <span class='neutral'>        assembly {</span>
 189 |     | <span class='neutral'>            output := input</span>
 190 |     | <span class='neutral'>        }</span>
 191 |     | <span class='neutral'>    }</span>
 192 |     | <span class='neutral'></span>
 193 |     | <span class='neutral'>    /// @dev Helper: low level cast address comp function to uint256 comp function</span>
 194 |     | <span class='neutral'>    function _castToUint256Comp(</span>
 195 |     | <span class='neutral'>        function(address, address) pure returns (bool) input</span>
 196 |     | <span class='neutral'>    ) private pure returns (function(uint256, uint256) pure returns (bool) output) {</span>
 197 |     | <span class='neutral'>        assembly {</span>
 198 |     | <span class='neutral'>            output := input</span>
 199 |     | <span class='neutral'>        }</span>
 200 |     | <span class='neutral'>    }</span>
 201 |     | <span class='neutral'></span>
 202 |     | <span class='neutral'>    /// @dev Helper: low level cast bytes32 comp function to uint256 comp function</span>
 203 |     | <span class='neutral'>    function _castToUint256Comp(</span>
 204 |     | <span class='neutral'>        function(bytes32, bytes32) pure returns (bool) input</span>
 205 |     | <span class='neutral'>    ) private pure returns (function(uint256, uint256) pure returns (bool) output) {</span>
 206 |     | <span class='neutral'>        assembly {</span>
 207 |     | <span class='neutral'>            output := input</span>
 208 |     | <span class='neutral'>        }</span>
 209 |     | <span class='neutral'>    }</span>
 210 |     | <span class='neutral'></span>
 211 |     | <span class='neutral'>    /**</span>
 212 |     | <span class='neutral'>     * @dev Searches a sorted `array` and returns the first index that contains</span>
 213 |     | <span class='neutral'>     * a value greater or equal to `element`. If no such index exists (i.e. all</span>
 214 |     | <span class='neutral'>     * values in the array are strictly less than `element`), the array length is</span>
 215 |     | <span class='neutral'>     * returned. Time complexity O(log n).</span>
 216 |     | <span class='neutral'>     *</span>
 217 |     | <span class='neutral'>     * NOTE: The `array` is expected to be sorted in ascending order, and to</span>
 218 |     | <span class='neutral'>     * contain no repeated elements.</span>
 219 |     | <span class='neutral'>     *</span>
 220 |     | <span class='neutral'>     * IMPORTANT: Deprecated. This implementation behaves as {lowerBound} but lacks</span>
 221 |     | <span class='neutral'>     * support for repeated elements in the array. The {lowerBound} function should</span>
 222 |     | <span class='neutral'>     * be used instead.</span>
 223 |     | <span class='neutral'>     */</span>
 224 | *   | <span class='executed'>    function findUpperBound(uint256[] storage array, uint256 element) internal view returns (uint256) {</span>
 225 | *   | <span class='executed'>        uint256 low = 0;</span>
 226 | *   | <span class='executed'>        uint256 high = array.length;</span>
 227 |     | <span class='neutral'></span>
 228 | *   | <span class='executed'>        if (high == 0) {</span>
 229 | *   | <span class='executed'>            return 0;</span>
 230 |     | <span class='neutral'>        }</span>
 231 |     | <span class='neutral'></span>
 232 | *   | <span class='executed'>        while (low &lt; high) {</span>
 233 | *   | <span class='executed'>            uint256 mid = Math.average(low, high);</span>
 234 |     | <span class='neutral'></span>
 235 |     | <span class='neutral'>            // Note that mid will always be strictly less than high (i.e. it will be a valid array index)</span>
 236 |     | <span class='neutral'>            // because Math.average rounds towards zero (it does integer division with truncation).</span>
 237 | *   | <span class='executed'>            if (unsafeAccess(array, mid).value &gt; element) {</span>
 238 |     | <span class='unexecuted'>                high = mid;</span>
 239 |     | <span class='neutral'>            } else {</span>
 240 | *   | <span class='executed'>                low = mid + 1;</span>
 241 |     | <span class='neutral'>            }</span>
 242 |     | <span class='neutral'>        }</span>
 243 |     | <span class='neutral'></span>
 244 |     | <span class='neutral'>        // At this point `low` is the exclusive upper bound. We will return the inclusive upper bound.</span>
 245 | *   | <span class='executed'>        if (low &gt; 0 &amp;&amp; unsafeAccess(array, low - 1).value == element) {</span>
 246 | *   | <span class='executed'>            return low - 1;</span>
 247 |     | <span class='neutral'>        } else {</span>
 248 | *   | <span class='executed'>            return low;</span>
 249 |     | <span class='neutral'>        }</span>
 250 |     | <span class='neutral'>    }</span>
 251 |     | <span class='neutral'></span>
 252 |     | <span class='neutral'>    /**</span>
 253 |     | <span class='neutral'>     * @dev Searches an `array` sorted in ascending order and returns the first</span>
 254 |     | <span class='neutral'>     * index that contains a value greater or equal than `element`. If no such index</span>
 255 |     | <span class='neutral'>     * exists (i.e. all values in the array are strictly less than `element`), the array</span>
 256 |     | <span class='neutral'>     * length is returned. Time complexity O(log n).</span>
 257 |     | <span class='neutral'>     *</span>
 258 |     | <span class='neutral'>     * See C++&#39;s https://en.cppreference.com/w/cpp/algorithm/lower_bound[lower_bound].</span>
 259 |     | <span class='neutral'>     */</span>
 260 |     | <span class='neutral'>    function lowerBound(uint256[] storage array, uint256 element) internal view returns (uint256) {</span>
 261 |     | <span class='neutral'>        uint256 low = 0;</span>
 262 |     | <span class='neutral'>        uint256 high = array.length;</span>
 263 |     | <span class='neutral'></span>
 264 |     | <span class='neutral'>        if (high == 0) {</span>
 265 |     | <span class='neutral'>            return 0;</span>
 266 |     | <span class='neutral'>        }</span>
 267 |     | <span class='neutral'></span>
 268 |     | <span class='neutral'>        while (low &lt; high) {</span>
 269 |     | <span class='neutral'>            uint256 mid = Math.average(low, high);</span>
 270 |     | <span class='neutral'></span>
 271 |     | <span class='neutral'>            // Note that mid will always be strictly less than high (i.e. it will be a valid array index)</span>
 272 |     | <span class='neutral'>            // because Math.average rounds towards zero (it does integer division with truncation).</span>
 273 |     | <span class='neutral'>            if (unsafeAccess(array, mid).value &lt; element) {</span>
 274 |     | <span class='neutral'>                // this cannot overflow because mid &lt; high</span>
 275 |     | <span class='neutral'>                unchecked {</span>
 276 |     | <span class='neutral'>                    low = mid + 1;</span>
 277 |     | <span class='neutral'>                }</span>
 278 |     | <span class='neutral'>            } else {</span>
 279 |     | <span class='neutral'>                high = mid;</span>
 280 |     | <span class='neutral'>            }</span>
 281 |     | <span class='neutral'>        }</span>
 282 |     | <span class='neutral'></span>
 283 |     | <span class='neutral'>        return low;</span>
 284 |     | <span class='neutral'>    }</span>
 285 |     | <span class='neutral'></span>
 286 |     | <span class='neutral'>    /**</span>
 287 |     | <span class='neutral'>     * @dev Searches an `array` sorted in ascending order and returns the first</span>
 288 |     | <span class='neutral'>     * index that contains a value strictly greater than `element`. If no such index</span>
 289 |     | <span class='neutral'>     * exists (i.e. all values in the array are strictly less than `element`), the array</span>
 290 |     | <span class='neutral'>     * length is returned. Time complexity O(log n).</span>
 291 |     | <span class='neutral'>     *</span>
 292 |     | <span class='neutral'>     * See C++&#39;s https://en.cppreference.com/w/cpp/algorithm/upper_bound[upper_bound].</span>
 293 |     | <span class='neutral'>     */</span>
 294 |     | <span class='neutral'>    function upperBound(uint256[] storage array, uint256 element) internal view returns (uint256) {</span>
 295 |     | <span class='neutral'>        uint256 low = 0;</span>
 296 |     | <span class='neutral'>        uint256 high = array.length;</span>
 297 |     | <span class='neutral'></span>
 298 |     | <span class='neutral'>        if (high == 0) {</span>
 299 |     | <span class='neutral'>            return 0;</span>
 300 |     | <span class='neutral'>        }</span>
 301 |     | <span class='neutral'></span>
 302 |     | <span class='neutral'>        while (low &lt; high) {</span>
 303 |     | <span class='neutral'>            uint256 mid = Math.average(low, high);</span>
 304 |     | <span class='neutral'></span>
 305 |     | <span class='neutral'>            // Note that mid will always be strictly less than high (i.e. it will be a valid array index)</span>
 306 |     | <span class='neutral'>            // because Math.average rounds towards zero (it does integer division with truncation).</span>
 307 |     | <span class='neutral'>            if (unsafeAccess(array, mid).value &gt; element) {</span>
 308 |     | <span class='neutral'>                high = mid;</span>
 309 |     | <span class='neutral'>            } else {</span>
 310 |     | <span class='neutral'>                // this cannot overflow because mid &lt; high</span>
 311 |     | <span class='neutral'>                unchecked {</span>
 312 |     | <span class='neutral'>                    low = mid + 1;</span>
 313 |     | <span class='neutral'>                }</span>
 314 |     | <span class='neutral'>            }</span>
 315 |     | <span class='neutral'>        }</span>
 316 |     | <span class='neutral'></span>
 317 |     | <span class='neutral'>        return low;</span>
 318 |     | <span class='neutral'>    }</span>
 319 |     | <span class='neutral'></span>
 320 |     | <span class='neutral'>    /**</span>
 321 |     | <span class='neutral'>     * @dev Same as {lowerBound}, but with an array in memory.</span>
 322 |     | <span class='neutral'>     */</span>
 323 |     | <span class='neutral'>    function lowerBoundMemory(uint256[] memory array, uint256 element) internal pure returns (uint256) {</span>
 324 |     | <span class='neutral'>        uint256 low = 0;</span>
 325 |     | <span class='neutral'>        uint256 high = array.length;</span>
 326 |     | <span class='neutral'></span>
 327 |     | <span class='neutral'>        if (high == 0) {</span>
 328 |     | <span class='neutral'>            return 0;</span>
 329 |     | <span class='neutral'>        }</span>
 330 |     | <span class='neutral'></span>
 331 |     | <span class='neutral'>        while (low &lt; high) {</span>
 332 |     | <span class='neutral'>            uint256 mid = Math.average(low, high);</span>
 333 |     | <span class='neutral'></span>
 334 |     | <span class='neutral'>            // Note that mid will always be strictly less than high (i.e. it will be a valid array index)</span>
 335 |     | <span class='neutral'>            // because Math.average rounds towards zero (it does integer division with truncation).</span>
 336 |     | <span class='neutral'>            if (unsafeMemoryAccess(array, mid) &lt; element) {</span>
 337 |     | <span class='neutral'>                // this cannot overflow because mid &lt; high</span>
 338 |     | <span class='neutral'>                unchecked {</span>
 339 |     | <span class='neutral'>                    low = mid + 1;</span>
 340 |     | <span class='neutral'>                }</span>
 341 |     | <span class='neutral'>            } else {</span>
 342 |     | <span class='neutral'>                high = mid;</span>
 343 |     | <span class='neutral'>            }</span>
 344 |     | <span class='neutral'>        }</span>
 345 |     | <span class='neutral'></span>
 346 |     | <span class='neutral'>        return low;</span>
 347 |     | <span class='neutral'>    }</span>
 348 |     | <span class='neutral'></span>
 349 |     | <span class='neutral'>    /**</span>
 350 |     | <span class='neutral'>     * @dev Same as {upperBound}, but with an array in memory.</span>
 351 |     | <span class='neutral'>     */</span>
 352 |     | <span class='neutral'>    function upperBoundMemory(uint256[] memory array, uint256 element) internal pure returns (uint256) {</span>
 353 |     | <span class='neutral'>        uint256 low = 0;</span>
 354 |     | <span class='neutral'>        uint256 high = array.length;</span>
 355 |     | <span class='neutral'></span>
 356 |     | <span class='neutral'>        if (high == 0) {</span>
 357 |     | <span class='neutral'>            return 0;</span>
 358 |     | <span class='neutral'>        }</span>
 359 |     | <span class='neutral'></span>
 360 |     | <span class='neutral'>        while (low &lt; high) {</span>
 361 |     | <span class='neutral'>            uint256 mid = Math.average(low, high);</span>
 362 |     | <span class='neutral'></span>
 363 |     | <span class='neutral'>            // Note that mid will always be strictly less than high (i.e. it will be a valid array index)</span>
 364 |     | <span class='neutral'>            // because Math.average rounds towards zero (it does integer division with truncation).</span>
 365 |     | <span class='neutral'>            if (unsafeMemoryAccess(array, mid) &gt; element) {</span>
 366 |     | <span class='neutral'>                high = mid;</span>
 367 |     | <span class='neutral'>            } else {</span>
 368 |     | <span class='neutral'>                // this cannot overflow because mid &lt; high</span>
 369 |     | <span class='neutral'>                unchecked {</span>
 370 |     | <span class='neutral'>                    low = mid + 1;</span>
 371 |     | <span class='neutral'>                }</span>
 372 |     | <span class='neutral'>            }</span>
 373 |     | <span class='neutral'>        }</span>
 374 |     | <span class='neutral'></span>
 375 |     | <span class='neutral'>        return low;</span>
 376 |     | <span class='neutral'>    }</span>
 377 |     | <span class='neutral'></span>
 378 |     | <span class='neutral'>    /**</span>
 379 |     | <span class='neutral'>     * @dev Access an array in an &quot;unsafe&quot; way. Skips solidity &quot;index-out-of-range&quot; check.</span>
 380 |     | <span class='neutral'>     *</span>
 381 |     | <span class='neutral'>     * WARNING: Only use if you are certain `pos` is lower than the array length.</span>
 382 |     | <span class='neutral'>     */</span>
 383 |     | <span class='neutral'>    function unsafeAccess(address[] storage arr, uint256 pos) internal pure returns (StorageSlot.AddressSlot storage) {</span>
 384 |     | <span class='neutral'>        bytes32 slot;</span>
 385 |     | <span class='neutral'>        assembly (&quot;memory-safe&quot;) {</span>
 386 |     | <span class='neutral'>            slot := arr.slot</span>
 387 |     | <span class='neutral'>        }</span>
 388 |     | <span class='neutral'>        return slot.deriveArray().offset(pos).getAddressSlot();</span>
 389 |     | <span class='neutral'>    }</span>
 390 |     | <span class='neutral'></span>
 391 |     | <span class='neutral'>    /**</span>
 392 |     | <span class='neutral'>     * @dev Access an array in an &quot;unsafe&quot; way. Skips solidity &quot;index-out-of-range&quot; check.</span>
 393 |     | <span class='neutral'>     *</span>
 394 |     | <span class='neutral'>     * WARNING: Only use if you are certain `pos` is lower than the array length.</span>
 395 |     | <span class='neutral'>     */</span>
 396 |     | <span class='neutral'>    function unsafeAccess(bytes32[] storage arr, uint256 pos) internal pure returns (StorageSlot.Bytes32Slot storage) {</span>
 397 |     | <span class='neutral'>        bytes32 slot;</span>
 398 |     | <span class='neutral'>        assembly (&quot;memory-safe&quot;) {</span>
 399 |     | <span class='neutral'>            slot := arr.slot</span>
 400 |     | <span class='neutral'>        }</span>
 401 |     | <span class='neutral'>        return slot.deriveArray().offset(pos).getBytes32Slot();</span>
 402 |     | <span class='neutral'>    }</span>
 403 |     | <span class='neutral'></span>
 404 |     | <span class='neutral'>    /**</span>
 405 |     | <span class='neutral'>     * @dev Access an array in an &quot;unsafe&quot; way. Skips solidity &quot;index-out-of-range&quot; check.</span>
 406 |     | <span class='neutral'>     *</span>
 407 |     | <span class='neutral'>     * WARNING: Only use if you are certain `pos` is lower than the array length.</span>
 408 |     | <span class='neutral'>     */</span>
 409 | *   | <span class='executed'>    function unsafeAccess(uint256[] storage arr, uint256 pos) internal pure returns (StorageSlot.Uint256Slot storage) {</span>
 410 | *   | <span class='executed'>        bytes32 slot;</span>
 411 |     | <span class='neutral'>        assembly (&quot;memory-safe&quot;) {</span>
 412 | *   | <span class='executed'>            slot := arr.slot</span>
 413 |     | <span class='neutral'>        }</span>
 414 | *   | <span class='executed'>        return slot.deriveArray().offset(pos).getUint256Slot();</span>
 415 |     | <span class='neutral'>    }</span>
 416 |     | <span class='neutral'></span>
 417 |     | <span class='neutral'>    /**</span>
 418 |     | <span class='neutral'>     * @dev Access an array in an &quot;unsafe&quot; way. Skips solidity &quot;index-out-of-range&quot; check.</span>
 419 |     | <span class='neutral'>     *</span>
 420 |     | <span class='neutral'>     * WARNING: Only use if you are certain `pos` is lower than the array length.</span>
 421 |     | <span class='neutral'>     */</span>
 422 |     | <span class='neutral'>    function unsafeMemoryAccess(address[] memory arr, uint256 pos) internal pure returns (address res) {</span>
 423 |     | <span class='neutral'>        assembly {</span>
 424 |     | <span class='neutral'>            res := mload(add(add(arr, 0x20), mul(pos, 0x20)))</span>
 425 |     | <span class='neutral'>        }</span>
 426 |     | <span class='neutral'>    }</span>
 427 |     | <span class='neutral'></span>
 428 |     | <span class='neutral'>    /**</span>
 429 |     | <span class='neutral'>     * @dev Access an array in an &quot;unsafe&quot; way. Skips solidity &quot;index-out-of-range&quot; check.</span>
 430 |     | <span class='neutral'>     *</span>
 431 |     | <span class='neutral'>     * WARNING: Only use if you are certain `pos` is lower than the array length.</span>
 432 |     | <span class='neutral'>     */</span>
 433 |     | <span class='neutral'>    function unsafeMemoryAccess(bytes32[] memory arr, uint256 pos) internal pure returns (bytes32 res) {</span>
 434 |     | <span class='neutral'>        assembly {</span>
 435 |     | <span class='neutral'>            res := mload(add(add(arr, 0x20), mul(pos, 0x20)))</span>
 436 |     | <span class='neutral'>        }</span>
 437 |     | <span class='neutral'>    }</span>
 438 |     | <span class='neutral'></span>
 439 |     | <span class='neutral'>    /**</span>
 440 |     | <span class='neutral'>     * @dev Access an array in an &quot;unsafe&quot; way. Skips solidity &quot;index-out-of-range&quot; check.</span>
 441 |     | <span class='neutral'>     *</span>
 442 |     | <span class='neutral'>     * WARNING: Only use if you are certain `pos` is lower than the array length.</span>
 443 |     | <span class='neutral'>     */</span>
 444 |     | <span class='neutral'>    function unsafeMemoryAccess(uint256[] memory arr, uint256 pos) internal pure returns (uint256 res) {</span>
 445 |     | <span class='neutral'>        assembly {</span>
 446 |     | <span class='neutral'>            res := mload(add(add(arr, 0x20), mul(pos, 0x20)))</span>
 447 |     | <span class='neutral'>        }</span>
 448 |     | <span class='neutral'>    }</span>
 449 |     | <span class='neutral'></span>
 450 |     | <span class='neutral'>    /**</span>
 451 |     | <span class='neutral'>     * @dev Helper to set the length of an dynamic array. Directly writing to `.length` is forbidden.</span>
 452 |     | <span class='neutral'>     *</span>
 453 |     | <span class='neutral'>     * WARNING: this does not clear elements if length is reduced, of initialize elements if length is increased.</span>
 454 |     | <span class='neutral'>     */</span>
 455 |     | <span class='neutral'>    function unsafeSetLength(address[] storage array, uint256 len) internal {</span>
 456 |     | <span class='neutral'>        assembly (&quot;memory-safe&quot;) {</span>
 457 |     | <span class='neutral'>            sstore(array.slot, len)</span>
 458 |     | <span class='neutral'>        }</span>
 459 |     | <span class='neutral'>    }</span>
 460 |     | <span class='neutral'></span>
 461 |     | <span class='neutral'>    /**</span>
 462 |     | <span class='neutral'>     * @dev Helper to set the length of an dynamic array. Directly writing to `.length` is forbidden.</span>
 463 |     | <span class='neutral'>     *</span>
 464 |     | <span class='neutral'>     * WARNING: this does not clear elements if length is reduced, of initialize elements if length is increased.</span>
 465 |     | <span class='neutral'>     */</span>
 466 |     | <span class='neutral'>    function unsafeSetLength(bytes32[] storage array, uint256 len) internal {</span>
 467 |     | <span class='neutral'>        assembly (&quot;memory-safe&quot;) {</span>
 468 |     | <span class='neutral'>            sstore(array.slot, len)</span>
 469 |     | <span class='neutral'>        }</span>
 470 |     | <span class='neutral'>    }</span>
 471 |     | <span class='neutral'></span>
 472 |     | <span class='neutral'>    /**</span>
 473 |     | <span class='neutral'>     * @dev Helper to set the length of an dynamic array. Directly writing to `.length` is forbidden.</span>
 474 |     | <span class='neutral'>     *</span>
 475 |     | <span class='neutral'>     * WARNING: this does not clear elements if length is reduced, of initialize elements if length is increased.</span>
 476 |     | <span class='neutral'>     */</span>
 477 |     | <span class='neutral'>    function unsafeSetLength(uint256[] storage array, uint256 len) internal {</span>
 478 |     | <span class='neutral'>        assembly (&quot;memory-safe&quot;) {</span>
 479 |     | <span class='neutral'>            sstore(array.slot, len)</span>
 480 |     | <span class='neutral'>        }</span>
 481 |     | <span class='neutral'>    }</span>
 482 |     | <span class='neutral'>}</span>
 483 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/lib/openzeppelin-contracts/contracts/utils/Comparators.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v5.1.0) (utils/Comparators.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.20;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>/**</span>
  7 |     | <span class='neutral'> * @dev Provides a set of functions to compare values.</span>
  8 |     | <span class='neutral'> *</span>
  9 |     | <span class='neutral'> * _Available since v5.1._</span>
 10 |     | <span class='neutral'> */</span>
 11 |     | <span class='unexecuted'>library Comparators {</span>
 12 |     | <span class='neutral'>    function lt(uint256 a, uint256 b) internal pure returns (bool) {</span>
 13 |     | <span class='neutral'>        return a &lt; b;</span>
 14 |     | <span class='neutral'>    }</span>
 15 |     | <span class='neutral'></span>
 16 |     | <span class='neutral'>    function gt(uint256 a, uint256 b) internal pure returns (bool) {</span>
 17 |     | <span class='neutral'>        return a &gt; b;</span>
 18 |     | <span class='neutral'>    }</span>
 19 |     | <span class='neutral'>}</span>
 20 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/lib/openzeppelin-contracts/contracts/utils/Context.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'></span>
  3 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  4 |     | <span class='neutral'></span>
  5 |     | <span class='neutral'>/**</span>
  6 |     | <span class='neutral'> * @dev Provides information about the current execution context, including the</span>
  7 |     | <span class='neutral'> * sender of the transaction and its data. While these are generally available</span>
  8 |     | <span class='neutral'> * via msg.sender and msg.data, they should not be accessed in such a direct</span>
  9 |     | <span class='neutral'> * manner, since when dealing with meta-transactions the account sending and</span>
 10 |     | <span class='neutral'> * paying for execution may not be the actual sender (as far as an application</span>
 11 |     | <span class='neutral'> * is concerned).</span>
 12 |     | <span class='neutral'> *</span>
 13 |     | <span class='neutral'> * This contract is only required for intermediate, library-like contracts.</span>
 14 |     | <span class='neutral'> */</span>
 15 |     | <span class='neutral'>abstract contract Context {</span>
 16 | *   | <span class='executed'>    function _msgSender() internal view virtual returns (address) {</span>
 17 | *   | <span class='executed'>        return msg.sender;</span>
 18 |     | <span class='neutral'>    }</span>
 19 |     | <span class='neutral'></span>
 20 |     | <span class='neutral'>    function _msgData() internal view virtual returns (bytes calldata) {</span>
 21 |     | <span class='neutral'>        return msg.data;</span>
 22 |     | <span class='neutral'>    }</span>
 23 |     | <span class='neutral'>}</span>
 24 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/lib/openzeppelin-contracts/contracts/utils/Counters.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'></span>
  3 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  4 |     | <span class='neutral'></span>
  5 |     | <span class='neutral'>/**</span>
  6 |     | <span class='neutral'> * @title Counters</span>
  7 |     | <span class='neutral'> * @author Matt Condon (@shrugs)</span>
  8 |     | <span class='neutral'> * @dev Provides counters that can only be incremented, decremented or reset. This can be used e.g. to track the number</span>
  9 |     | <span class='neutral'> * of elements in a mapping, issuing ERC721 ids, or counting request ids.</span>
 10 |     | <span class='neutral'> *</span>
 11 |     | <span class='neutral'> * Include with `using Counters for Counters.Counter;`</span>
 12 |     | <span class='neutral'> */</span>
 13 |     | <span class='unexecuted'>library Counters {</span>
 14 |     | <span class='neutral'>    struct Counter {</span>
 15 |     | <span class='neutral'>        // This variable should never be directly accessed by users of the library: interactions must be restricted to</span>
 16 |     | <span class='neutral'>        // the library&#39;s function. As of Solidity v0.5.2, this cannot be enforced, though there is a proposal to add</span>
 17 |     | <span class='neutral'>        // this feature: see https://github.com/ethereum/solidity/issues/4637</span>
 18 |     | <span class='neutral'>        uint256 _value; // default: 0</span>
 19 |     | <span class='neutral'>    }</span>
 20 |     | <span class='neutral'></span>
 21 | *   | <span class='executed'>    function current(Counter storage counter) internal view returns (uint256) {</span>
 22 | *   | <span class='executed'>        return counter._value;</span>
 23 |     | <span class='neutral'>    }</span>
 24 |     | <span class='neutral'></span>
 25 | *   | <span class='executed'>    function increment(Counter storage counter) internal {</span>
 26 |     | <span class='neutral'>        unchecked {</span>
 27 | *   | <span class='executed'>            counter._value += 1;</span>
 28 |     | <span class='neutral'>        }</span>
 29 |     | <span class='neutral'>    }</span>
 30 |     | <span class='neutral'></span>
 31 |     | <span class='neutral'>    function decrement(Counter storage counter) internal {</span>
 32 |     | <span class='neutral'>        uint256 value = counter._value;</span>
 33 |     | <span class='neutral'>        require(value &gt; 0, &quot;Counter: decrement overflow&quot;);</span>
 34 |     | <span class='neutral'>        unchecked {</span>
 35 |     | <span class='neutral'>            counter._value = value - 1;</span>
 36 |     | <span class='neutral'>        }</span>
 37 |     | <span class='neutral'>    }</span>
 38 |     | <span class='neutral'></span>
 39 |     | <span class='neutral'>    function reset(Counter storage counter) internal {</span>
 40 |     | <span class='neutral'>        counter._value = 0;</span>
 41 |     | <span class='neutral'>    }</span>
 42 |     | <span class='neutral'>}</span>
 43 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/lib/openzeppelin-contracts/contracts/utils/Panic.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v5.1.0) (utils/Panic.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.20;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>/**</span>
  7 |     | <span class='neutral'> * @dev Helper library for emitting standardized panic codes.</span>
  8 |     | <span class='neutral'> *</span>
  9 |     | <span class='neutral'> * ```solidity</span>
 10 |     | <span class='neutral'> * contract Example {</span>
 11 |     | <span class='neutral'> *      using Panic for uint256;</span>
 12 |     | <span class='neutral'> *</span>
 13 |     | <span class='neutral'> *      // Use any of the declared internal constants</span>
 14 |     | <span class='neutral'> *      function foo() { Panic.GENERIC.panic(); }</span>
 15 |     | <span class='neutral'> *</span>
 16 |     | <span class='neutral'> *      // Alternatively</span>
 17 |     | <span class='neutral'> *      function foo() { Panic.panic(Panic.GENERIC); }</span>
 18 |     | <span class='neutral'> * }</span>
 19 |     | <span class='neutral'> * ```</span>
 20 |     | <span class='neutral'> *</span>
 21 |     | <span class='neutral'> * Follows the list from https://github.com/ethereum/solidity/blob/v0.8.24/libsolutil/ErrorCodes.h[libsolutil].</span>
 22 |     | <span class='neutral'> *</span>
 23 |     | <span class='neutral'> * _Available since v5.1._</span>
 24 |     | <span class='neutral'> */</span>
 25 |     | <span class='neutral'>// slither-disable-next-line unused-state</span>
 26 |     | <span class='unexecuted'>library Panic {</span>
 27 |     | <span class='neutral'>    /// @dev generic / unspecified error</span>
 28 |     | <span class='neutral'>    uint256 internal constant GENERIC = 0x00;</span>
 29 |     | <span class='neutral'>    /// @dev used by the assert() builtin</span>
 30 |     | <span class='neutral'>    uint256 internal constant ASSERT = 0x01;</span>
 31 |     | <span class='neutral'>    /// @dev arithmetic underflow or overflow</span>
 32 |     | <span class='neutral'>    uint256 internal constant UNDER_OVERFLOW = 0x11;</span>
 33 |     | <span class='neutral'>    /// @dev division or modulo by zero</span>
 34 |     | <span class='neutral'>    uint256 internal constant DIVISION_BY_ZERO = 0x12;</span>
 35 |     | <span class='neutral'>    /// @dev enum conversion error</span>
 36 |     | <span class='neutral'>    uint256 internal constant ENUM_CONVERSION_ERROR = 0x21;</span>
 37 |     | <span class='neutral'>    /// @dev invalid encoding in storage</span>
 38 |     | <span class='neutral'>    uint256 internal constant STORAGE_ENCODING_ERROR = 0x22;</span>
 39 |     | <span class='neutral'>    /// @dev empty array pop</span>
 40 |     | <span class='neutral'>    uint256 internal constant EMPTY_ARRAY_POP = 0x31;</span>
 41 |     | <span class='neutral'>    /// @dev array out of bounds access</span>
 42 |     | <span class='neutral'>    uint256 internal constant ARRAY_OUT_OF_BOUNDS = 0x32;</span>
 43 |     | <span class='neutral'>    /// @dev resource error (too large allocation or too large array)</span>
 44 |     | <span class='neutral'>    uint256 internal constant RESOURCE_ERROR = 0x41;</span>
 45 |     | <span class='neutral'>    /// @dev calling invalid internal function</span>
 46 |     | <span class='neutral'>    uint256 internal constant INVALID_INTERNAL_FUNCTION = 0x51;</span>
 47 |     | <span class='neutral'></span>
 48 |     | <span class='neutral'>    /// @dev Reverts with a panic code. Recommended to use with</span>
 49 |     | <span class='neutral'>    /// the internal constants with predefined codes.</span>
 50 |     | <span class='neutral'>    function panic(uint256 code) internal pure {</span>
 51 |     | <span class='neutral'>        assembly (&quot;memory-safe&quot;) {</span>
 52 |     | <span class='neutral'>            mstore(0x00, 0x4e487b71)</span>
 53 |     | <span class='neutral'>            mstore(0x20, code)</span>
 54 |     | <span class='neutral'>            revert(0x1c, 0x24)</span>
 55 |     | <span class='neutral'>        }</span>
 56 |     | <span class='neutral'>    }</span>
 57 |     | <span class='neutral'>}</span>
 58 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/lib/openzeppelin-contracts/contracts/utils/ReentrancyGuard.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'></span>
  3 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  4 |     | <span class='neutral'></span>
  5 |     | <span class='neutral'>/**</span>
  6 |     | <span class='neutral'> * @dev Contract module that helps prevent reentrant calls to a function.</span>
  7 |     | <span class='neutral'> *</span>
  8 |     | <span class='neutral'> * Inheriting from `ReentrancyGuard` will make the {nonReentrant} modifier</span>
  9 |     | <span class='neutral'> * available, which can be applied to functions to make sure there are no nested</span>
 10 |     | <span class='neutral'> * (reentrant) calls to them.</span>
 11 |     | <span class='neutral'> *</span>
 12 |     | <span class='neutral'> * Note that because there is a single `nonReentrant` guard, functions marked as</span>
 13 |     | <span class='neutral'> * `nonReentrant` may not call one another. This can be worked around by making</span>
 14 |     | <span class='neutral'> * those functions `private`, and then adding `external` `nonReentrant` entry</span>
 15 |     | <span class='neutral'> * points to them.</span>
 16 |     | <span class='neutral'> *</span>
 17 |     | <span class='neutral'> * TIP: If you would like to learn more about reentrancy and alternative ways</span>
 18 |     | <span class='neutral'> * to protect against it, check out our blog post</span>
 19 |     | <span class='neutral'> * https://blog.openzeppelin.com/reentrancy-after-istanbul/[Reentrancy After Istanbul].</span>
 20 |     | <span class='neutral'> */</span>
 21 |     | <span class='neutral'>abstract contract ReentrancyGuard {</span>
 22 |     | <span class='neutral'>    // Booleans are more expensive than uint256 or any type that takes up a full</span>
 23 |     | <span class='neutral'>    // word because each write operation emits an extra SLOAD to first read the</span>
 24 |     | <span class='neutral'>    // slot&#39;s contents, replace the bits taken up by the boolean, and then write</span>
 25 |     | <span class='neutral'>    // back. This is the compiler&#39;s defense against contract upgrades and</span>
 26 |     | <span class='neutral'>    // pointer aliasing, and it cannot be disabled.</span>
 27 |     | <span class='neutral'></span>
 28 |     | <span class='neutral'>    // The values being non-zero value makes deployment a bit more expensive,</span>
 29 |     | <span class='neutral'>    // but in exchange the refund on every call to nonReentrant will be lower in</span>
 30 |     | <span class='neutral'>    // amount. Since refunds are capped to a percentage of the total</span>
 31 |     | <span class='neutral'>    // transaction&#39;s gas, it is best to keep them low in cases like this one, to</span>
 32 |     | <span class='neutral'>    // increase the likelihood of the full refund coming into effect.</span>
 33 | *   | <span class='executed'>    uint256 private constant _NOT_ENTERED = 1;</span>
 34 | *   | <span class='executed'>    uint256 private constant _ENTERED = 2;</span>
 35 |     | <span class='neutral'></span>
 36 |     | <span class='neutral'>    uint256 private _status;</span>
 37 |     | <span class='neutral'></span>
 38 |     | <span class='neutral'>    constructor() {</span>
 39 | *   | <span class='executed'>        _status = _NOT_ENTERED;</span>
 40 |     | <span class='neutral'>    }</span>
 41 |     | <span class='neutral'></span>
 42 |     | <span class='neutral'>    /**</span>
 43 |     | <span class='neutral'>     * @dev Prevents a contract from calling itself, directly or indirectly.</span>
 44 |     | <span class='neutral'>     * Calling a `nonReentrant` function from another `nonReentrant`</span>
 45 |     | <span class='neutral'>     * function is not supported. It is possible to prevent this from happening</span>
 46 |     | <span class='neutral'>     * by making the `nonReentrant` function external, and make it call a</span>
 47 |     | <span class='neutral'>     * `private` function that does the actual work.</span>
 48 |     | <span class='neutral'>     */</span>
 49 |     | <span class='neutral'>    modifier nonReentrant() {</span>
 50 |     | <span class='neutral'>        // On the first call to nonReentrant, _notEntered will be true</span>
 51 | *   | <span class='executed'>        require(_status != _ENTERED, &quot;ReentrancyGuard: reentrant call&quot;);</span>
 52 |     | <span class='neutral'></span>
 53 |     | <span class='neutral'>        // Any calls to nonReentrant after this point will fail</span>
 54 | *   | <span class='executed'>        _status = _ENTERED;</span>
 55 |     | <span class='neutral'></span>
 56 |     | <span class='neutral'>        _;</span>
 57 |     | <span class='neutral'></span>
 58 |     | <span class='neutral'>        // By storing the original value once again, a refund is triggered (see</span>
 59 |     | <span class='neutral'>        // https://eips.ethereum.org/EIPS/eip-2200)</span>
 60 | *   | <span class='executed'>        _status = _NOT_ENTERED;</span>
 61 |     | <span class='neutral'>    }</span>
 62 |     | <span class='neutral'>}</span>
 63 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/lib/openzeppelin-contracts/contracts/utils/SlotDerivation.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v5.1.0) (utils/SlotDerivation.sol)</span>
   3 |     | <span class='neutral'>// This file was procedurally generated from scripts/generate/templates/SlotDerivation.js.</span>
   4 |     | <span class='neutral'></span>
   5 |     | <span class='neutral'>pragma solidity ^0.8.20;</span>
   6 |     | <span class='neutral'></span>
   7 |     | <span class='neutral'>/**</span>
   8 |     | <span class='neutral'> * @dev Library for computing storage (and transient storage) locations from namespaces and deriving slots</span>
   9 |     | <span class='neutral'> * corresponding to standard patterns. The derivation method for array and mapping matches the storage layout used by</span>
  10 |     | <span class='neutral'> * the solidity language / compiler.</span>
  11 |     | <span class='neutral'> *</span>
  12 |     | <span class='neutral'> * See https://docs.soliditylang.org/en/v0.8.20/internals/layout_in_storage.html#mappings-and-dynamic-arrays[Solidity docs for mappings and dynamic arrays.].</span>
  13 |     | <span class='neutral'> *</span>
  14 |     | <span class='neutral'> * Example usage:</span>
  15 |     | <span class='neutral'> * ```solidity</span>
  16 |     | <span class='neutral'> * contract Example {</span>
  17 |     | <span class='neutral'> *     // Add the library methods</span>
  18 |     | <span class='neutral'> *     using StorageSlot for bytes32;</span>
  19 |     | <span class='neutral'> *     using SlotDerivation for bytes32;</span>
  20 |     | <span class='neutral'> *</span>
  21 |     | <span class='neutral'> *     // Declare a namespace</span>
  22 |     | <span class='neutral'> *     string private constant _NAMESPACE = &quot;&lt;namespace&gt;&quot; // eg. OpenZeppelin.Slot</span>
  23 |     | <span class='neutral'> *</span>
  24 |     | <span class='neutral'> *     function setValueInNamespace(uint256 key, address newValue) internal {</span>
  25 |     | <span class='neutral'> *         _NAMESPACE.erc7201Slot().deriveMapping(key).getAddressSlot().value = newValue;</span>
  26 |     | <span class='neutral'> *     }</span>
  27 |     | <span class='neutral'> *</span>
  28 |     | <span class='neutral'> *     function getValueInNamespace(uint256 key) internal view returns (address) {</span>
  29 |     | <span class='neutral'> *         return _NAMESPACE.erc7201Slot().deriveMapping(key).getAddressSlot().value;</span>
  30 |     | <span class='neutral'> *     }</span>
  31 |     | <span class='neutral'> * }</span>
  32 |     | <span class='neutral'> * ```</span>
  33 |     | <span class='neutral'> *</span>
  34 |     | <span class='neutral'> * TIP: Consider using this library along with {StorageSlot}.</span>
  35 |     | <span class='neutral'> *</span>
  36 |     | <span class='neutral'> * NOTE: This library provides a way to manipulate storage locations in a non-standard way. Tooling for checking</span>
  37 |     | <span class='neutral'> * upgrade safety will ignore the slots accessed through this library.</span>
  38 |     | <span class='neutral'> *</span>
  39 |     | <span class='neutral'> * _Available since v5.1._</span>
  40 |     | <span class='neutral'> */</span>
  41 |     | <span class='unexecuted'>library SlotDerivation {</span>
  42 |     | <span class='neutral'>    /**</span>
  43 |     | <span class='neutral'>     * @dev Derive an ERC-7201 slot from a string (namespace).</span>
  44 |     | <span class='neutral'>     */</span>
  45 |     | <span class='neutral'>    function erc7201Slot(string memory namespace) internal pure returns (bytes32 slot) {</span>
  46 |     | <span class='neutral'>        assembly (&quot;memory-safe&quot;) {</span>
  47 |     | <span class='neutral'>            mstore(0x00, sub(keccak256(add(namespace, 0x20), mload(namespace)), 1))</span>
  48 |     | <span class='neutral'>            slot := and(keccak256(0x00, 0x20), not(0xff))</span>
  49 |     | <span class='neutral'>        }</span>
  50 |     | <span class='neutral'>    }</span>
  51 |     | <span class='neutral'></span>
  52 |     | <span class='neutral'>    /**</span>
  53 |     | <span class='neutral'>     * @dev Add an offset to a slot to get the n-th element of a structure or an array.</span>
  54 |     | <span class='neutral'>     */</span>
  55 | *   | <span class='executed'>    function offset(bytes32 slot, uint256 pos) internal pure returns (bytes32 result) {</span>
  56 |     | <span class='neutral'>        unchecked {</span>
  57 | *   | <span class='executed'>            return bytes32(uint256(slot) + pos);</span>
  58 |     | <span class='neutral'>        }</span>
  59 |     | <span class='neutral'>    }</span>
  60 |     | <span class='neutral'></span>
  61 |     | <span class='neutral'>    /**</span>
  62 |     | <span class='neutral'>     * @dev Derive the location of the first element in an array from the slot where the length is stored.</span>
  63 |     | <span class='neutral'>     */</span>
  64 | *   | <span class='executed'>    function deriveArray(bytes32 slot) internal pure returns (bytes32 result) {</span>
  65 |     | <span class='neutral'>        assembly (&quot;memory-safe&quot;) {</span>
  66 | *   | <span class='executed'>            mstore(0x00, slot)</span>
  67 | *   | <span class='executed'>            result := keccak256(0x00, 0x20)</span>
  68 |     | <span class='neutral'>        }</span>
  69 |     | <span class='neutral'>    }</span>
  70 |     | <span class='neutral'></span>
  71 |     | <span class='neutral'>    /**</span>
  72 |     | <span class='neutral'>     * @dev Derive the location of a mapping element from the key.</span>
  73 |     | <span class='neutral'>     */</span>
  74 |     | <span class='neutral'>    function deriveMapping(bytes32 slot, address key) internal pure returns (bytes32 result) {</span>
  75 |     | <span class='neutral'>        assembly (&quot;memory-safe&quot;) {</span>
  76 |     | <span class='neutral'>            mstore(0x00, and(key, shr(96, not(0))))</span>
  77 |     | <span class='neutral'>            mstore(0x20, slot)</span>
  78 |     | <span class='neutral'>            result := keccak256(0x00, 0x40)</span>
  79 |     | <span class='neutral'>        }</span>
  80 |     | <span class='neutral'>    }</span>
  81 |     | <span class='neutral'></span>
  82 |     | <span class='neutral'>    /**</span>
  83 |     | <span class='neutral'>     * @dev Derive the location of a mapping element from the key.</span>
  84 |     | <span class='neutral'>     */</span>
  85 |     | <span class='neutral'>    function deriveMapping(bytes32 slot, bool key) internal pure returns (bytes32 result) {</span>
  86 |     | <span class='neutral'>        assembly (&quot;memory-safe&quot;) {</span>
  87 |     | <span class='neutral'>            mstore(0x00, iszero(iszero(key)))</span>
  88 |     | <span class='neutral'>            mstore(0x20, slot)</span>
  89 |     | <span class='neutral'>            result := keccak256(0x00, 0x40)</span>
  90 |     | <span class='neutral'>        }</span>
  91 |     | <span class='neutral'>    }</span>
  92 |     | <span class='neutral'></span>
  93 |     | <span class='neutral'>    /**</span>
  94 |     | <span class='neutral'>     * @dev Derive the location of a mapping element from the key.</span>
  95 |     | <span class='neutral'>     */</span>
  96 |     | <span class='neutral'>    function deriveMapping(bytes32 slot, bytes32 key) internal pure returns (bytes32 result) {</span>
  97 |     | <span class='neutral'>        assembly (&quot;memory-safe&quot;) {</span>
  98 |     | <span class='neutral'>            mstore(0x00, key)</span>
  99 |     | <span class='neutral'>            mstore(0x20, slot)</span>
 100 |     | <span class='neutral'>            result := keccak256(0x00, 0x40)</span>
 101 |     | <span class='neutral'>        }</span>
 102 |     | <span class='neutral'>    }</span>
 103 |     | <span class='neutral'></span>
 104 |     | <span class='neutral'>    /**</span>
 105 |     | <span class='neutral'>     * @dev Derive the location of a mapping element from the key.</span>
 106 |     | <span class='neutral'>     */</span>
 107 |     | <span class='neutral'>    function deriveMapping(bytes32 slot, uint256 key) internal pure returns (bytes32 result) {</span>
 108 |     | <span class='neutral'>        assembly (&quot;memory-safe&quot;) {</span>
 109 |     | <span class='neutral'>            mstore(0x00, key)</span>
 110 |     | <span class='neutral'>            mstore(0x20, slot)</span>
 111 |     | <span class='neutral'>            result := keccak256(0x00, 0x40)</span>
 112 |     | <span class='neutral'>        }</span>
 113 |     | <span class='neutral'>    }</span>
 114 |     | <span class='neutral'></span>
 115 |     | <span class='neutral'>    /**</span>
 116 |     | <span class='neutral'>     * @dev Derive the location of a mapping element from the key.</span>
 117 |     | <span class='neutral'>     */</span>
 118 |     | <span class='neutral'>    function deriveMapping(bytes32 slot, int256 key) internal pure returns (bytes32 result) {</span>
 119 |     | <span class='neutral'>        assembly (&quot;memory-safe&quot;) {</span>
 120 |     | <span class='neutral'>            mstore(0x00, key)</span>
 121 |     | <span class='neutral'>            mstore(0x20, slot)</span>
 122 |     | <span class='neutral'>            result := keccak256(0x00, 0x40)</span>
 123 |     | <span class='neutral'>        }</span>
 124 |     | <span class='neutral'>    }</span>
 125 |     | <span class='neutral'></span>
 126 |     | <span class='neutral'>    /**</span>
 127 |     | <span class='neutral'>     * @dev Derive the location of a mapping element from the key.</span>
 128 |     | <span class='neutral'>     */</span>
 129 |     | <span class='neutral'>    function deriveMapping(bytes32 slot, string memory key) internal pure returns (bytes32 result) {</span>
 130 |     | <span class='neutral'>        assembly (&quot;memory-safe&quot;) {</span>
 131 |     | <span class='neutral'>            let length := mload(key)</span>
 132 |     | <span class='neutral'>            let begin := add(key, 0x20)</span>
 133 |     | <span class='neutral'>            let end := add(begin, length)</span>
 134 |     | <span class='neutral'>            let cache := mload(end)</span>
 135 |     | <span class='neutral'>            mstore(end, slot)</span>
 136 |     | <span class='neutral'>            result := keccak256(begin, add(length, 0x20))</span>
 137 |     | <span class='neutral'>            mstore(end, cache)</span>
 138 |     | <span class='neutral'>        }</span>
 139 |     | <span class='neutral'>    }</span>
 140 |     | <span class='neutral'></span>
 141 |     | <span class='neutral'>    /**</span>
 142 |     | <span class='neutral'>     * @dev Derive the location of a mapping element from the key.</span>
 143 |     | <span class='neutral'>     */</span>
 144 |     | <span class='neutral'>    function deriveMapping(bytes32 slot, bytes memory key) internal pure returns (bytes32 result) {</span>
 145 |     | <span class='neutral'>        assembly (&quot;memory-safe&quot;) {</span>
 146 |     | <span class='neutral'>            let length := mload(key)</span>
 147 |     | <span class='neutral'>            let begin := add(key, 0x20)</span>
 148 |     | <span class='neutral'>            let end := add(begin, length)</span>
 149 |     | <span class='neutral'>            let cache := mload(end)</span>
 150 |     | <span class='neutral'>            mstore(end, slot)</span>
 151 |     | <span class='neutral'>            result := keccak256(begin, add(length, 0x20))</span>
 152 |     | <span class='neutral'>            mstore(end, cache)</span>
 153 |     | <span class='neutral'>        }</span>
 154 |     | <span class='neutral'>    }</span>
 155 |     | <span class='neutral'>}</span>
 156 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/lib/openzeppelin-contracts/contracts/utils/StorageSlot.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v5.1.0) (utils/StorageSlot.sol)</span>
   3 |     | <span class='neutral'>// This file was procedurally generated from scripts/generate/templates/StorageSlot.js.</span>
   4 |     | <span class='neutral'></span>
   5 |     | <span class='neutral'>pragma solidity ^0.8.20;</span>
   6 |     | <span class='neutral'></span>
   7 |     | <span class='neutral'>/**</span>
   8 |     | <span class='neutral'> * @dev Library for reading and writing primitive types to specific storage slots.</span>
   9 |     | <span class='neutral'> *</span>
  10 |     | <span class='neutral'> * Storage slots are often used to avoid storage conflict when dealing with upgradeable contracts.</span>
  11 |     | <span class='neutral'> * This library helps with reading and writing to such slots without the need for inline assembly.</span>
  12 |     | <span class='neutral'> *</span>
  13 |     | <span class='neutral'> * The functions in this library return Slot structs that contain a `value` member that can be used to read or write.</span>
  14 |     | <span class='neutral'> *</span>
  15 |     | <span class='neutral'> * Example usage to set ERC-1967 implementation slot:</span>
  16 |     | <span class='neutral'> * ```solidity</span>
  17 |     | <span class='neutral'> * contract ERC1967 {</span>
  18 |     | <span class='neutral'> *     // Define the slot. Alternatively, use the SlotDerivation library to derive the slot.</span>
  19 |     | <span class='neutral'> *     bytes32 internal constant _IMPLEMENTATION_SLOT = 0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc;</span>
  20 |     | <span class='neutral'> *</span>
  21 |     | <span class='neutral'> *     function _getImplementation() internal view returns (address) {</span>
  22 |     | <span class='neutral'> *         return StorageSlot.getAddressSlot(_IMPLEMENTATION_SLOT).value;</span>
  23 |     | <span class='neutral'> *     }</span>
  24 |     | <span class='neutral'> *</span>
  25 |     | <span class='neutral'> *     function _setImplementation(address newImplementation) internal {</span>
  26 |     | <span class='neutral'> *         require(newImplementation.code.length &gt; 0);</span>
  27 |     | <span class='neutral'> *         StorageSlot.getAddressSlot(_IMPLEMENTATION_SLOT).value = newImplementation;</span>
  28 |     | <span class='neutral'> *     }</span>
  29 |     | <span class='neutral'> * }</span>
  30 |     | <span class='neutral'> * ```</span>
  31 |     | <span class='neutral'> *</span>
  32 |     | <span class='neutral'> * TIP: Consider using this library along with {SlotDerivation}.</span>
  33 |     | <span class='neutral'> */</span>
  34 |     | <span class='unexecuted'>library StorageSlot {</span>
  35 |     | <span class='neutral'>    struct AddressSlot {</span>
  36 |     | <span class='neutral'>        address value;</span>
  37 |     | <span class='neutral'>    }</span>
  38 |     | <span class='neutral'></span>
  39 |     | <span class='neutral'>    struct BooleanSlot {</span>
  40 |     | <span class='neutral'>        bool value;</span>
  41 |     | <span class='neutral'>    }</span>
  42 |     | <span class='neutral'></span>
  43 |     | <span class='neutral'>    struct Bytes32Slot {</span>
  44 |     | <span class='neutral'>        bytes32 value;</span>
  45 |     | <span class='neutral'>    }</span>
  46 |     | <span class='neutral'></span>
  47 |     | <span class='neutral'>    struct Uint256Slot {</span>
  48 |     | <span class='neutral'>        uint256 value;</span>
  49 |     | <span class='neutral'>    }</span>
  50 |     | <span class='neutral'></span>
  51 |     | <span class='neutral'>    struct Int256Slot {</span>
  52 |     | <span class='neutral'>        int256 value;</span>
  53 |     | <span class='neutral'>    }</span>
  54 |     | <span class='neutral'></span>
  55 |     | <span class='neutral'>    struct StringSlot {</span>
  56 |     | <span class='neutral'>        string value;</span>
  57 |     | <span class='neutral'>    }</span>
  58 |     | <span class='neutral'></span>
  59 |     | <span class='neutral'>    struct BytesSlot {</span>
  60 |     | <span class='neutral'>        bytes value;</span>
  61 |     | <span class='neutral'>    }</span>
  62 |     | <span class='neutral'></span>
  63 |     | <span class='neutral'>    /**</span>
  64 |     | <span class='neutral'>     * @dev Returns an `AddressSlot` with member `value` located at `slot`.</span>
  65 |     | <span class='neutral'>     */</span>
  66 |     | <span class='neutral'>    function getAddressSlot(bytes32 slot) internal pure returns (AddressSlot storage r) {</span>
  67 |     | <span class='neutral'>        assembly (&quot;memory-safe&quot;) {</span>
  68 |     | <span class='neutral'>            r.slot := slot</span>
  69 |     | <span class='neutral'>        }</span>
  70 |     | <span class='neutral'>    }</span>
  71 |     | <span class='neutral'></span>
  72 |     | <span class='neutral'>    /**</span>
  73 |     | <span class='neutral'>     * @dev Returns a `BooleanSlot` with member `value` located at `slot`.</span>
  74 |     | <span class='neutral'>     */</span>
  75 |     | <span class='neutral'>    function getBooleanSlot(bytes32 slot) internal pure returns (BooleanSlot storage r) {</span>
  76 |     | <span class='neutral'>        assembly (&quot;memory-safe&quot;) {</span>
  77 |     | <span class='neutral'>            r.slot := slot</span>
  78 |     | <span class='neutral'>        }</span>
  79 |     | <span class='neutral'>    }</span>
  80 |     | <span class='neutral'></span>
  81 |     | <span class='neutral'>    /**</span>
  82 |     | <span class='neutral'>     * @dev Returns a `Bytes32Slot` with member `value` located at `slot`.</span>
  83 |     | <span class='neutral'>     */</span>
  84 |     | <span class='neutral'>    function getBytes32Slot(bytes32 slot) internal pure returns (Bytes32Slot storage r) {</span>
  85 |     | <span class='neutral'>        assembly (&quot;memory-safe&quot;) {</span>
  86 |     | <span class='neutral'>            r.slot := slot</span>
  87 |     | <span class='neutral'>        }</span>
  88 |     | <span class='neutral'>    }</span>
  89 |     | <span class='neutral'></span>
  90 |     | <span class='neutral'>    /**</span>
  91 |     | <span class='neutral'>     * @dev Returns a `Uint256Slot` with member `value` located at `slot`.</span>
  92 |     | <span class='neutral'>     */</span>
  93 | *   | <span class='executed'>    function getUint256Slot(bytes32 slot) internal pure returns (Uint256Slot storage r) {</span>
  94 |     | <span class='neutral'>        assembly (&quot;memory-safe&quot;) {</span>
  95 | *   | <span class='executed'>            r.slot := slot</span>
  96 |     | <span class='neutral'>        }</span>
  97 |     | <span class='neutral'>    }</span>
  98 |     | <span class='neutral'></span>
  99 |     | <span class='neutral'>    /**</span>
 100 |     | <span class='neutral'>     * @dev Returns a `Int256Slot` with member `value` located at `slot`.</span>
 101 |     | <span class='neutral'>     */</span>
 102 |     | <span class='neutral'>    function getInt256Slot(bytes32 slot) internal pure returns (Int256Slot storage r) {</span>
 103 |     | <span class='neutral'>        assembly (&quot;memory-safe&quot;) {</span>
 104 |     | <span class='neutral'>            r.slot := slot</span>
 105 |     | <span class='neutral'>        }</span>
 106 |     | <span class='neutral'>    }</span>
 107 |     | <span class='neutral'></span>
 108 |     | <span class='neutral'>    /**</span>
 109 |     | <span class='neutral'>     * @dev Returns a `StringSlot` with member `value` located at `slot`.</span>
 110 |     | <span class='neutral'>     */</span>
 111 |     | <span class='neutral'>    function getStringSlot(bytes32 slot) internal pure returns (StringSlot storage r) {</span>
 112 |     | <span class='neutral'>        assembly (&quot;memory-safe&quot;) {</span>
 113 |     | <span class='neutral'>            r.slot := slot</span>
 114 |     | <span class='neutral'>        }</span>
 115 |     | <span class='neutral'>    }</span>
 116 |     | <span class='neutral'></span>
 117 |     | <span class='neutral'>    /**</span>
 118 |     | <span class='neutral'>     * @dev Returns an `StringSlot` representation of the string storage pointer `store`.</span>
 119 |     | <span class='neutral'>     */</span>
 120 |     | <span class='neutral'>    function getStringSlot(string storage store) internal pure returns (StringSlot storage r) {</span>
 121 |     | <span class='neutral'>        assembly (&quot;memory-safe&quot;) {</span>
 122 |     | <span class='neutral'>            r.slot := store.slot</span>
 123 |     | <span class='neutral'>        }</span>
 124 |     | <span class='neutral'>    }</span>
 125 |     | <span class='neutral'></span>
 126 |     | <span class='neutral'>    /**</span>
 127 |     | <span class='neutral'>     * @dev Returns a `BytesSlot` with member `value` located at `slot`.</span>
 128 |     | <span class='neutral'>     */</span>
 129 |     | <span class='neutral'>    function getBytesSlot(bytes32 slot) internal pure returns (BytesSlot storage r) {</span>
 130 |     | <span class='neutral'>        assembly (&quot;memory-safe&quot;) {</span>
 131 |     | <span class='neutral'>            r.slot := slot</span>
 132 |     | <span class='neutral'>        }</span>
 133 |     | <span class='neutral'>    }</span>
 134 |     | <span class='neutral'></span>
 135 |     | <span class='neutral'>    /**</span>
 136 |     | <span class='neutral'>     * @dev Returns an `BytesSlot` representation of the bytes storage pointer `store`.</span>
 137 |     | <span class='neutral'>     */</span>
 138 |     | <span class='neutral'>    function getBytesSlot(bytes storage store) internal pure returns (BytesSlot storage r) {</span>
 139 |     | <span class='neutral'>        assembly (&quot;memory-safe&quot;) {</span>
 140 |     | <span class='neutral'>            r.slot := store.slot</span>
 141 |     | <span class='neutral'>        }</span>
 142 |     | <span class='neutral'>    }</span>
 143 |     | <span class='neutral'>}</span>
 144 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/lib/openzeppelin-contracts/contracts/utils/Strings.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'></span>
  3 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  4 |     | <span class='neutral'></span>
  5 |     | <span class='neutral'>/**</span>
  6 |     | <span class='neutral'> * @dev String operations.</span>
  7 |     | <span class='neutral'> */</span>
  8 |     | <span class='unexecuted'>library Strings {</span>
  9 |     | <span class='neutral'>    bytes16 private constant _HEX_SYMBOLS = &quot;0123456789abcdef&quot;;</span>
 10 |     | <span class='neutral'></span>
 11 |     | <span class='neutral'>    /**</span>
 12 |     | <span class='neutral'>     * @dev Converts a `uint256` to its ASCII `string` decimal representation.</span>
 13 |     | <span class='neutral'>     */</span>
 14 |     | <span class='neutral'>    function toString(uint256 value) internal pure returns (string memory) {</span>
 15 |     | <span class='neutral'>        // Inspired by OraclizeAPI&#39;s implementation - MIT licence</span>
 16 |     | <span class='neutral'>        // https://github.com/oraclize/ethereum-api/blob/b42146b063c7d6ee1358846c198246239e9360e8/oraclizeAPI_0.4.25.sol</span>
 17 |     | <span class='neutral'></span>
 18 |     | <span class='neutral'>        if (value == 0) {</span>
 19 |     | <span class='neutral'>            return &quot;0&quot;;</span>
 20 |     | <span class='neutral'>        }</span>
 21 |     | <span class='neutral'>        uint256 temp = value;</span>
 22 |     | <span class='neutral'>        uint256 digits;</span>
 23 |     | <span class='neutral'>        while (temp != 0) {</span>
 24 |     | <span class='neutral'>            digits++;</span>
 25 |     | <span class='neutral'>            temp /= 10;</span>
 26 |     | <span class='neutral'>        }</span>
 27 |     | <span class='neutral'>        bytes memory buffer = new bytes(digits);</span>
 28 |     | <span class='neutral'>        while (value != 0) {</span>
 29 |     | <span class='neutral'>            digits -= 1;</span>
 30 |     | <span class='neutral'>            buffer[digits] = bytes1(uint8(48 + uint256(value % 10)));</span>
 31 |     | <span class='neutral'>            value /= 10;</span>
 32 |     | <span class='neutral'>        }</span>
 33 |     | <span class='neutral'>        return string(buffer);</span>
 34 |     | <span class='neutral'>    }</span>
 35 |     | <span class='neutral'></span>
 36 |     | <span class='neutral'>    /**</span>
 37 |     | <span class='neutral'>     * @dev Converts a `uint256` to its ASCII `string` hexadecimal representation.</span>
 38 |     | <span class='neutral'>     */</span>
 39 |     | <span class='neutral'>    function toHexString(uint256 value) internal pure returns (string memory) {</span>
 40 |     | <span class='neutral'>        if (value == 0) {</span>
 41 |     | <span class='neutral'>            return &quot;0x00&quot;;</span>
 42 |     | <span class='neutral'>        }</span>
 43 |     | <span class='neutral'>        uint256 temp = value;</span>
 44 |     | <span class='neutral'>        uint256 length = 0;</span>
 45 |     | <span class='neutral'>        while (temp != 0) {</span>
 46 |     | <span class='neutral'>            length++;</span>
 47 |     | <span class='neutral'>            temp &gt;&gt;= 8;</span>
 48 |     | <span class='neutral'>        }</span>
 49 |     | <span class='neutral'>        return toHexString(value, length);</span>
 50 |     | <span class='neutral'>    }</span>
 51 |     | <span class='neutral'></span>
 52 |     | <span class='neutral'>    /**</span>
 53 |     | <span class='neutral'>     * @dev Converts a `uint256` to its ASCII `string` hexadecimal representation with fixed length.</span>
 54 |     | <span class='neutral'>     */</span>
 55 | *   | <span class='executed'>    function toHexString(uint256 value, uint256 length) internal pure returns (string memory) {</span>
 56 | *   | <span class='executed'>        bytes memory buffer = new bytes(2 * length + 2);</span>
 57 | *   | <span class='executed'>        buffer[0] = &quot;0&quot;;</span>
 58 | *   | <span class='executed'>        buffer[1] = &quot;x&quot;;</span>
 59 | *   | <span class='executed'>        for (uint256 i = 2 * length + 1; i &gt; 1; --i) {</span>
 60 | *   | <span class='executed'>            buffer[i] = _HEX_SYMBOLS[value &amp; 0xf];</span>
 61 | *   | <span class='executed'>            value &gt;&gt;= 4;</span>
 62 |     | <span class='neutral'>        }</span>
 63 | *   | <span class='executed'>        require(value == 0, &quot;Strings: hex length insufficient&quot;);</span>
 64 | *   | <span class='executed'>        return string(buffer);</span>
 65 |     | <span class='neutral'>    }</span>
 66 |     | <span class='neutral'>}</span>
 67 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/lib/openzeppelin-contracts/contracts/utils/introspection/ERC165.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'></span>
  3 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  4 |     | <span class='neutral'></span>
  5 |     | <span class='neutral'>import &quot;./IERC165.sol&quot;;</span>
  6 |     | <span class='neutral'></span>
  7 |     | <span class='neutral'>/**</span>
  8 |     | <span class='neutral'> * @dev Implementation of the {IERC165} interface.</span>
  9 |     | <span class='neutral'> *</span>
 10 |     | <span class='neutral'> * Contracts that want to implement ERC165 should inherit from this contract and override {supportsInterface} to check</span>
 11 |     | <span class='neutral'> * for the additional interface id that will be supported. For example:</span>
 12 |     | <span class='neutral'> *</span>
 13 |     | <span class='neutral'> * ```solidity</span>
 14 |     | <span class='neutral'> * function supportsInterface(bytes4 interfaceId) public view virtual override returns (bool) {</span>
 15 |     | <span class='neutral'> *     return interfaceId == type(MyInterface).interfaceId || super.supportsInterface(interfaceId);</span>
 16 |     | <span class='neutral'> * }</span>
 17 |     | <span class='neutral'> * ```</span>
 18 |     | <span class='neutral'> *</span>
 19 |     | <span class='neutral'> * Alternatively, {ERC165Storage} provides an easier to use but more expensive implementation.</span>
 20 |     | <span class='neutral'> */</span>
 21 |     | <span class='neutral'>abstract contract ERC165 is IERC165 {</span>
 22 |     | <span class='neutral'>    /**</span>
 23 |     | <span class='neutral'>     * @dev See {IERC165-supportsInterface}.</span>
 24 |     | <span class='neutral'>     */</span>
 25 | *   | <span class='executed'>    function supportsInterface(bytes4 interfaceId) public view virtual override returns (bool) {</span>
 26 | *   | <span class='executed'>        return interfaceId == type(IERC165).interfaceId;</span>
 27 |     | <span class='neutral'>    }</span>
 28 |     | <span class='neutral'>}</span>
 29 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/lib/openzeppelin-contracts/contracts/utils/introspection/IERC165.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'></span>
  3 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  4 |     | <span class='neutral'></span>
  5 |     | <span class='neutral'>/**</span>
  6 |     | <span class='neutral'> * @dev Interface of the ERC165 standard, as defined in the</span>
  7 |     | <span class='neutral'> * https://eips.ethereum.org/EIPS/eip-165[EIP].</span>
  8 |     | <span class='neutral'> *</span>
  9 |     | <span class='neutral'> * Implementers can declare support of contract interfaces, which can then be</span>
 10 |     | <span class='neutral'> * queried by others ({ERC165Checker}).</span>
 11 |     | <span class='neutral'> *</span>
 12 |     | <span class='neutral'> * For an implementation, see {ERC165}.</span>
 13 |     | <span class='neutral'> */</span>
 14 |     | <span class='neutral'>interface IERC165 {</span>
 15 |     | <span class='neutral'>    /**</span>
 16 |     | <span class='neutral'>     * @dev Returns true if this contract implements the interface defined by</span>
 17 |     | <span class='neutral'>     * `interfaceId`. See the corresponding</span>
 18 |     | <span class='neutral'>     * https://eips.ethereum.org/EIPS/eip-165#how-interfaces-are-identified[EIP section]</span>
 19 |     | <span class='neutral'>     * to learn more about how these ids are created.</span>
 20 |     | <span class='neutral'>     *</span>
 21 |     | <span class='neutral'>     * This function call must use less than 30 000 gas.</span>
 22 |     | <span class='neutral'>     */</span>
 23 |     | <span class='neutral'>    function supportsInterface(bytes4 interfaceId) external view returns (bool);</span>
 24 |     | <span class='neutral'>}</span>
 25 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/lib/openzeppelin-contracts/contracts/utils/math/Math.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v5.1.0) (utils/math/Math.sol)</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>pragma solidity ^0.8.20;</span>
   5 |     | <span class='neutral'></span>
   6 |     | <span class='neutral'>import {Panic} from &quot;../Panic.sol&quot;;</span>
   7 |     | <span class='neutral'>import {SafeCast} from &quot;./SafeCast.sol&quot;;</span>
   8 |     | <span class='neutral'></span>
   9 |     | <span class='neutral'>/**</span>
  10 |     | <span class='neutral'> * @dev Standard math utilities missing in the Solidity language.</span>
  11 |     | <span class='neutral'> */</span>
  12 |     | <span class='unexecuted'>library Math {</span>
  13 |     | <span class='neutral'>    enum Rounding {</span>
  14 |     | <span class='neutral'>        Floor, // Toward negative infinity</span>
  15 |     | <span class='neutral'>        Ceil, // Toward positive infinity</span>
  16 |     | <span class='neutral'>        Trunc, // Toward zero</span>
  17 |     | <span class='neutral'>        Expand // Away from zero</span>
  18 |     | <span class='neutral'>    }</span>
  19 |     | <span class='neutral'></span>
  20 |     | <span class='neutral'>    /**</span>
  21 |     | <span class='neutral'>     * @dev Returns the addition of two unsigned integers, with an success flag (no overflow).</span>
  22 |     | <span class='neutral'>     */</span>
  23 |     | <span class='neutral'>    function tryAdd(uint256 a, uint256 b) internal pure returns (bool success, uint256 result) {</span>
  24 |     | <span class='neutral'>        unchecked {</span>
  25 |     | <span class='neutral'>            uint256 c = a + b;</span>
  26 |     | <span class='neutral'>            if (c &lt; a) return (false, 0);</span>
  27 |     | <span class='neutral'>            return (true, c);</span>
  28 |     | <span class='neutral'>        }</span>
  29 |     | <span class='neutral'>    }</span>
  30 |     | <span class='neutral'></span>
  31 |     | <span class='neutral'>    /**</span>
  32 |     | <span class='neutral'>     * @dev Returns the subtraction of two unsigned integers, with an success flag (no overflow).</span>
  33 |     | <span class='neutral'>     */</span>
  34 |     | <span class='neutral'>    function trySub(uint256 a, uint256 b) internal pure returns (bool success, uint256 result) {</span>
  35 |     | <span class='neutral'>        unchecked {</span>
  36 |     | <span class='neutral'>            if (b &gt; a) return (false, 0);</span>
  37 |     | <span class='neutral'>            return (true, a - b);</span>
  38 |     | <span class='neutral'>        }</span>
  39 |     | <span class='neutral'>    }</span>
  40 |     | <span class='neutral'></span>
  41 |     | <span class='neutral'>    /**</span>
  42 |     | <span class='neutral'>     * @dev Returns the multiplication of two unsigned integers, with an success flag (no overflow).</span>
  43 |     | <span class='neutral'>     */</span>
  44 |     | <span class='neutral'>    function tryMul(uint256 a, uint256 b) internal pure returns (bool success, uint256 result) {</span>
  45 |     | <span class='neutral'>        unchecked {</span>
  46 |     | <span class='neutral'>            // Gas optimization: this is cheaper than requiring &#39;a&#39; not being zero, but the</span>
  47 |     | <span class='neutral'>            // benefit is lost if &#39;b&#39; is also tested.</span>
  48 |     | <span class='neutral'>            // See: https://github.com/OpenZeppelin/openzeppelin-contracts/pull/522</span>
  49 |     | <span class='neutral'>            if (a == 0) return (true, 0);</span>
  50 |     | <span class='neutral'>            uint256 c = a * b;</span>
  51 |     | <span class='neutral'>            if (c / a != b) return (false, 0);</span>
  52 |     | <span class='neutral'>            return (true, c);</span>
  53 |     | <span class='neutral'>        }</span>
  54 |     | <span class='neutral'>    }</span>
  55 |     | <span class='neutral'></span>
  56 |     | <span class='neutral'>    /**</span>
  57 |     | <span class='neutral'>     * @dev Returns the division of two unsigned integers, with a success flag (no division by zero).</span>
  58 |     | <span class='neutral'>     */</span>
  59 |     | <span class='neutral'>    function tryDiv(uint256 a, uint256 b) internal pure returns (bool success, uint256 result) {</span>
  60 |     | <span class='neutral'>        unchecked {</span>
  61 |     | <span class='neutral'>            if (b == 0) return (false, 0);</span>
  62 |     | <span class='neutral'>            return (true, a / b);</span>
  63 |     | <span class='neutral'>        }</span>
  64 |     | <span class='neutral'>    }</span>
  65 |     | <span class='neutral'></span>
  66 |     | <span class='neutral'>    /**</span>
  67 |     | <span class='neutral'>     * @dev Returns the remainder of dividing two unsigned integers, with a success flag (no division by zero).</span>
  68 |     | <span class='neutral'>     */</span>
  69 |     | <span class='neutral'>    function tryMod(uint256 a, uint256 b) internal pure returns (bool success, uint256 result) {</span>
  70 |     | <span class='neutral'>        unchecked {</span>
  71 |     | <span class='neutral'>            if (b == 0) return (false, 0);</span>
  72 |     | <span class='neutral'>            return (true, a % b);</span>
  73 |     | <span class='neutral'>        }</span>
  74 |     | <span class='neutral'>    }</span>
  75 |     | <span class='neutral'></span>
  76 |     | <span class='neutral'>    /**</span>
  77 |     | <span class='neutral'>     * @dev Branchless ternary evaluation for `a ? b : c`. Gas costs are constant.</span>
  78 |     | <span class='neutral'>     *</span>
  79 |     | <span class='neutral'>     * IMPORTANT: This function may reduce bytecode size and consume less gas when used standalone.</span>
  80 |     | <span class='neutral'>     * However, the compiler may optimize Solidity ternary operations (i.e. `a ? b : c`) to only compute</span>
  81 |     | <span class='neutral'>     * one branch when needed, making this function more expensive.</span>
  82 |     | <span class='neutral'>     */</span>
  83 |     | <span class='neutral'>    function ternary(bool condition, uint256 a, uint256 b) internal pure returns (uint256) {</span>
  84 |     | <span class='neutral'>        unchecked {</span>
  85 |     | <span class='neutral'>            // branchless ternary works because:</span>
  86 |     | <span class='neutral'>            // b ^ (a ^ b) == a</span>
  87 |     | <span class='neutral'>            // b ^ 0 == b</span>
  88 |     | <span class='neutral'>            return b ^ ((a ^ b) * SafeCast.toUint(condition));</span>
  89 |     | <span class='neutral'>        }</span>
  90 |     | <span class='neutral'>    }</span>
  91 |     | <span class='neutral'></span>
  92 |     | <span class='neutral'>    /**</span>
  93 |     | <span class='neutral'>     * @dev Returns the largest of two numbers.</span>
  94 |     | <span class='neutral'>     */</span>
  95 |     | <span class='neutral'>    function max(uint256 a, uint256 b) internal pure returns (uint256) {</span>
  96 |     | <span class='neutral'>        return ternary(a &gt; b, a, b);</span>
  97 |     | <span class='neutral'>    }</span>
  98 |     | <span class='neutral'></span>
  99 |     | <span class='neutral'>    /**</span>
 100 |     | <span class='neutral'>     * @dev Returns the smallest of two numbers.</span>
 101 |     | <span class='neutral'>     */</span>
 102 |     | <span class='neutral'>    function min(uint256 a, uint256 b) internal pure returns (uint256) {</span>
 103 |     | <span class='neutral'>        return ternary(a &lt; b, a, b);</span>
 104 |     | <span class='neutral'>    }</span>
 105 |     | <span class='neutral'></span>
 106 |     | <span class='neutral'>    /**</span>
 107 |     | <span class='neutral'>     * @dev Returns the average of two numbers. The result is rounded towards</span>
 108 |     | <span class='neutral'>     * zero.</span>
 109 |     | <span class='neutral'>     */</span>
 110 | *   | <span class='executed'>    function average(uint256 a, uint256 b) internal pure returns (uint256) {</span>
 111 |     | <span class='neutral'>        // (a + b) / 2 can overflow.</span>
 112 | *   | <span class='executed'>        return (a &amp; b) + (a ^ b) / 2;</span>
 113 |     | <span class='neutral'>    }</span>
 114 |     | <span class='neutral'></span>
 115 |     | <span class='neutral'>    /**</span>
 116 |     | <span class='neutral'>     * @dev Returns the ceiling of the division of two numbers.</span>
 117 |     | <span class='neutral'>     *</span>
 118 |     | <span class='neutral'>     * This differs from standard division with `/` in that it rounds towards infinity instead</span>
 119 |     | <span class='neutral'>     * of rounding towards zero.</span>
 120 |     | <span class='neutral'>     */</span>
 121 |     | <span class='neutral'>    function ceilDiv(uint256 a, uint256 b) internal pure returns (uint256) {</span>
 122 |     | <span class='neutral'>        if (b == 0) {</span>
 123 |     | <span class='neutral'>            // Guarantee the same behavior as in a regular Solidity division.</span>
 124 |     | <span class='neutral'>            Panic.panic(Panic.DIVISION_BY_ZERO);</span>
 125 |     | <span class='neutral'>        }</span>
 126 |     | <span class='neutral'></span>
 127 |     | <span class='neutral'>        // The following calculation ensures accurate ceiling division without overflow.</span>
 128 |     | <span class='neutral'>        // Since a is non-zero, (a - 1) / b will not overflow.</span>
 129 |     | <span class='neutral'>        // The largest possible result occurs when (a - 1) / b is type(uint256).max,</span>
 130 |     | <span class='neutral'>        // but the largest value we can obtain is type(uint256).max - 1, which happens</span>
 131 |     | <span class='neutral'>        // when a = type(uint256).max and b = 1.</span>
 132 |     | <span class='neutral'>        unchecked {</span>
 133 |     | <span class='neutral'>            return SafeCast.toUint(a &gt; 0) * ((a - 1) / b + 1);</span>
 134 |     | <span class='neutral'>        }</span>
 135 |     | <span class='neutral'>    }</span>
 136 |     | <span class='neutral'></span>
 137 |     | <span class='neutral'>    /**</span>
 138 |     | <span class='neutral'>     * @dev Calculates floor(x * y / denominator) with full precision. Throws if result overflows a uint256 or</span>
 139 |     | <span class='neutral'>     * denominator == 0.</span>
 140 |     | <span class='neutral'>     *</span>
 141 |     | <span class='neutral'>     * Original credit to Remco Bloemen under MIT license (https://xn--2-umb.com/21/muldiv) with further edits by</span>
 142 |     | <span class='neutral'>     * Uniswap Labs also under MIT license.</span>
 143 |     | <span class='neutral'>     */</span>
 144 |     | <span class='neutral'>    function mulDiv(uint256 x, uint256 y, uint256 denominator) internal pure returns (uint256 result) {</span>
 145 |     | <span class='neutral'>        unchecked {</span>
 146 |     | <span class='neutral'>            // 512-bit multiply [prod1 prod0] = x * y. Compute the product mod 2 and mod 2 - 1, then use</span>
 147 |     | <span class='neutral'>            // the Chinese Remainder Theorem to reconstruct the 512 bit result. The result is stored in two 256</span>
 148 |     | <span class='neutral'>            // variables such that product = prod1 * 2 + prod0.</span>
 149 |     | <span class='neutral'>            uint256 prod0 = x * y; // Least significant 256 bits of the product</span>
 150 |     | <span class='neutral'>            uint256 prod1; // Most significant 256 bits of the product</span>
 151 |     | <span class='neutral'>            assembly {</span>
 152 |     | <span class='neutral'>                let mm := mulmod(x, y, not(0))</span>
 153 |     | <span class='neutral'>                prod1 := sub(sub(mm, prod0), lt(mm, prod0))</span>
 154 |     | <span class='neutral'>            }</span>
 155 |     | <span class='neutral'></span>
 156 |     | <span class='neutral'>            // Handle non-overflow cases, 256 by 256 division.</span>
 157 |     | <span class='neutral'>            if (prod1 == 0) {</span>
 158 |     | <span class='neutral'>                // Solidity will revert if denominator == 0, unlike the div opcode on its own.</span>
 159 |     | <span class='neutral'>                // The surrounding unchecked block does not change this fact.</span>
 160 |     | <span class='neutral'>                // See https://docs.soliditylang.org/en/latest/control-structures.html#checked-or-unchecked-arithmetic.</span>
 161 |     | <span class='neutral'>                return prod0 / denominator;</span>
 162 |     | <span class='neutral'>            }</span>
 163 |     | <span class='neutral'></span>
 164 |     | <span class='neutral'>            // Make sure the result is less than 2. Also prevents denominator == 0.</span>
 165 |     | <span class='neutral'>            if (denominator &lt;= prod1) {</span>
 166 |     | <span class='neutral'>                Panic.panic(ternary(denominator == 0, Panic.DIVISION_BY_ZERO, Panic.UNDER_OVERFLOW));</span>
 167 |     | <span class='neutral'>            }</span>
 168 |     | <span class='neutral'></span>
 169 |     | <span class='neutral'>            ///////////////////////////////////////////////</span>
 170 |     | <span class='neutral'>            // 512 by 256 division.</span>
 171 |     | <span class='neutral'>            ///////////////////////////////////////////////</span>
 172 |     | <span class='neutral'></span>
 173 |     | <span class='neutral'>            // Make division exact by subtracting the remainder from [prod1 prod0].</span>
 174 |     | <span class='neutral'>            uint256 remainder;</span>
 175 |     | <span class='neutral'>            assembly {</span>
 176 |     | <span class='neutral'>                // Compute remainder using mulmod.</span>
 177 |     | <span class='neutral'>                remainder := mulmod(x, y, denominator)</span>
 178 |     | <span class='neutral'></span>
 179 |     | <span class='neutral'>                // Subtract 256 bit number from 512 bit number.</span>
 180 |     | <span class='neutral'>                prod1 := sub(prod1, gt(remainder, prod0))</span>
 181 |     | <span class='neutral'>                prod0 := sub(prod0, remainder)</span>
 182 |     | <span class='neutral'>            }</span>
 183 |     | <span class='neutral'></span>
 184 |     | <span class='neutral'>            // Factor powers of two out of denominator and compute largest power of two divisor of denominator.</span>
 185 |     | <span class='neutral'>            // Always &gt;= 1. See https://cs.stackexchange.com/q/138556/92363.</span>
 186 |     | <span class='neutral'></span>
 187 |     | <span class='neutral'>            uint256 twos = denominator &amp; (0 - denominator);</span>
 188 |     | <span class='neutral'>            assembly {</span>
 189 |     | <span class='neutral'>                // Divide denominator by twos.</span>
 190 |     | <span class='neutral'>                denominator := div(denominator, twos)</span>
 191 |     | <span class='neutral'></span>
 192 |     | <span class='neutral'>                // Divide [prod1 prod0] by twos.</span>
 193 |     | <span class='neutral'>                prod0 := div(prod0, twos)</span>
 194 |     | <span class='neutral'></span>
 195 |     | <span class='neutral'>                // Flip twos such that it is 2 / twos. If twos is zero, then it becomes one.</span>
 196 |     | <span class='neutral'>                twos := add(div(sub(0, twos), twos), 1)</span>
 197 |     | <span class='neutral'>            }</span>
 198 |     | <span class='neutral'></span>
 199 |     | <span class='neutral'>            // Shift in bits from prod1 into prod0.</span>
 200 |     | <span class='neutral'>            prod0 |= prod1 * twos;</span>
 201 |     | <span class='neutral'></span>
 202 |     | <span class='neutral'>            // Invert denominator mod 2. Now that denominator is an odd number, it has an inverse modulo 2 such</span>
 203 |     | <span class='neutral'>            // that denominator * inv  1 mod 2. Compute the inverse by starting with a seed that is correct for</span>
 204 |     | <span class='neutral'>            // four bits. That is, denominator * inv  1 mod 2.</span>
 205 |     | <span class='neutral'>            uint256 inverse = (3 * denominator) ^ 2;</span>
 206 |     | <span class='neutral'></span>
 207 |     | <span class='neutral'>            // Use the Newton-Raphson iteration to improve the precision. Thanks to Hensel&#39;s lifting lemma, this also</span>
 208 |     | <span class='neutral'>            // works in modular arithmetic, doubling the correct bits in each step.</span>
 209 |     | <span class='neutral'>            inverse *= 2 - denominator * inverse; // inverse mod 2</span>
 210 |     | <span class='neutral'>            inverse *= 2 - denominator * inverse; // inverse mod 2</span>
 211 |     | <span class='neutral'>            inverse *= 2 - denominator * inverse; // inverse mod 2</span>
 212 |     | <span class='neutral'>            inverse *= 2 - denominator * inverse; // inverse mod 2</span>
 213 |     | <span class='neutral'>            inverse *= 2 - denominator * inverse; // inverse mod 2</span>
 214 |     | <span class='neutral'>            inverse *= 2 - denominator * inverse; // inverse mod 2</span>
 215 |     | <span class='neutral'></span>
 216 |     | <span class='neutral'>            // Because the division is now exact we can divide by multiplying with the modular inverse of denominator.</span>
 217 |     | <span class='neutral'>            // This will give us the correct result modulo 2. Since the preconditions guarantee that the outcome is</span>
 218 |     | <span class='neutral'>            // less than 2, this is the final result. We don&#39;t need to compute the high bits of the result and prod1</span>
 219 |     | <span class='neutral'>            // is no longer required.</span>
 220 |     | <span class='neutral'>            result = prod0 * inverse;</span>
 221 |     | <span class='neutral'>            return result;</span>
 222 |     | <span class='neutral'>        }</span>
 223 |     | <span class='neutral'>    }</span>
 224 |     | <span class='neutral'></span>
 225 |     | <span class='neutral'>    /**</span>
 226 |     | <span class='neutral'>     * @dev Calculates x * y / denominator with full precision, following the selected rounding direction.</span>
 227 |     | <span class='neutral'>     */</span>
 228 |     | <span class='neutral'>    function mulDiv(uint256 x, uint256 y, uint256 denominator, Rounding rounding) internal pure returns (uint256) {</span>
 229 |     | <span class='neutral'>        return mulDiv(x, y, denominator) + SafeCast.toUint(unsignedRoundsUp(rounding) &amp;&amp; mulmod(x, y, denominator) &gt; 0);</span>
 230 |     | <span class='neutral'>    }</span>
 231 |     | <span class='neutral'></span>
 232 |     | <span class='neutral'>    /**</span>
 233 |     | <span class='neutral'>     * @dev Calculate the modular multiplicative inverse of a number in Z/nZ.</span>
 234 |     | <span class='neutral'>     *</span>
 235 |     | <span class='neutral'>     * If n is a prime, then Z/nZ is a field. In that case all elements are inversible, except 0.</span>
 236 |     | <span class='neutral'>     * If n is not a prime, then Z/nZ is not a field, and some elements might not be inversible.</span>
 237 |     | <span class='neutral'>     *</span>
 238 |     | <span class='neutral'>     * If the input value is not inversible, 0 is returned.</span>
 239 |     | <span class='neutral'>     *</span>
 240 |     | <span class='neutral'>     * NOTE: If you know for sure that n is (big) a prime, it may be cheaper to use Fermat&#39;s little theorem and get the</span>
 241 |     | <span class='neutral'>     * inverse using `Math.modExp(a, n - 2, n)`. See {invModPrime}.</span>
 242 |     | <span class='neutral'>     */</span>
 243 |     | <span class='neutral'>    function invMod(uint256 a, uint256 n) internal pure returns (uint256) {</span>
 244 |     | <span class='neutral'>        unchecked {</span>
 245 |     | <span class='neutral'>            if (n == 0) return 0;</span>
 246 |     | <span class='neutral'></span>
 247 |     | <span class='neutral'>            // The inverse modulo is calculated using the Extended Euclidean Algorithm (iterative version)</span>
 248 |     | <span class='neutral'>            // Used to compute integers x and y such that: ax + ny = gcd(a, n).</span>
 249 |     | <span class='neutral'>            // When the gcd is 1, then the inverse of a modulo n exists and it&#39;s x.</span>
 250 |     | <span class='neutral'>            // ax + ny = 1</span>
 251 |     | <span class='neutral'>            // ax = 1 + (-y)n</span>
 252 |     | <span class='neutral'>            // ax  1 (mod n) # x is the inverse of a modulo n</span>
 253 |     | <span class='neutral'></span>
 254 |     | <span class='neutral'>            // If the remainder is 0 the gcd is n right away.</span>
 255 |     | <span class='neutral'>            uint256 remainder = a % n;</span>
 256 |     | <span class='neutral'>            uint256 gcd = n;</span>
 257 |     | <span class='neutral'></span>
 258 |     | <span class='neutral'>            // Therefore the initial coefficients are:</span>
 259 |     | <span class='neutral'>            // ax + ny = gcd(a, n) = n</span>
 260 |     | <span class='neutral'>            // 0a + 1n = n</span>
 261 |     | <span class='neutral'>            int256 x = 0;</span>
 262 |     | <span class='neutral'>            int256 y = 1;</span>
 263 |     | <span class='neutral'></span>
 264 |     | <span class='neutral'>            while (remainder != 0) {</span>
 265 |     | <span class='neutral'>                uint256 quotient = gcd / remainder;</span>
 266 |     | <span class='neutral'></span>
 267 |     | <span class='neutral'>                (gcd, remainder) = (</span>
 268 |     | <span class='neutral'>                    // The old remainder is the next gcd to try.</span>
 269 |     | <span class='neutral'>                    remainder,</span>
 270 |     | <span class='neutral'>                    // Compute the next remainder.</span>
 271 |     | <span class='neutral'>                    // Can&#39;t overflow given that (a % gcd) * (gcd // (a % gcd)) &lt;= gcd</span>
 272 |     | <span class='neutral'>                    // where gcd is at most n (capped to type(uint256).max)</span>
 273 |     | <span class='neutral'>                    gcd - remainder * quotient</span>
 274 |     | <span class='neutral'>                );</span>
 275 |     | <span class='neutral'></span>
 276 |     | <span class='neutral'>                (x, y) = (</span>
 277 |     | <span class='neutral'>                    // Increment the coefficient of a.</span>
 278 |     | <span class='neutral'>                    y,</span>
 279 |     | <span class='neutral'>                    // Decrement the coefficient of n.</span>
 280 |     | <span class='neutral'>                    // Can overflow, but the result is casted to uint256 so that the</span>
 281 |     | <span class='neutral'>                    // next value of y is &quot;wrapped around&quot; to a value between 0 and n - 1.</span>
 282 |     | <span class='neutral'>                    x - y * int256(quotient)</span>
 283 |     | <span class='neutral'>                );</span>
 284 |     | <span class='neutral'>            }</span>
 285 |     | <span class='neutral'></span>
 286 |     | <span class='neutral'>            if (gcd != 1) return 0; // No inverse exists.</span>
 287 |     | <span class='neutral'>            return ternary(x &lt; 0, n - uint256(-x), uint256(x)); // Wrap the result if it&#39;s negative.</span>
 288 |     | <span class='neutral'>        }</span>
 289 |     | <span class='neutral'>    }</span>
 290 |     | <span class='neutral'></span>
 291 |     | <span class='neutral'>    /**</span>
 292 |     | <span class='neutral'>     * @dev Variant of {invMod}. More efficient, but only works if `p` is known to be a prime greater than `2`.</span>
 293 |     | <span class='neutral'>     *</span>
 294 |     | <span class='neutral'>     * From https://en.wikipedia.org/wiki/Fermat%27s_little_theorem[Fermat&#39;s little theorem], we know that if p is</span>
 295 |     | <span class='neutral'>     * prime, then `a**(p-1)  1 mod p`. As a consequence, we have `a * a**(p-2)  1 mod p`, which means that</span>
 296 |     | <span class='neutral'>     * `a**(p-2)` is the modular multiplicative inverse of a in Fp.</span>
 297 |     | <span class='neutral'>     *</span>
 298 |     | <span class='neutral'>     * NOTE: this function does NOT check that `p` is a prime greater than `2`.</span>
 299 |     | <span class='neutral'>     */</span>
 300 |     | <span class='neutral'>    function invModPrime(uint256 a, uint256 p) internal view returns (uint256) {</span>
 301 |     | <span class='neutral'>        unchecked {</span>
 302 |     | <span class='neutral'>            return Math.modExp(a, p - 2, p);</span>
 303 |     | <span class='neutral'>        }</span>
 304 |     | <span class='neutral'>    }</span>
 305 |     | <span class='neutral'></span>
 306 |     | <span class='neutral'>    /**</span>
 307 |     | <span class='neutral'>     * @dev Returns the modular exponentiation of the specified base, exponent and modulus (b ** e % m)</span>
 308 |     | <span class='neutral'>     *</span>
 309 |     | <span class='neutral'>     * Requirements:</span>
 310 |     | <span class='neutral'>     * - modulus can&#39;t be zero</span>
 311 |     | <span class='neutral'>     * - underlying staticcall to precompile must succeed</span>
 312 |     | <span class='neutral'>     *</span>
 313 |     | <span class='neutral'>     * IMPORTANT: The result is only valid if the underlying call succeeds. When using this function, make</span>
 314 |     | <span class='neutral'>     * sure the chain you&#39;re using it on supports the precompiled contract for modular exponentiation</span>
 315 |     | <span class='neutral'>     * at address 0x05 as specified in https://eips.ethereum.org/EIPS/eip-198[EIP-198]. Otherwise,</span>
 316 |     | <span class='neutral'>     * the underlying function will succeed given the lack of a revert, but the result may be incorrectly</span>
 317 |     | <span class='neutral'>     * interpreted as 0.</span>
 318 |     | <span class='neutral'>     */</span>
 319 |     | <span class='neutral'>    function modExp(uint256 b, uint256 e, uint256 m) internal view returns (uint256) {</span>
 320 |     | <span class='neutral'>        (bool success, uint256 result) = tryModExp(b, e, m);</span>
 321 |     | <span class='neutral'>        if (!success) {</span>
 322 |     | <span class='neutral'>            Panic.panic(Panic.DIVISION_BY_ZERO);</span>
 323 |     | <span class='neutral'>        }</span>
 324 |     | <span class='neutral'>        return result;</span>
 325 |     | <span class='neutral'>    }</span>
 326 |     | <span class='neutral'></span>
 327 |     | <span class='neutral'>    /**</span>
 328 |     | <span class='neutral'>     * @dev Returns the modular exponentiation of the specified base, exponent and modulus (b ** e % m).</span>
 329 |     | <span class='neutral'>     * It includes a success flag indicating if the operation succeeded. Operation will be marked as failed if trying</span>
 330 |     | <span class='neutral'>     * to operate modulo 0 or if the underlying precompile reverted.</span>
 331 |     | <span class='neutral'>     *</span>
 332 |     | <span class='neutral'>     * IMPORTANT: The result is only valid if the success flag is true. When using this function, make sure the chain</span>
 333 |     | <span class='neutral'>     * you&#39;re using it on supports the precompiled contract for modular exponentiation at address 0x05 as specified in</span>
 334 |     | <span class='neutral'>     * https://eips.ethereum.org/EIPS/eip-198[EIP-198]. Otherwise, the underlying function will succeed given the lack</span>
 335 |     | <span class='neutral'>     * of a revert, but the result may be incorrectly interpreted as 0.</span>
 336 |     | <span class='neutral'>     */</span>
 337 |     | <span class='neutral'>    function tryModExp(uint256 b, uint256 e, uint256 m) internal view returns (bool success, uint256 result) {</span>
 338 |     | <span class='neutral'>        if (m == 0) return (false, 0);</span>
 339 |     | <span class='neutral'>        assembly (&quot;memory-safe&quot;) {</span>
 340 |     | <span class='neutral'>            let ptr := mload(0x40)</span>
 341 |     | <span class='neutral'>            // | Offset    | Content    | Content (Hex)                                                      |</span>
 342 |     | <span class='neutral'>            // |-----------|------------|--------------------------------------------------------------------|</span>
 343 |     | <span class='neutral'>            // | 0x00:0x1f | size of b  | 0x0000000000000000000000000000000000000000000000000000000000000020 |</span>
 344 |     | <span class='neutral'>            // | 0x20:0x3f | size of e  | 0x0000000000000000000000000000000000000000000000000000000000000020 |</span>
 345 |     | <span class='neutral'>            // | 0x40:0x5f | size of m  | 0x0000000000000000000000000000000000000000000000000000000000000020 |</span>
 346 |     | <span class='neutral'>            // | 0x60:0x7f | value of b | 0x&lt;.............................................................b&gt; |</span>
 347 |     | <span class='neutral'>            // | 0x80:0x9f | value of e | 0x&lt;.............................................................e&gt; |</span>
 348 |     | <span class='neutral'>            // | 0xa0:0xbf | value of m | 0x&lt;.............................................................m&gt; |</span>
 349 |     | <span class='neutral'>            mstore(ptr, 0x20)</span>
 350 |     | <span class='neutral'>            mstore(add(ptr, 0x20), 0x20)</span>
 351 |     | <span class='neutral'>            mstore(add(ptr, 0x40), 0x20)</span>
 352 |     | <span class='neutral'>            mstore(add(ptr, 0x60), b)</span>
 353 |     | <span class='neutral'>            mstore(add(ptr, 0x80), e)</span>
 354 |     | <span class='neutral'>            mstore(add(ptr, 0xa0), m)</span>
 355 |     | <span class='neutral'></span>
 356 |     | <span class='neutral'>            // Given the result &lt; m, it&#39;s guaranteed to fit in 32 bytes,</span>
 357 |     | <span class='neutral'>            // so we can use the memory scratch space located at offset 0.</span>
 358 |     | <span class='neutral'>            success := staticcall(gas(), 0x05, ptr, 0xc0, 0x00, 0x20)</span>
 359 |     | <span class='neutral'>            result := mload(0x00)</span>
 360 |     | <span class='neutral'>        }</span>
 361 |     | <span class='neutral'>    }</span>
 362 |     | <span class='neutral'></span>
 363 |     | <span class='neutral'>    /**</span>
 364 |     | <span class='neutral'>     * @dev Variant of {modExp} that supports inputs of arbitrary length.</span>
 365 |     | <span class='neutral'>     */</span>
 366 |     | <span class='neutral'>    function modExp(bytes memory b, bytes memory e, bytes memory m) internal view returns (bytes memory) {</span>
 367 |     | <span class='neutral'>        (bool success, bytes memory result) = tryModExp(b, e, m);</span>
 368 |     | <span class='neutral'>        if (!success) {</span>
 369 |     | <span class='neutral'>            Panic.panic(Panic.DIVISION_BY_ZERO);</span>
 370 |     | <span class='neutral'>        }</span>
 371 |     | <span class='neutral'>        return result;</span>
 372 |     | <span class='neutral'>    }</span>
 373 |     | <span class='neutral'></span>
 374 |     | <span class='neutral'>    /**</span>
 375 |     | <span class='neutral'>     * @dev Variant of {tryModExp} that supports inputs of arbitrary length.</span>
 376 |     | <span class='neutral'>     */</span>
 377 |     | <span class='neutral'>    function tryModExp(</span>
 378 |     | <span class='neutral'>        bytes memory b,</span>
 379 |     | <span class='neutral'>        bytes memory e,</span>
 380 |     | <span class='neutral'>        bytes memory m</span>
 381 |     | <span class='neutral'>    ) internal view returns (bool success, bytes memory result) {</span>
 382 |     | <span class='neutral'>        if (_zeroBytes(m)) return (false, new bytes(0));</span>
 383 |     | <span class='neutral'></span>
 384 |     | <span class='neutral'>        uint256 mLen = m.length;</span>
 385 |     | <span class='neutral'></span>
 386 |     | <span class='neutral'>        // Encode call args in result and move the free memory pointer</span>
 387 |     | <span class='neutral'>        result = abi.encodePacked(b.length, e.length, mLen, b, e, m);</span>
 388 |     | <span class='neutral'></span>
 389 |     | <span class='neutral'>        assembly (&quot;memory-safe&quot;) {</span>
 390 |     | <span class='neutral'>            let dataPtr := add(result, 0x20)</span>
 391 |     | <span class='neutral'>            // Write result on top of args to avoid allocating extra memory.</span>
 392 |     | <span class='neutral'>            success := staticcall(gas(), 0x05, dataPtr, mload(result), dataPtr, mLen)</span>
 393 |     | <span class='neutral'>            // Overwrite the length.</span>
 394 |     | <span class='neutral'>            // result.length &gt; returndatasize() is guaranteed because returndatasize() == m.length</span>
 395 |     | <span class='neutral'>            mstore(result, mLen)</span>
 396 |     | <span class='neutral'>            // Set the memory pointer after the returned data.</span>
 397 |     | <span class='neutral'>            mstore(0x40, add(dataPtr, mLen))</span>
 398 |     | <span class='neutral'>        }</span>
 399 |     | <span class='neutral'>    }</span>
 400 |     | <span class='neutral'></span>
 401 |     | <span class='neutral'>    /**</span>
 402 |     | <span class='neutral'>     * @dev Returns whether the provided byte array is zero.</span>
 403 |     | <span class='neutral'>     */</span>
 404 |     | <span class='neutral'>    function _zeroBytes(bytes memory byteArray) private pure returns (bool) {</span>
 405 |     | <span class='neutral'>        for (uint256 i = 0; i &lt; byteArray.length; ++i) {</span>
 406 |     | <span class='neutral'>            if (byteArray[i] != 0) {</span>
 407 |     | <span class='neutral'>                return false;</span>
 408 |     | <span class='neutral'>            }</span>
 409 |     | <span class='neutral'>        }</span>
 410 |     | <span class='neutral'>        return true;</span>
 411 |     | <span class='neutral'>    }</span>
 412 |     | <span class='neutral'></span>
 413 |     | <span class='neutral'>    /**</span>
 414 |     | <span class='neutral'>     * @dev Returns the square root of a number. If the number is not a perfect square, the value is rounded</span>
 415 |     | <span class='neutral'>     * towards zero.</span>
 416 |     | <span class='neutral'>     *</span>
 417 |     | <span class='neutral'>     * This method is based on Newton&#39;s method for computing square roots; the algorithm is restricted to only</span>
 418 |     | <span class='neutral'>     * using integer operations.</span>
 419 |     | <span class='neutral'>     */</span>
 420 |     | <span class='neutral'>    function sqrt(uint256 a) internal pure returns (uint256) {</span>
 421 |     | <span class='neutral'>        unchecked {</span>
 422 |     | <span class='neutral'>            // Take care of easy edge cases when a == 0 or a == 1</span>
 423 |     | <span class='neutral'>            if (a &lt;= 1) {</span>
 424 |     | <span class='neutral'>                return a;</span>
 425 |     | <span class='neutral'>            }</span>
 426 |     | <span class='neutral'></span>
 427 |     | <span class='neutral'>            // In this function, we use Newton&#39;s method to get a root of `f(x) := x - a`. It involves building a</span>
 428 |     | <span class='neutral'>            // sequence x_n that converges toward sqrt(a). For each iteration x_n, we also define the error between</span>
 429 |     | <span class='neutral'>            // the current value as `_n = | x_n - sqrt(a) |`.</span>
 430 |     | <span class='neutral'>            //</span>
 431 |     | <span class='neutral'>            // For our first estimation, we consider `e` the smallest power of 2 which is bigger than the square root</span>
 432 |     | <span class='neutral'>            // of the target. (i.e. `2**(e-1)  sqrt(a) &lt; 2**e`). We know that `e  128` because `(2) = 2` is</span>
 433 |     | <span class='neutral'>            // bigger than any uint256.</span>
 434 |     | <span class='neutral'>            //</span>
 435 |     | <span class='neutral'>            // By noticing that</span>
 436 |     | <span class='neutral'>            // `2**(e-1)  sqrt(a) &lt; 2**e  (2**(e-1))  a &lt; (2**e)  2**(2*e-2)  a &lt; 2**(2*e)`</span>
 437 |     | <span class='neutral'>            // we can deduce that `e - 1` is `log2(a) / 2`. We can thus compute `x_n = 2**(e-1)` using a method similar</span>
 438 |     | <span class='neutral'>            // to the msb function.</span>
 439 |     | <span class='neutral'>            uint256 aa = a;</span>
 440 |     | <span class='neutral'>            uint256 xn = 1;</span>
 441 |     | <span class='neutral'></span>
 442 |     | <span class='neutral'>            if (aa &gt;= (1 &lt;&lt; 128)) {</span>
 443 |     | <span class='neutral'>                aa &gt;&gt;= 128;</span>
 444 |     | <span class='neutral'>                xn &lt;&lt;= 64;</span>
 445 |     | <span class='neutral'>            }</span>
 446 |     | <span class='neutral'>            if (aa &gt;= (1 &lt;&lt; 64)) {</span>
 447 |     | <span class='neutral'>                aa &gt;&gt;= 64;</span>
 448 |     | <span class='neutral'>                xn &lt;&lt;= 32;</span>
 449 |     | <span class='neutral'>            }</span>
 450 |     | <span class='neutral'>            if (aa &gt;= (1 &lt;&lt; 32)) {</span>
 451 |     | <span class='neutral'>                aa &gt;&gt;= 32;</span>
 452 |     | <span class='neutral'>                xn &lt;&lt;= 16;</span>
 453 |     | <span class='neutral'>            }</span>
 454 |     | <span class='neutral'>            if (aa &gt;= (1 &lt;&lt; 16)) {</span>
 455 |     | <span class='neutral'>                aa &gt;&gt;= 16;</span>
 456 |     | <span class='neutral'>                xn &lt;&lt;= 8;</span>
 457 |     | <span class='neutral'>            }</span>
 458 |     | <span class='neutral'>            if (aa &gt;= (1 &lt;&lt; 8)) {</span>
 459 |     | <span class='neutral'>                aa &gt;&gt;= 8;</span>
 460 |     | <span class='neutral'>                xn &lt;&lt;= 4;</span>
 461 |     | <span class='neutral'>            }</span>
 462 |     | <span class='neutral'>            if (aa &gt;= (1 &lt;&lt; 4)) {</span>
 463 |     | <span class='neutral'>                aa &gt;&gt;= 4;</span>
 464 |     | <span class='neutral'>                xn &lt;&lt;= 2;</span>
 465 |     | <span class='neutral'>            }</span>
 466 |     | <span class='neutral'>            if (aa &gt;= (1 &lt;&lt; 2)) {</span>
 467 |     | <span class='neutral'>                xn &lt;&lt;= 1;</span>
 468 |     | <span class='neutral'>            }</span>
 469 |     | <span class='neutral'></span>
 470 |     | <span class='neutral'>            // We now have x_n such that `x_n = 2**(e-1)  sqrt(a) &lt; 2**e = 2 * x_n`. This implies _n  2**(e-1).</span>
 471 |     | <span class='neutral'>            //</span>
 472 |     | <span class='neutral'>            // We can refine our estimation by noticing that the middle of that interval minimizes the error.</span>
 473 |     | <span class='neutral'>            // If we move x_n to equal 2**(e-1) + 2**(e-2), then we reduce the error to _n  2**(e-2).</span>
 474 |     | <span class='neutral'>            // This is going to be our x_0 (and _0)</span>
 475 |     | <span class='neutral'>            xn = (3 * xn) &gt;&gt; 1; // _0 := | x_0 - sqrt(a) |  2**(e-2)</span>
 476 |     | <span class='neutral'></span>
 477 |     | <span class='neutral'>            // From here, Newton&#39;s method give us:</span>
 478 |     | <span class='neutral'>            // x_{n+1} = (x_n + a / x_n) / 2</span>
 479 |     | <span class='neutral'>            //</span>
 480 |     | <span class='neutral'>            // One should note that:</span>
 481 |     | <span class='neutral'>            // x_{n+1} - a = ((x_n + a / x_n) / 2) - a</span>
 482 |     | <span class='neutral'>            //              = ((x_n + a) / (2 * x_n)) - a</span>
 483 |     | <span class='neutral'>            //              = (x_n + 2 * a * x_n + a) / (4 * x_n) - a</span>
 484 |     | <span class='neutral'>            //              = (x_n + 2 * a * x_n + a - 4 * a * x_n) / (4 * x_n)</span>
 485 |     | <span class='neutral'>            //              = (x_n - 2 * a * x_n + a) / (4 * x_n)</span>
 486 |     | <span class='neutral'>            //              = (x_n - a) / (2 * x_n)</span>
 487 |     | <span class='neutral'>            //              = ((x_n - a) / (2 * x_n))</span>
 488 |     | <span class='neutral'>            //               0</span>
 489 |     | <span class='neutral'>            // Which proves that for all n  1, sqrt(a)  x_n</span>
 490 |     | <span class='neutral'>            //</span>
 491 |     | <span class='neutral'>            // This gives us the proof of quadratic convergence of the sequence:</span>
 492 |     | <span class='neutral'>            // _{n+1} = | x_{n+1} - sqrt(a) |</span>
 493 |     | <span class='neutral'>            //         = | (x_n + a / x_n) / 2 - sqrt(a) |</span>
 494 |     | <span class='neutral'>            //         = | (x_n + a - 2*x_n*sqrt(a)) / (2 * x_n) |</span>
 495 |     | <span class='neutral'>            //         = | (x_n - sqrt(a)) / (2 * x_n) |</span>
 496 |     | <span class='neutral'>            //         = | _n / (2 * x_n) |</span>
 497 |     | <span class='neutral'>            //         = _n / | (2 * x_n) |</span>
 498 |     | <span class='neutral'>            //</span>
 499 |     | <span class='neutral'>            // For the first iteration, we have a special case where x_0 is known:</span>
 500 |     | <span class='neutral'>            // _1 = _0 / | (2 * x_0) |</span>
 501 |     | <span class='neutral'>            //      (2**(e-2)) / (2 * (2**(e-1) + 2**(e-2)))</span>
 502 |     | <span class='neutral'>            //      2**(2*e-4) / (3 * 2**(e-1))</span>
 503 |     | <span class='neutral'>            //      2**(e-3) / 3</span>
 504 |     | <span class='neutral'>            //      2**(e-3-log2(3))</span>
 505 |     | <span class='neutral'>            //      2**(e-4.5)</span>
 506 |     | <span class='neutral'>            //</span>
 507 |     | <span class='neutral'>            // For the following iterations, we use the fact that, 2**(e-1)  sqrt(a)  x_n:</span>
 508 |     | <span class='neutral'>            // _{n+1} = _n / | (2 * x_n) |</span>
 509 |     | <span class='neutral'>            //          (2**(e-k)) / (2 * 2**(e-1))</span>
 510 |     | <span class='neutral'>            //          2**(2*e-2*k) / 2**e</span>
 511 |     | <span class='neutral'>            //          2**(e-2*k)</span>
 512 |     | <span class='neutral'>            xn = (xn + a / xn) &gt;&gt; 1; // _1 := | x_1 - sqrt(a) |  2**(e-4.5)  -- special case, see above</span>
 513 |     | <span class='neutral'>            xn = (xn + a / xn) &gt;&gt; 1; // _2 := | x_2 - sqrt(a) |  2**(e-9)    -- general case with k = 4.5</span>
 514 |     | <span class='neutral'>            xn = (xn + a / xn) &gt;&gt; 1; // _3 := | x_3 - sqrt(a) |  2**(e-18)   -- general case with k = 9</span>
 515 |     | <span class='neutral'>            xn = (xn + a / xn) &gt;&gt; 1; // _4 := | x_4 - sqrt(a) |  2**(e-36)   -- general case with k = 18</span>
 516 |     | <span class='neutral'>            xn = (xn + a / xn) &gt;&gt; 1; // _5 := | x_5 - sqrt(a) |  2**(e-72)   -- general case with k = 36</span>
 517 |     | <span class='neutral'>            xn = (xn + a / xn) &gt;&gt; 1; // _6 := | x_6 - sqrt(a) |  2**(e-144)  -- general case with k = 72</span>
 518 |     | <span class='neutral'></span>
 519 |     | <span class='neutral'>            // Because e  128 (as discussed during the first estimation phase), we know have reached a precision</span>
 520 |     | <span class='neutral'>            // _6  2**(e-144) &lt; 1. Given we&#39;re operating on integers, then we can ensure that xn is now either</span>
 521 |     | <span class='neutral'>            // sqrt(a) or sqrt(a) + 1.</span>
 522 |     | <span class='neutral'>            return xn - SafeCast.toUint(xn &gt; a / xn);</span>
 523 |     | <span class='neutral'>        }</span>
 524 |     | <span class='neutral'>    }</span>
 525 |     | <span class='neutral'></span>
 526 |     | <span class='neutral'>    /**</span>
 527 |     | <span class='neutral'>     * @dev Calculates sqrt(a), following the selected rounding direction.</span>
 528 |     | <span class='neutral'>     */</span>
 529 |     | <span class='neutral'>    function sqrt(uint256 a, Rounding rounding) internal pure returns (uint256) {</span>
 530 |     | <span class='neutral'>        unchecked {</span>
 531 |     | <span class='neutral'>            uint256 result = sqrt(a);</span>
 532 |     | <span class='neutral'>            return result + SafeCast.toUint(unsignedRoundsUp(rounding) &amp;&amp; result * result &lt; a);</span>
 533 |     | <span class='neutral'>        }</span>
 534 |     | <span class='neutral'>    }</span>
 535 |     | <span class='neutral'></span>
 536 |     | <span class='neutral'>    /**</span>
 537 |     | <span class='neutral'>     * @dev Return the log in base 2 of a positive value rounded towards zero.</span>
 538 |     | <span class='neutral'>     * Returns 0 if given 0.</span>
 539 |     | <span class='neutral'>     */</span>
 540 |     | <span class='neutral'>    function log2(uint256 value) internal pure returns (uint256) {</span>
 541 |     | <span class='neutral'>        uint256 result = 0;</span>
 542 |     | <span class='neutral'>        uint256 exp;</span>
 543 |     | <span class='neutral'>        unchecked {</span>
 544 |     | <span class='neutral'>            exp = 128 * SafeCast.toUint(value &gt; (1 &lt;&lt; 128) - 1);</span>
 545 |     | <span class='neutral'>            value &gt;&gt;= exp;</span>
 546 |     | <span class='neutral'>            result += exp;</span>
 547 |     | <span class='neutral'></span>
 548 |     | <span class='neutral'>            exp = 64 * SafeCast.toUint(value &gt; (1 &lt;&lt; 64) - 1);</span>
 549 |     | <span class='neutral'>            value &gt;&gt;= exp;</span>
 550 |     | <span class='neutral'>            result += exp;</span>
 551 |     | <span class='neutral'></span>
 552 |     | <span class='neutral'>            exp = 32 * SafeCast.toUint(value &gt; (1 &lt;&lt; 32) - 1);</span>
 553 |     | <span class='neutral'>            value &gt;&gt;= exp;</span>
 554 |     | <span class='neutral'>            result += exp;</span>
 555 |     | <span class='neutral'></span>
 556 |     | <span class='neutral'>            exp = 16 * SafeCast.toUint(value &gt; (1 &lt;&lt; 16) - 1);</span>
 557 |     | <span class='neutral'>            value &gt;&gt;= exp;</span>
 558 |     | <span class='neutral'>            result += exp;</span>
 559 |     | <span class='neutral'></span>
 560 |     | <span class='neutral'>            exp = 8 * SafeCast.toUint(value &gt; (1 &lt;&lt; 8) - 1);</span>
 561 |     | <span class='neutral'>            value &gt;&gt;= exp;</span>
 562 |     | <span class='neutral'>            result += exp;</span>
 563 |     | <span class='neutral'></span>
 564 |     | <span class='neutral'>            exp = 4 * SafeCast.toUint(value &gt; (1 &lt;&lt; 4) - 1);</span>
 565 |     | <span class='neutral'>            value &gt;&gt;= exp;</span>
 566 |     | <span class='neutral'>            result += exp;</span>
 567 |     | <span class='neutral'></span>
 568 |     | <span class='neutral'>            exp = 2 * SafeCast.toUint(value &gt; (1 &lt;&lt; 2) - 1);</span>
 569 |     | <span class='neutral'>            value &gt;&gt;= exp;</span>
 570 |     | <span class='neutral'>            result += exp;</span>
 571 |     | <span class='neutral'></span>
 572 |     | <span class='neutral'>            result += SafeCast.toUint(value &gt; 1);</span>
 573 |     | <span class='neutral'>        }</span>
 574 |     | <span class='neutral'>        return result;</span>
 575 |     | <span class='neutral'>    }</span>
 576 |     | <span class='neutral'></span>
 577 |     | <span class='neutral'>    /**</span>
 578 |     | <span class='neutral'>     * @dev Return the log in base 2, following the selected rounding direction, of a positive value.</span>
 579 |     | <span class='neutral'>     * Returns 0 if given 0.</span>
 580 |     | <span class='neutral'>     */</span>
 581 |     | <span class='neutral'>    function log2(uint256 value, Rounding rounding) internal pure returns (uint256) {</span>
 582 |     | <span class='neutral'>        unchecked {</span>
 583 |     | <span class='neutral'>            uint256 result = log2(value);</span>
 584 |     | <span class='neutral'>            return result + SafeCast.toUint(unsignedRoundsUp(rounding) &amp;&amp; 1 &lt;&lt; result &lt; value);</span>
 585 |     | <span class='neutral'>        }</span>
 586 |     | <span class='neutral'>    }</span>
 587 |     | <span class='neutral'></span>
 588 |     | <span class='neutral'>    /**</span>
 589 |     | <span class='neutral'>     * @dev Return the log in base 10 of a positive value rounded towards zero.</span>
 590 |     | <span class='neutral'>     * Returns 0 if given 0.</span>
 591 |     | <span class='neutral'>     */</span>
 592 |     | <span class='neutral'>    function log10(uint256 value) internal pure returns (uint256) {</span>
 593 |     | <span class='neutral'>        uint256 result = 0;</span>
 594 |     | <span class='neutral'>        unchecked {</span>
 595 |     | <span class='neutral'>            if (value &gt;= 10 ** 64) {</span>
 596 |     | <span class='neutral'>                value /= 10 ** 64;</span>
 597 |     | <span class='neutral'>                result += 64;</span>
 598 |     | <span class='neutral'>            }</span>
 599 |     | <span class='neutral'>            if (value &gt;= 10 ** 32) {</span>
 600 |     | <span class='neutral'>                value /= 10 ** 32;</span>
 601 |     | <span class='neutral'>                result += 32;</span>
 602 |     | <span class='neutral'>            }</span>
 603 |     | <span class='neutral'>            if (value &gt;= 10 ** 16) {</span>
 604 |     | <span class='neutral'>                value /= 10 ** 16;</span>
 605 |     | <span class='neutral'>                result += 16;</span>
 606 |     | <span class='neutral'>            }</span>
 607 |     | <span class='neutral'>            if (value &gt;= 10 ** 8) {</span>
 608 |     | <span class='neutral'>                value /= 10 ** 8;</span>
 609 |     | <span class='neutral'>                result += 8;</span>
 610 |     | <span class='neutral'>            }</span>
 611 |     | <span class='neutral'>            if (value &gt;= 10 ** 4) {</span>
 612 |     | <span class='neutral'>                value /= 10 ** 4;</span>
 613 |     | <span class='neutral'>                result += 4;</span>
 614 |     | <span class='neutral'>            }</span>
 615 |     | <span class='neutral'>            if (value &gt;= 10 ** 2) {</span>
 616 |     | <span class='neutral'>                value /= 10 ** 2;</span>
 617 |     | <span class='neutral'>                result += 2;</span>
 618 |     | <span class='neutral'>            }</span>
 619 |     | <span class='neutral'>            if (value &gt;= 10 ** 1) {</span>
 620 |     | <span class='neutral'>                result += 1;</span>
 621 |     | <span class='neutral'>            }</span>
 622 |     | <span class='neutral'>        }</span>
 623 |     | <span class='neutral'>        return result;</span>
 624 |     | <span class='neutral'>    }</span>
 625 |     | <span class='neutral'></span>
 626 |     | <span class='neutral'>    /**</span>
 627 |     | <span class='neutral'>     * @dev Return the log in base 10, following the selected rounding direction, of a positive value.</span>
 628 |     | <span class='neutral'>     * Returns 0 if given 0.</span>
 629 |     | <span class='neutral'>     */</span>
 630 |     | <span class='neutral'>    function log10(uint256 value, Rounding rounding) internal pure returns (uint256) {</span>
 631 |     | <span class='neutral'>        unchecked {</span>
 632 |     | <span class='neutral'>            uint256 result = log10(value);</span>
 633 |     | <span class='neutral'>            return result + SafeCast.toUint(unsignedRoundsUp(rounding) &amp;&amp; 10 ** result &lt; value);</span>
 634 |     | <span class='neutral'>        }</span>
 635 |     | <span class='neutral'>    }</span>
 636 |     | <span class='neutral'></span>
 637 |     | <span class='neutral'>    /**</span>
 638 |     | <span class='neutral'>     * @dev Return the log in base 256 of a positive value rounded towards zero.</span>
 639 |     | <span class='neutral'>     * Returns 0 if given 0.</span>
 640 |     | <span class='neutral'>     *</span>
 641 |     | <span class='neutral'>     * Adding one to the result gives the number of pairs of hex symbols needed to represent `value` as a hex string.</span>
 642 |     | <span class='neutral'>     */</span>
 643 |     | <span class='neutral'>    function log256(uint256 value) internal pure returns (uint256) {</span>
 644 |     | <span class='neutral'>        uint256 result = 0;</span>
 645 |     | <span class='neutral'>        uint256 isGt;</span>
 646 |     | <span class='neutral'>        unchecked {</span>
 647 |     | <span class='neutral'>            isGt = SafeCast.toUint(value &gt; (1 &lt;&lt; 128) - 1);</span>
 648 |     | <span class='neutral'>            value &gt;&gt;= isGt * 128;</span>
 649 |     | <span class='neutral'>            result += isGt * 16;</span>
 650 |     | <span class='neutral'></span>
 651 |     | <span class='neutral'>            isGt = SafeCast.toUint(value &gt; (1 &lt;&lt; 64) - 1);</span>
 652 |     | <span class='neutral'>            value &gt;&gt;= isGt * 64;</span>
 653 |     | <span class='neutral'>            result += isGt * 8;</span>
 654 |     | <span class='neutral'></span>
 655 |     | <span class='neutral'>            isGt = SafeCast.toUint(value &gt; (1 &lt;&lt; 32) - 1);</span>
 656 |     | <span class='neutral'>            value &gt;&gt;= isGt * 32;</span>
 657 |     | <span class='neutral'>            result += isGt * 4;</span>
 658 |     | <span class='neutral'></span>
 659 |     | <span class='neutral'>            isGt = SafeCast.toUint(value &gt; (1 &lt;&lt; 16) - 1);</span>
 660 |     | <span class='neutral'>            value &gt;&gt;= isGt * 16;</span>
 661 |     | <span class='neutral'>            result += isGt * 2;</span>
 662 |     | <span class='neutral'></span>
 663 |     | <span class='neutral'>            result += SafeCast.toUint(value &gt; (1 &lt;&lt; 8) - 1);</span>
 664 |     | <span class='neutral'>        }</span>
 665 |     | <span class='neutral'>        return result;</span>
 666 |     | <span class='neutral'>    }</span>
 667 |     | <span class='neutral'></span>
 668 |     | <span class='neutral'>    /**</span>
 669 |     | <span class='neutral'>     * @dev Return the log in base 256, following the selected rounding direction, of a positive value.</span>
 670 |     | <span class='neutral'>     * Returns 0 if given 0.</span>
 671 |     | <span class='neutral'>     */</span>
 672 |     | <span class='neutral'>    function log256(uint256 value, Rounding rounding) internal pure returns (uint256) {</span>
 673 |     | <span class='neutral'>        unchecked {</span>
 674 |     | <span class='neutral'>            uint256 result = log256(value);</span>
 675 |     | <span class='neutral'>            return result + SafeCast.toUint(unsignedRoundsUp(rounding) &amp;&amp; 1 &lt;&lt; (result &lt;&lt; 3) &lt; value);</span>
 676 |     | <span class='neutral'>        }</span>
 677 |     | <span class='neutral'>    }</span>
 678 |     | <span class='neutral'></span>
 679 |     | <span class='neutral'>    /**</span>
 680 |     | <span class='neutral'>     * @dev Returns whether a provided rounding mode is considered rounding up for unsigned integers.</span>
 681 |     | <span class='neutral'>     */</span>
 682 |     | <span class='neutral'>    function unsignedRoundsUp(Rounding rounding) internal pure returns (bool) {</span>
 683 |     | <span class='neutral'>        return uint8(rounding) % 2 == 1;</span>
 684 |     | <span class='neutral'>    }</span>
 685 |     | <span class='neutral'>}</span>
 686 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/lib/openzeppelin-contracts/contracts/utils/math/SafeCast.sol</b>
<code>
    1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
    2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v5.1.0) (utils/math/SafeCast.sol)</span>
    3 |     | <span class='neutral'>// This file was procedurally generated from scripts/generate/templates/SafeCast.js.</span>
    4 |     | <span class='neutral'></span>
    5 |     | <span class='neutral'>pragma solidity ^0.8.20;</span>
    6 |     | <span class='neutral'></span>
    7 |     | <span class='neutral'>/**</span>
    8 |     | <span class='neutral'> * @dev Wrappers over Solidity&#39;s uintXX/intXX/bool casting operators with added overflow</span>
    9 |     | <span class='neutral'> * checks.</span>
   10 |     | <span class='neutral'> *</span>
   11 |     | <span class='neutral'> * Downcasting from uint256/int256 in Solidity does not revert on overflow. This can</span>
   12 |     | <span class='neutral'> * easily result in undesired exploitation or bugs, since developers usually</span>
   13 |     | <span class='neutral'> * assume that overflows raise errors. `SafeCast` restores this intuition by</span>
   14 |     | <span class='neutral'> * reverting the transaction when such an operation overflows.</span>
   15 |     | <span class='neutral'> *</span>
   16 |     | <span class='neutral'> * Using this library instead of the unchecked operations eliminates an entire</span>
   17 |     | <span class='neutral'> * class of bugs, so it&#39;s recommended to use it always.</span>
   18 |     | <span class='neutral'> */</span>
   19 |     | <span class='unexecuted'>library SafeCast {</span>
   20 |     | <span class='neutral'>    /**</span>
   21 |     | <span class='neutral'>     * @dev Value doesn&#39;t fit in an uint of `bits` size.</span>
   22 |     | <span class='neutral'>     */</span>
   23 |     | <span class='neutral'>    error SafeCastOverflowedUintDowncast(uint8 bits, uint256 value);</span>
   24 |     | <span class='neutral'></span>
   25 |     | <span class='neutral'>    /**</span>
   26 |     | <span class='neutral'>     * @dev An int value doesn&#39;t fit in an uint of `bits` size.</span>
   27 |     | <span class='neutral'>     */</span>
   28 |     | <span class='neutral'>    error SafeCastOverflowedIntToUint(int256 value);</span>
   29 |     | <span class='neutral'></span>
   30 |     | <span class='neutral'>    /**</span>
   31 |     | <span class='neutral'>     * @dev Value doesn&#39;t fit in an int of `bits` size.</span>
   32 |     | <span class='neutral'>     */</span>
   33 |     | <span class='neutral'>    error SafeCastOverflowedIntDowncast(uint8 bits, int256 value);</span>
   34 |     | <span class='neutral'></span>
   35 |     | <span class='neutral'>    /**</span>
   36 |     | <span class='neutral'>     * @dev An uint value doesn&#39;t fit in an int of `bits` size.</span>
   37 |     | <span class='neutral'>     */</span>
   38 |     | <span class='neutral'>    error SafeCastOverflowedUintToInt(uint256 value);</span>
   39 |     | <span class='neutral'></span>
   40 |     | <span class='neutral'>    /**</span>
   41 |     | <span class='neutral'>     * @dev Returns the downcasted uint248 from uint256, reverting on</span>
   42 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint248).</span>
   43 |     | <span class='neutral'>     *</span>
   44 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint248` operator.</span>
   45 |     | <span class='neutral'>     *</span>
   46 |     | <span class='neutral'>     * Requirements:</span>
   47 |     | <span class='neutral'>     *</span>
   48 |     | <span class='neutral'>     * - input must fit into 248 bits</span>
   49 |     | <span class='neutral'>     */</span>
   50 |     | <span class='neutral'>    function toUint248(uint256 value) internal pure returns (uint248) {</span>
   51 |     | <span class='neutral'>        if (value &gt; type(uint248).max) {</span>
   52 |     | <span class='neutral'>            revert SafeCastOverflowedUintDowncast(248, value);</span>
   53 |     | <span class='neutral'>        }</span>
   54 |     | <span class='neutral'>        return uint248(value);</span>
   55 |     | <span class='neutral'>    }</span>
   56 |     | <span class='neutral'></span>
   57 |     | <span class='neutral'>    /**</span>
   58 |     | <span class='neutral'>     * @dev Returns the downcasted uint240 from uint256, reverting on</span>
   59 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint240).</span>
   60 |     | <span class='neutral'>     *</span>
   61 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint240` operator.</span>
   62 |     | <span class='neutral'>     *</span>
   63 |     | <span class='neutral'>     * Requirements:</span>
   64 |     | <span class='neutral'>     *</span>
   65 |     | <span class='neutral'>     * - input must fit into 240 bits</span>
   66 |     | <span class='neutral'>     */</span>
   67 |     | <span class='neutral'>    function toUint240(uint256 value) internal pure returns (uint240) {</span>
   68 |     | <span class='neutral'>        if (value &gt; type(uint240).max) {</span>
   69 |     | <span class='neutral'>            revert SafeCastOverflowedUintDowncast(240, value);</span>
   70 |     | <span class='neutral'>        }</span>
   71 |     | <span class='neutral'>        return uint240(value);</span>
   72 |     | <span class='neutral'>    }</span>
   73 |     | <span class='neutral'></span>
   74 |     | <span class='neutral'>    /**</span>
   75 |     | <span class='neutral'>     * @dev Returns the downcasted uint232 from uint256, reverting on</span>
   76 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint232).</span>
   77 |     | <span class='neutral'>     *</span>
   78 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint232` operator.</span>
   79 |     | <span class='neutral'>     *</span>
   80 |     | <span class='neutral'>     * Requirements:</span>
   81 |     | <span class='neutral'>     *</span>
   82 |     | <span class='neutral'>     * - input must fit into 232 bits</span>
   83 |     | <span class='neutral'>     */</span>
   84 |     | <span class='neutral'>    function toUint232(uint256 value) internal pure returns (uint232) {</span>
   85 |     | <span class='neutral'>        if (value &gt; type(uint232).max) {</span>
   86 |     | <span class='neutral'>            revert SafeCastOverflowedUintDowncast(232, value);</span>
   87 |     | <span class='neutral'>        }</span>
   88 |     | <span class='neutral'>        return uint232(value);</span>
   89 |     | <span class='neutral'>    }</span>
   90 |     | <span class='neutral'></span>
   91 |     | <span class='neutral'>    /**</span>
   92 |     | <span class='neutral'>     * @dev Returns the downcasted uint224 from uint256, reverting on</span>
   93 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint224).</span>
   94 |     | <span class='neutral'>     *</span>
   95 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint224` operator.</span>
   96 |     | <span class='neutral'>     *</span>
   97 |     | <span class='neutral'>     * Requirements:</span>
   98 |     | <span class='neutral'>     *</span>
   99 |     | <span class='neutral'>     * - input must fit into 224 bits</span>
  100 |     | <span class='neutral'>     */</span>
  101 |     | <span class='neutral'>    function toUint224(uint256 value) internal pure returns (uint224) {</span>
  102 |     | <span class='neutral'>        if (value &gt; type(uint224).max) {</span>
  103 |     | <span class='neutral'>            revert SafeCastOverflowedUintDowncast(224, value);</span>
  104 |     | <span class='neutral'>        }</span>
  105 |     | <span class='neutral'>        return uint224(value);</span>
  106 |     | <span class='neutral'>    }</span>
  107 |     | <span class='neutral'></span>
  108 |     | <span class='neutral'>    /**</span>
  109 |     | <span class='neutral'>     * @dev Returns the downcasted uint216 from uint256, reverting on</span>
  110 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint216).</span>
  111 |     | <span class='neutral'>     *</span>
  112 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint216` operator.</span>
  113 |     | <span class='neutral'>     *</span>
  114 |     | <span class='neutral'>     * Requirements:</span>
  115 |     | <span class='neutral'>     *</span>
  116 |     | <span class='neutral'>     * - input must fit into 216 bits</span>
  117 |     | <span class='neutral'>     */</span>
  118 |     | <span class='neutral'>    function toUint216(uint256 value) internal pure returns (uint216) {</span>
  119 |     | <span class='neutral'>        if (value &gt; type(uint216).max) {</span>
  120 |     | <span class='neutral'>            revert SafeCastOverflowedUintDowncast(216, value);</span>
  121 |     | <span class='neutral'>        }</span>
  122 |     | <span class='neutral'>        return uint216(value);</span>
  123 |     | <span class='neutral'>    }</span>
  124 |     | <span class='neutral'></span>
  125 |     | <span class='neutral'>    /**</span>
  126 |     | <span class='neutral'>     * @dev Returns the downcasted uint208 from uint256, reverting on</span>
  127 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint208).</span>
  128 |     | <span class='neutral'>     *</span>
  129 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint208` operator.</span>
  130 |     | <span class='neutral'>     *</span>
  131 |     | <span class='neutral'>     * Requirements:</span>
  132 |     | <span class='neutral'>     *</span>
  133 |     | <span class='neutral'>     * - input must fit into 208 bits</span>
  134 |     | <span class='neutral'>     */</span>
  135 |     | <span class='neutral'>    function toUint208(uint256 value) internal pure returns (uint208) {</span>
  136 |     | <span class='neutral'>        if (value &gt; type(uint208).max) {</span>
  137 |     | <span class='neutral'>            revert SafeCastOverflowedUintDowncast(208, value);</span>
  138 |     | <span class='neutral'>        }</span>
  139 |     | <span class='neutral'>        return uint208(value);</span>
  140 |     | <span class='neutral'>    }</span>
  141 |     | <span class='neutral'></span>
  142 |     | <span class='neutral'>    /**</span>
  143 |     | <span class='neutral'>     * @dev Returns the downcasted uint200 from uint256, reverting on</span>
  144 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint200).</span>
  145 |     | <span class='neutral'>     *</span>
  146 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint200` operator.</span>
  147 |     | <span class='neutral'>     *</span>
  148 |     | <span class='neutral'>     * Requirements:</span>
  149 |     | <span class='neutral'>     *</span>
  150 |     | <span class='neutral'>     * - input must fit into 200 bits</span>
  151 |     | <span class='neutral'>     */</span>
  152 |     | <span class='neutral'>    function toUint200(uint256 value) internal pure returns (uint200) {</span>
  153 |     | <span class='neutral'>        if (value &gt; type(uint200).max) {</span>
  154 |     | <span class='neutral'>            revert SafeCastOverflowedUintDowncast(200, value);</span>
  155 |     | <span class='neutral'>        }</span>
  156 |     | <span class='neutral'>        return uint200(value);</span>
  157 |     | <span class='neutral'>    }</span>
  158 |     | <span class='neutral'></span>
  159 |     | <span class='neutral'>    /**</span>
  160 |     | <span class='neutral'>     * @dev Returns the downcasted uint192 from uint256, reverting on</span>
  161 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint192).</span>
  162 |     | <span class='neutral'>     *</span>
  163 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint192` operator.</span>
  164 |     | <span class='neutral'>     *</span>
  165 |     | <span class='neutral'>     * Requirements:</span>
  166 |     | <span class='neutral'>     *</span>
  167 |     | <span class='neutral'>     * - input must fit into 192 bits</span>
  168 |     | <span class='neutral'>     */</span>
  169 |     | <span class='neutral'>    function toUint192(uint256 value) internal pure returns (uint192) {</span>
  170 |     | <span class='neutral'>        if (value &gt; type(uint192).max) {</span>
  171 |     | <span class='neutral'>            revert SafeCastOverflowedUintDowncast(192, value);</span>
  172 |     | <span class='neutral'>        }</span>
  173 |     | <span class='neutral'>        return uint192(value);</span>
  174 |     | <span class='neutral'>    }</span>
  175 |     | <span class='neutral'></span>
  176 |     | <span class='neutral'>    /**</span>
  177 |     | <span class='neutral'>     * @dev Returns the downcasted uint184 from uint256, reverting on</span>
  178 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint184).</span>
  179 |     | <span class='neutral'>     *</span>
  180 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint184` operator.</span>
  181 |     | <span class='neutral'>     *</span>
  182 |     | <span class='neutral'>     * Requirements:</span>
  183 |     | <span class='neutral'>     *</span>
  184 |     | <span class='neutral'>     * - input must fit into 184 bits</span>
  185 |     | <span class='neutral'>     */</span>
  186 |     | <span class='neutral'>    function toUint184(uint256 value) internal pure returns (uint184) {</span>
  187 |     | <span class='neutral'>        if (value &gt; type(uint184).max) {</span>
  188 |     | <span class='neutral'>            revert SafeCastOverflowedUintDowncast(184, value);</span>
  189 |     | <span class='neutral'>        }</span>
  190 |     | <span class='neutral'>        return uint184(value);</span>
  191 |     | <span class='neutral'>    }</span>
  192 |     | <span class='neutral'></span>
  193 |     | <span class='neutral'>    /**</span>
  194 |     | <span class='neutral'>     * @dev Returns the downcasted uint176 from uint256, reverting on</span>
  195 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint176).</span>
  196 |     | <span class='neutral'>     *</span>
  197 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint176` operator.</span>
  198 |     | <span class='neutral'>     *</span>
  199 |     | <span class='neutral'>     * Requirements:</span>
  200 |     | <span class='neutral'>     *</span>
  201 |     | <span class='neutral'>     * - input must fit into 176 bits</span>
  202 |     | <span class='neutral'>     */</span>
  203 |     | <span class='neutral'>    function toUint176(uint256 value) internal pure returns (uint176) {</span>
  204 |     | <span class='neutral'>        if (value &gt; type(uint176).max) {</span>
  205 |     | <span class='neutral'>            revert SafeCastOverflowedUintDowncast(176, value);</span>
  206 |     | <span class='neutral'>        }</span>
  207 |     | <span class='neutral'>        return uint176(value);</span>
  208 |     | <span class='neutral'>    }</span>
  209 |     | <span class='neutral'></span>
  210 |     | <span class='neutral'>    /**</span>
  211 |     | <span class='neutral'>     * @dev Returns the downcasted uint168 from uint256, reverting on</span>
  212 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint168).</span>
  213 |     | <span class='neutral'>     *</span>
  214 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint168` operator.</span>
  215 |     | <span class='neutral'>     *</span>
  216 |     | <span class='neutral'>     * Requirements:</span>
  217 |     | <span class='neutral'>     *</span>
  218 |     | <span class='neutral'>     * - input must fit into 168 bits</span>
  219 |     | <span class='neutral'>     */</span>
  220 |     | <span class='neutral'>    function toUint168(uint256 value) internal pure returns (uint168) {</span>
  221 |     | <span class='neutral'>        if (value &gt; type(uint168).max) {</span>
  222 |     | <span class='neutral'>            revert SafeCastOverflowedUintDowncast(168, value);</span>
  223 |     | <span class='neutral'>        }</span>
  224 |     | <span class='neutral'>        return uint168(value);</span>
  225 |     | <span class='neutral'>    }</span>
  226 |     | <span class='neutral'></span>
  227 |     | <span class='neutral'>    /**</span>
  228 |     | <span class='neutral'>     * @dev Returns the downcasted uint160 from uint256, reverting on</span>
  229 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint160).</span>
  230 |     | <span class='neutral'>     *</span>
  231 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint160` operator.</span>
  232 |     | <span class='neutral'>     *</span>
  233 |     | <span class='neutral'>     * Requirements:</span>
  234 |     | <span class='neutral'>     *</span>
  235 |     | <span class='neutral'>     * - input must fit into 160 bits</span>
  236 |     | <span class='neutral'>     */</span>
  237 |     | <span class='neutral'>    function toUint160(uint256 value) internal pure returns (uint160) {</span>
  238 |     | <span class='neutral'>        if (value &gt; type(uint160).max) {</span>
  239 |     | <span class='neutral'>            revert SafeCastOverflowedUintDowncast(160, value);</span>
  240 |     | <span class='neutral'>        }</span>
  241 |     | <span class='neutral'>        return uint160(value);</span>
  242 |     | <span class='neutral'>    }</span>
  243 |     | <span class='neutral'></span>
  244 |     | <span class='neutral'>    /**</span>
  245 |     | <span class='neutral'>     * @dev Returns the downcasted uint152 from uint256, reverting on</span>
  246 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint152).</span>
  247 |     | <span class='neutral'>     *</span>
  248 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint152` operator.</span>
  249 |     | <span class='neutral'>     *</span>
  250 |     | <span class='neutral'>     * Requirements:</span>
  251 |     | <span class='neutral'>     *</span>
  252 |     | <span class='neutral'>     * - input must fit into 152 bits</span>
  253 |     | <span class='neutral'>     */</span>
  254 |     | <span class='neutral'>    function toUint152(uint256 value) internal pure returns (uint152) {</span>
  255 |     | <span class='neutral'>        if (value &gt; type(uint152).max) {</span>
  256 |     | <span class='neutral'>            revert SafeCastOverflowedUintDowncast(152, value);</span>
  257 |     | <span class='neutral'>        }</span>
  258 |     | <span class='neutral'>        return uint152(value);</span>
  259 |     | <span class='neutral'>    }</span>
  260 |     | <span class='neutral'></span>
  261 |     | <span class='neutral'>    /**</span>
  262 |     | <span class='neutral'>     * @dev Returns the downcasted uint144 from uint256, reverting on</span>
  263 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint144).</span>
  264 |     | <span class='neutral'>     *</span>
  265 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint144` operator.</span>
  266 |     | <span class='neutral'>     *</span>
  267 |     | <span class='neutral'>     * Requirements:</span>
  268 |     | <span class='neutral'>     *</span>
  269 |     | <span class='neutral'>     * - input must fit into 144 bits</span>
  270 |     | <span class='neutral'>     */</span>
  271 |     | <span class='neutral'>    function toUint144(uint256 value) internal pure returns (uint144) {</span>
  272 |     | <span class='neutral'>        if (value &gt; type(uint144).max) {</span>
  273 |     | <span class='neutral'>            revert SafeCastOverflowedUintDowncast(144, value);</span>
  274 |     | <span class='neutral'>        }</span>
  275 |     | <span class='neutral'>        return uint144(value);</span>
  276 |     | <span class='neutral'>    }</span>
  277 |     | <span class='neutral'></span>
  278 |     | <span class='neutral'>    /**</span>
  279 |     | <span class='neutral'>     * @dev Returns the downcasted uint136 from uint256, reverting on</span>
  280 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint136).</span>
  281 |     | <span class='neutral'>     *</span>
  282 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint136` operator.</span>
  283 |     | <span class='neutral'>     *</span>
  284 |     | <span class='neutral'>     * Requirements:</span>
  285 |     | <span class='neutral'>     *</span>
  286 |     | <span class='neutral'>     * - input must fit into 136 bits</span>
  287 |     | <span class='neutral'>     */</span>
  288 |     | <span class='neutral'>    function toUint136(uint256 value) internal pure returns (uint136) {</span>
  289 |     | <span class='neutral'>        if (value &gt; type(uint136).max) {</span>
  290 |     | <span class='neutral'>            revert SafeCastOverflowedUintDowncast(136, value);</span>
  291 |     | <span class='neutral'>        }</span>
  292 |     | <span class='neutral'>        return uint136(value);</span>
  293 |     | <span class='neutral'>    }</span>
  294 |     | <span class='neutral'></span>
  295 |     | <span class='neutral'>    /**</span>
  296 |     | <span class='neutral'>     * @dev Returns the downcasted uint128 from uint256, reverting on</span>
  297 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint128).</span>
  298 |     | <span class='neutral'>     *</span>
  299 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint128` operator.</span>
  300 |     | <span class='neutral'>     *</span>
  301 |     | <span class='neutral'>     * Requirements:</span>
  302 |     | <span class='neutral'>     *</span>
  303 |     | <span class='neutral'>     * - input must fit into 128 bits</span>
  304 |     | <span class='neutral'>     */</span>
  305 |     | <span class='neutral'>    function toUint128(uint256 value) internal pure returns (uint128) {</span>
  306 |     | <span class='neutral'>        if (value &gt; type(uint128).max) {</span>
  307 |     | <span class='neutral'>            revert SafeCastOverflowedUintDowncast(128, value);</span>
  308 |     | <span class='neutral'>        }</span>
  309 |     | <span class='neutral'>        return uint128(value);</span>
  310 |     | <span class='neutral'>    }</span>
  311 |     | <span class='neutral'></span>
  312 |     | <span class='neutral'>    /**</span>
  313 |     | <span class='neutral'>     * @dev Returns the downcasted uint120 from uint256, reverting on</span>
  314 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint120).</span>
  315 |     | <span class='neutral'>     *</span>
  316 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint120` operator.</span>
  317 |     | <span class='neutral'>     *</span>
  318 |     | <span class='neutral'>     * Requirements:</span>
  319 |     | <span class='neutral'>     *</span>
  320 |     | <span class='neutral'>     * - input must fit into 120 bits</span>
  321 |     | <span class='neutral'>     */</span>
  322 |     | <span class='neutral'>    function toUint120(uint256 value) internal pure returns (uint120) {</span>
  323 |     | <span class='neutral'>        if (value &gt; type(uint120).max) {</span>
  324 |     | <span class='neutral'>            revert SafeCastOverflowedUintDowncast(120, value);</span>
  325 |     | <span class='neutral'>        }</span>
  326 |     | <span class='neutral'>        return uint120(value);</span>
  327 |     | <span class='neutral'>    }</span>
  328 |     | <span class='neutral'></span>
  329 |     | <span class='neutral'>    /**</span>
  330 |     | <span class='neutral'>     * @dev Returns the downcasted uint112 from uint256, reverting on</span>
  331 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint112).</span>
  332 |     | <span class='neutral'>     *</span>
  333 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint112` operator.</span>
  334 |     | <span class='neutral'>     *</span>
  335 |     | <span class='neutral'>     * Requirements:</span>
  336 |     | <span class='neutral'>     *</span>
  337 |     | <span class='neutral'>     * - input must fit into 112 bits</span>
  338 |     | <span class='neutral'>     */</span>
  339 |     | <span class='neutral'>    function toUint112(uint256 value) internal pure returns (uint112) {</span>
  340 |     | <span class='neutral'>        if (value &gt; type(uint112).max) {</span>
  341 |     | <span class='neutral'>            revert SafeCastOverflowedUintDowncast(112, value);</span>
  342 |     | <span class='neutral'>        }</span>
  343 |     | <span class='neutral'>        return uint112(value);</span>
  344 |     | <span class='neutral'>    }</span>
  345 |     | <span class='neutral'></span>
  346 |     | <span class='neutral'>    /**</span>
  347 |     | <span class='neutral'>     * @dev Returns the downcasted uint104 from uint256, reverting on</span>
  348 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint104).</span>
  349 |     | <span class='neutral'>     *</span>
  350 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint104` operator.</span>
  351 |     | <span class='neutral'>     *</span>
  352 |     | <span class='neutral'>     * Requirements:</span>
  353 |     | <span class='neutral'>     *</span>
  354 |     | <span class='neutral'>     * - input must fit into 104 bits</span>
  355 |     | <span class='neutral'>     */</span>
  356 |     | <span class='neutral'>    function toUint104(uint256 value) internal pure returns (uint104) {</span>
  357 |     | <span class='neutral'>        if (value &gt; type(uint104).max) {</span>
  358 |     | <span class='neutral'>            revert SafeCastOverflowedUintDowncast(104, value);</span>
  359 |     | <span class='neutral'>        }</span>
  360 |     | <span class='neutral'>        return uint104(value);</span>
  361 |     | <span class='neutral'>    }</span>
  362 |     | <span class='neutral'></span>
  363 |     | <span class='neutral'>    /**</span>
  364 |     | <span class='neutral'>     * @dev Returns the downcasted uint96 from uint256, reverting on</span>
  365 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint96).</span>
  366 |     | <span class='neutral'>     *</span>
  367 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint96` operator.</span>
  368 |     | <span class='neutral'>     *</span>
  369 |     | <span class='neutral'>     * Requirements:</span>
  370 |     | <span class='neutral'>     *</span>
  371 |     | <span class='neutral'>     * - input must fit into 96 bits</span>
  372 |     | <span class='neutral'>     */</span>
  373 |     | <span class='neutral'>    function toUint96(uint256 value) internal pure returns (uint96) {</span>
  374 |     | <span class='neutral'>        if (value &gt; type(uint96).max) {</span>
  375 |     | <span class='neutral'>            revert SafeCastOverflowedUintDowncast(96, value);</span>
  376 |     | <span class='neutral'>        }</span>
  377 |     | <span class='neutral'>        return uint96(value);</span>
  378 |     | <span class='neutral'>    }</span>
  379 |     | <span class='neutral'></span>
  380 |     | <span class='neutral'>    /**</span>
  381 |     | <span class='neutral'>     * @dev Returns the downcasted uint88 from uint256, reverting on</span>
  382 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint88).</span>
  383 |     | <span class='neutral'>     *</span>
  384 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint88` operator.</span>
  385 |     | <span class='neutral'>     *</span>
  386 |     | <span class='neutral'>     * Requirements:</span>
  387 |     | <span class='neutral'>     *</span>
  388 |     | <span class='neutral'>     * - input must fit into 88 bits</span>
  389 |     | <span class='neutral'>     */</span>
  390 |     | <span class='neutral'>    function toUint88(uint256 value) internal pure returns (uint88) {</span>
  391 |     | <span class='neutral'>        if (value &gt; type(uint88).max) {</span>
  392 |     | <span class='neutral'>            revert SafeCastOverflowedUintDowncast(88, value);</span>
  393 |     | <span class='neutral'>        }</span>
  394 |     | <span class='neutral'>        return uint88(value);</span>
  395 |     | <span class='neutral'>    }</span>
  396 |     | <span class='neutral'></span>
  397 |     | <span class='neutral'>    /**</span>
  398 |     | <span class='neutral'>     * @dev Returns the downcasted uint80 from uint256, reverting on</span>
  399 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint80).</span>
  400 |     | <span class='neutral'>     *</span>
  401 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint80` operator.</span>
  402 |     | <span class='neutral'>     *</span>
  403 |     | <span class='neutral'>     * Requirements:</span>
  404 |     | <span class='neutral'>     *</span>
  405 |     | <span class='neutral'>     * - input must fit into 80 bits</span>
  406 |     | <span class='neutral'>     */</span>
  407 |     | <span class='neutral'>    function toUint80(uint256 value) internal pure returns (uint80) {</span>
  408 |     | <span class='neutral'>        if (value &gt; type(uint80).max) {</span>
  409 |     | <span class='neutral'>            revert SafeCastOverflowedUintDowncast(80, value);</span>
  410 |     | <span class='neutral'>        }</span>
  411 |     | <span class='neutral'>        return uint80(value);</span>
  412 |     | <span class='neutral'>    }</span>
  413 |     | <span class='neutral'></span>
  414 |     | <span class='neutral'>    /**</span>
  415 |     | <span class='neutral'>     * @dev Returns the downcasted uint72 from uint256, reverting on</span>
  416 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint72).</span>
  417 |     | <span class='neutral'>     *</span>
  418 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint72` operator.</span>
  419 |     | <span class='neutral'>     *</span>
  420 |     | <span class='neutral'>     * Requirements:</span>
  421 |     | <span class='neutral'>     *</span>
  422 |     | <span class='neutral'>     * - input must fit into 72 bits</span>
  423 |     | <span class='neutral'>     */</span>
  424 |     | <span class='neutral'>    function toUint72(uint256 value) internal pure returns (uint72) {</span>
  425 |     | <span class='neutral'>        if (value &gt; type(uint72).max) {</span>
  426 |     | <span class='neutral'>            revert SafeCastOverflowedUintDowncast(72, value);</span>
  427 |     | <span class='neutral'>        }</span>
  428 |     | <span class='neutral'>        return uint72(value);</span>
  429 |     | <span class='neutral'>    }</span>
  430 |     | <span class='neutral'></span>
  431 |     | <span class='neutral'>    /**</span>
  432 |     | <span class='neutral'>     * @dev Returns the downcasted uint64 from uint256, reverting on</span>
  433 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint64).</span>
  434 |     | <span class='neutral'>     *</span>
  435 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint64` operator.</span>
  436 |     | <span class='neutral'>     *</span>
  437 |     | <span class='neutral'>     * Requirements:</span>
  438 |     | <span class='neutral'>     *</span>
  439 |     | <span class='neutral'>     * - input must fit into 64 bits</span>
  440 |     | <span class='neutral'>     */</span>
  441 |     | <span class='neutral'>    function toUint64(uint256 value) internal pure returns (uint64) {</span>
  442 |     | <span class='neutral'>        if (value &gt; type(uint64).max) {</span>
  443 |     | <span class='neutral'>            revert SafeCastOverflowedUintDowncast(64, value);</span>
  444 |     | <span class='neutral'>        }</span>
  445 |     | <span class='neutral'>        return uint64(value);</span>
  446 |     | <span class='neutral'>    }</span>
  447 |     | <span class='neutral'></span>
  448 |     | <span class='neutral'>    /**</span>
  449 |     | <span class='neutral'>     * @dev Returns the downcasted uint56 from uint256, reverting on</span>
  450 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint56).</span>
  451 |     | <span class='neutral'>     *</span>
  452 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint56` operator.</span>
  453 |     | <span class='neutral'>     *</span>
  454 |     | <span class='neutral'>     * Requirements:</span>
  455 |     | <span class='neutral'>     *</span>
  456 |     | <span class='neutral'>     * - input must fit into 56 bits</span>
  457 |     | <span class='neutral'>     */</span>
  458 |     | <span class='neutral'>    function toUint56(uint256 value) internal pure returns (uint56) {</span>
  459 |     | <span class='neutral'>        if (value &gt; type(uint56).max) {</span>
  460 |     | <span class='neutral'>            revert SafeCastOverflowedUintDowncast(56, value);</span>
  461 |     | <span class='neutral'>        }</span>
  462 |     | <span class='neutral'>        return uint56(value);</span>
  463 |     | <span class='neutral'>    }</span>
  464 |     | <span class='neutral'></span>
  465 |     | <span class='neutral'>    /**</span>
  466 |     | <span class='neutral'>     * @dev Returns the downcasted uint48 from uint256, reverting on</span>
  467 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint48).</span>
  468 |     | <span class='neutral'>     *</span>
  469 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint48` operator.</span>
  470 |     | <span class='neutral'>     *</span>
  471 |     | <span class='neutral'>     * Requirements:</span>
  472 |     | <span class='neutral'>     *</span>
  473 |     | <span class='neutral'>     * - input must fit into 48 bits</span>
  474 |     | <span class='neutral'>     */</span>
  475 |     | <span class='neutral'>    function toUint48(uint256 value) internal pure returns (uint48) {</span>
  476 |     | <span class='neutral'>        if (value &gt; type(uint48).max) {</span>
  477 |     | <span class='neutral'>            revert SafeCastOverflowedUintDowncast(48, value);</span>
  478 |     | <span class='neutral'>        }</span>
  479 |     | <span class='neutral'>        return uint48(value);</span>
  480 |     | <span class='neutral'>    }</span>
  481 |     | <span class='neutral'></span>
  482 |     | <span class='neutral'>    /**</span>
  483 |     | <span class='neutral'>     * @dev Returns the downcasted uint40 from uint256, reverting on</span>
  484 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint40).</span>
  485 |     | <span class='neutral'>     *</span>
  486 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint40` operator.</span>
  487 |     | <span class='neutral'>     *</span>
  488 |     | <span class='neutral'>     * Requirements:</span>
  489 |     | <span class='neutral'>     *</span>
  490 |     | <span class='neutral'>     * - input must fit into 40 bits</span>
  491 |     | <span class='neutral'>     */</span>
  492 |     | <span class='neutral'>    function toUint40(uint256 value) internal pure returns (uint40) {</span>
  493 |     | <span class='neutral'>        if (value &gt; type(uint40).max) {</span>
  494 |     | <span class='neutral'>            revert SafeCastOverflowedUintDowncast(40, value);</span>
  495 |     | <span class='neutral'>        }</span>
  496 |     | <span class='neutral'>        return uint40(value);</span>
  497 |     | <span class='neutral'>    }</span>
  498 |     | <span class='neutral'></span>
  499 |     | <span class='neutral'>    /**</span>
  500 |     | <span class='neutral'>     * @dev Returns the downcasted uint32 from uint256, reverting on</span>
  501 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint32).</span>
  502 |     | <span class='neutral'>     *</span>
  503 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint32` operator.</span>
  504 |     | <span class='neutral'>     *</span>
  505 |     | <span class='neutral'>     * Requirements:</span>
  506 |     | <span class='neutral'>     *</span>
  507 |     | <span class='neutral'>     * - input must fit into 32 bits</span>
  508 |     | <span class='neutral'>     */</span>
  509 |     | <span class='neutral'>    function toUint32(uint256 value) internal pure returns (uint32) {</span>
  510 |     | <span class='neutral'>        if (value &gt; type(uint32).max) {</span>
  511 |     | <span class='neutral'>            revert SafeCastOverflowedUintDowncast(32, value);</span>
  512 |     | <span class='neutral'>        }</span>
  513 |     | <span class='neutral'>        return uint32(value);</span>
  514 |     | <span class='neutral'>    }</span>
  515 |     | <span class='neutral'></span>
  516 |     | <span class='neutral'>    /**</span>
  517 |     | <span class='neutral'>     * @dev Returns the downcasted uint24 from uint256, reverting on</span>
  518 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint24).</span>
  519 |     | <span class='neutral'>     *</span>
  520 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint24` operator.</span>
  521 |     | <span class='neutral'>     *</span>
  522 |     | <span class='neutral'>     * Requirements:</span>
  523 |     | <span class='neutral'>     *</span>
  524 |     | <span class='neutral'>     * - input must fit into 24 bits</span>
  525 |     | <span class='neutral'>     */</span>
  526 |     | <span class='neutral'>    function toUint24(uint256 value) internal pure returns (uint24) {</span>
  527 |     | <span class='neutral'>        if (value &gt; type(uint24).max) {</span>
  528 |     | <span class='neutral'>            revert SafeCastOverflowedUintDowncast(24, value);</span>
  529 |     | <span class='neutral'>        }</span>
  530 |     | <span class='neutral'>        return uint24(value);</span>
  531 |     | <span class='neutral'>    }</span>
  532 |     | <span class='neutral'></span>
  533 |     | <span class='neutral'>    /**</span>
  534 |     | <span class='neutral'>     * @dev Returns the downcasted uint16 from uint256, reverting on</span>
  535 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint16).</span>
  536 |     | <span class='neutral'>     *</span>
  537 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint16` operator.</span>
  538 |     | <span class='neutral'>     *</span>
  539 |     | <span class='neutral'>     * Requirements:</span>
  540 |     | <span class='neutral'>     *</span>
  541 |     | <span class='neutral'>     * - input must fit into 16 bits</span>
  542 |     | <span class='neutral'>     */</span>
  543 |     | <span class='neutral'>    function toUint16(uint256 value) internal pure returns (uint16) {</span>
  544 |     | <span class='neutral'>        if (value &gt; type(uint16).max) {</span>
  545 |     | <span class='neutral'>            revert SafeCastOverflowedUintDowncast(16, value);</span>
  546 |     | <span class='neutral'>        }</span>
  547 |     | <span class='neutral'>        return uint16(value);</span>
  548 |     | <span class='neutral'>    }</span>
  549 |     | <span class='neutral'></span>
  550 |     | <span class='neutral'>    /**</span>
  551 |     | <span class='neutral'>     * @dev Returns the downcasted uint8 from uint256, reverting on</span>
  552 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint8).</span>
  553 |     | <span class='neutral'>     *</span>
  554 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint8` operator.</span>
  555 |     | <span class='neutral'>     *</span>
  556 |     | <span class='neutral'>     * Requirements:</span>
  557 |     | <span class='neutral'>     *</span>
  558 |     | <span class='neutral'>     * - input must fit into 8 bits</span>
  559 |     | <span class='neutral'>     */</span>
  560 |     | <span class='neutral'>    function toUint8(uint256 value) internal pure returns (uint8) {</span>
  561 |     | <span class='neutral'>        if (value &gt; type(uint8).max) {</span>
  562 |     | <span class='neutral'>            revert SafeCastOverflowedUintDowncast(8, value);</span>
  563 |     | <span class='neutral'>        }</span>
  564 |     | <span class='neutral'>        return uint8(value);</span>
  565 |     | <span class='neutral'>    }</span>
  566 |     | <span class='neutral'></span>
  567 |     | <span class='neutral'>    /**</span>
  568 |     | <span class='neutral'>     * @dev Converts a signed int256 into an unsigned uint256.</span>
  569 |     | <span class='neutral'>     *</span>
  570 |     | <span class='neutral'>     * Requirements:</span>
  571 |     | <span class='neutral'>     *</span>
  572 |     | <span class='neutral'>     * - input must be greater than or equal to 0.</span>
  573 |     | <span class='neutral'>     */</span>
  574 |     | <span class='neutral'>    function toUint256(int256 value) internal pure returns (uint256) {</span>
  575 |     | <span class='neutral'>        if (value &lt; 0) {</span>
  576 |     | <span class='neutral'>            revert SafeCastOverflowedIntToUint(value);</span>
  577 |     | <span class='neutral'>        }</span>
  578 |     | <span class='neutral'>        return uint256(value);</span>
  579 |     | <span class='neutral'>    }</span>
  580 |     | <span class='neutral'></span>
  581 |     | <span class='neutral'>    /**</span>
  582 |     | <span class='neutral'>     * @dev Returns the downcasted int248 from int256, reverting on</span>
  583 |     | <span class='neutral'>     * overflow (when the input is less than smallest int248 or</span>
  584 |     | <span class='neutral'>     * greater than largest int248).</span>
  585 |     | <span class='neutral'>     *</span>
  586 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int248` operator.</span>
  587 |     | <span class='neutral'>     *</span>
  588 |     | <span class='neutral'>     * Requirements:</span>
  589 |     | <span class='neutral'>     *</span>
  590 |     | <span class='neutral'>     * - input must fit into 248 bits</span>
  591 |     | <span class='neutral'>     */</span>
  592 |     | <span class='neutral'>    function toInt248(int256 value) internal pure returns (int248 downcasted) {</span>
  593 |     | <span class='neutral'>        downcasted = int248(value);</span>
  594 |     | <span class='neutral'>        if (downcasted != value) {</span>
  595 |     | <span class='neutral'>            revert SafeCastOverflowedIntDowncast(248, value);</span>
  596 |     | <span class='neutral'>        }</span>
  597 |     | <span class='neutral'>    }</span>
  598 |     | <span class='neutral'></span>
  599 |     | <span class='neutral'>    /**</span>
  600 |     | <span class='neutral'>     * @dev Returns the downcasted int240 from int256, reverting on</span>
  601 |     | <span class='neutral'>     * overflow (when the input is less than smallest int240 or</span>
  602 |     | <span class='neutral'>     * greater than largest int240).</span>
  603 |     | <span class='neutral'>     *</span>
  604 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int240` operator.</span>
  605 |     | <span class='neutral'>     *</span>
  606 |     | <span class='neutral'>     * Requirements:</span>
  607 |     | <span class='neutral'>     *</span>
  608 |     | <span class='neutral'>     * - input must fit into 240 bits</span>
  609 |     | <span class='neutral'>     */</span>
  610 |     | <span class='neutral'>    function toInt240(int256 value) internal pure returns (int240 downcasted) {</span>
  611 |     | <span class='neutral'>        downcasted = int240(value);</span>
  612 |     | <span class='neutral'>        if (downcasted != value) {</span>
  613 |     | <span class='neutral'>            revert SafeCastOverflowedIntDowncast(240, value);</span>
  614 |     | <span class='neutral'>        }</span>
  615 |     | <span class='neutral'>    }</span>
  616 |     | <span class='neutral'></span>
  617 |     | <span class='neutral'>    /**</span>
  618 |     | <span class='neutral'>     * @dev Returns the downcasted int232 from int256, reverting on</span>
  619 |     | <span class='neutral'>     * overflow (when the input is less than smallest int232 or</span>
  620 |     | <span class='neutral'>     * greater than largest int232).</span>
  621 |     | <span class='neutral'>     *</span>
  622 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int232` operator.</span>
  623 |     | <span class='neutral'>     *</span>
  624 |     | <span class='neutral'>     * Requirements:</span>
  625 |     | <span class='neutral'>     *</span>
  626 |     | <span class='neutral'>     * - input must fit into 232 bits</span>
  627 |     | <span class='neutral'>     */</span>
  628 |     | <span class='neutral'>    function toInt232(int256 value) internal pure returns (int232 downcasted) {</span>
  629 |     | <span class='neutral'>        downcasted = int232(value);</span>
  630 |     | <span class='neutral'>        if (downcasted != value) {</span>
  631 |     | <span class='neutral'>            revert SafeCastOverflowedIntDowncast(232, value);</span>
  632 |     | <span class='neutral'>        }</span>
  633 |     | <span class='neutral'>    }</span>
  634 |     | <span class='neutral'></span>
  635 |     | <span class='neutral'>    /**</span>
  636 |     | <span class='neutral'>     * @dev Returns the downcasted int224 from int256, reverting on</span>
  637 |     | <span class='neutral'>     * overflow (when the input is less than smallest int224 or</span>
  638 |     | <span class='neutral'>     * greater than largest int224).</span>
  639 |     | <span class='neutral'>     *</span>
  640 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int224` operator.</span>
  641 |     | <span class='neutral'>     *</span>
  642 |     | <span class='neutral'>     * Requirements:</span>
  643 |     | <span class='neutral'>     *</span>
  644 |     | <span class='neutral'>     * - input must fit into 224 bits</span>
  645 |     | <span class='neutral'>     */</span>
  646 |     | <span class='neutral'>    function toInt224(int256 value) internal pure returns (int224 downcasted) {</span>
  647 |     | <span class='neutral'>        downcasted = int224(value);</span>
  648 |     | <span class='neutral'>        if (downcasted != value) {</span>
  649 |     | <span class='neutral'>            revert SafeCastOverflowedIntDowncast(224, value);</span>
  650 |     | <span class='neutral'>        }</span>
  651 |     | <span class='neutral'>    }</span>
  652 |     | <span class='neutral'></span>
  653 |     | <span class='neutral'>    /**</span>
  654 |     | <span class='neutral'>     * @dev Returns the downcasted int216 from int256, reverting on</span>
  655 |     | <span class='neutral'>     * overflow (when the input is less than smallest int216 or</span>
  656 |     | <span class='neutral'>     * greater than largest int216).</span>
  657 |     | <span class='neutral'>     *</span>
  658 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int216` operator.</span>
  659 |     | <span class='neutral'>     *</span>
  660 |     | <span class='neutral'>     * Requirements:</span>
  661 |     | <span class='neutral'>     *</span>
  662 |     | <span class='neutral'>     * - input must fit into 216 bits</span>
  663 |     | <span class='neutral'>     */</span>
  664 |     | <span class='neutral'>    function toInt216(int256 value) internal pure returns (int216 downcasted) {</span>
  665 |     | <span class='neutral'>        downcasted = int216(value);</span>
  666 |     | <span class='neutral'>        if (downcasted != value) {</span>
  667 |     | <span class='neutral'>            revert SafeCastOverflowedIntDowncast(216, value);</span>
  668 |     | <span class='neutral'>        }</span>
  669 |     | <span class='neutral'>    }</span>
  670 |     | <span class='neutral'></span>
  671 |     | <span class='neutral'>    /**</span>
  672 |     | <span class='neutral'>     * @dev Returns the downcasted int208 from int256, reverting on</span>
  673 |     | <span class='neutral'>     * overflow (when the input is less than smallest int208 or</span>
  674 |     | <span class='neutral'>     * greater than largest int208).</span>
  675 |     | <span class='neutral'>     *</span>
  676 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int208` operator.</span>
  677 |     | <span class='neutral'>     *</span>
  678 |     | <span class='neutral'>     * Requirements:</span>
  679 |     | <span class='neutral'>     *</span>
  680 |     | <span class='neutral'>     * - input must fit into 208 bits</span>
  681 |     | <span class='neutral'>     */</span>
  682 |     | <span class='neutral'>    function toInt208(int256 value) internal pure returns (int208 downcasted) {</span>
  683 |     | <span class='neutral'>        downcasted = int208(value);</span>
  684 |     | <span class='neutral'>        if (downcasted != value) {</span>
  685 |     | <span class='neutral'>            revert SafeCastOverflowedIntDowncast(208, value);</span>
  686 |     | <span class='neutral'>        }</span>
  687 |     | <span class='neutral'>    }</span>
  688 |     | <span class='neutral'></span>
  689 |     | <span class='neutral'>    /**</span>
  690 |     | <span class='neutral'>     * @dev Returns the downcasted int200 from int256, reverting on</span>
  691 |     | <span class='neutral'>     * overflow (when the input is less than smallest int200 or</span>
  692 |     | <span class='neutral'>     * greater than largest int200).</span>
  693 |     | <span class='neutral'>     *</span>
  694 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int200` operator.</span>
  695 |     | <span class='neutral'>     *</span>
  696 |     | <span class='neutral'>     * Requirements:</span>
  697 |     | <span class='neutral'>     *</span>
  698 |     | <span class='neutral'>     * - input must fit into 200 bits</span>
  699 |     | <span class='neutral'>     */</span>
  700 |     | <span class='neutral'>    function toInt200(int256 value) internal pure returns (int200 downcasted) {</span>
  701 |     | <span class='neutral'>        downcasted = int200(value);</span>
  702 |     | <span class='neutral'>        if (downcasted != value) {</span>
  703 |     | <span class='neutral'>            revert SafeCastOverflowedIntDowncast(200, value);</span>
  704 |     | <span class='neutral'>        }</span>
  705 |     | <span class='neutral'>    }</span>
  706 |     | <span class='neutral'></span>
  707 |     | <span class='neutral'>    /**</span>
  708 |     | <span class='neutral'>     * @dev Returns the downcasted int192 from int256, reverting on</span>
  709 |     | <span class='neutral'>     * overflow (when the input is less than smallest int192 or</span>
  710 |     | <span class='neutral'>     * greater than largest int192).</span>
  711 |     | <span class='neutral'>     *</span>
  712 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int192` operator.</span>
  713 |     | <span class='neutral'>     *</span>
  714 |     | <span class='neutral'>     * Requirements:</span>
  715 |     | <span class='neutral'>     *</span>
  716 |     | <span class='neutral'>     * - input must fit into 192 bits</span>
  717 |     | <span class='neutral'>     */</span>
  718 |     | <span class='neutral'>    function toInt192(int256 value) internal pure returns (int192 downcasted) {</span>
  719 |     | <span class='neutral'>        downcasted = int192(value);</span>
  720 |     | <span class='neutral'>        if (downcasted != value) {</span>
  721 |     | <span class='neutral'>            revert SafeCastOverflowedIntDowncast(192, value);</span>
  722 |     | <span class='neutral'>        }</span>
  723 |     | <span class='neutral'>    }</span>
  724 |     | <span class='neutral'></span>
  725 |     | <span class='neutral'>    /**</span>
  726 |     | <span class='neutral'>     * @dev Returns the downcasted int184 from int256, reverting on</span>
  727 |     | <span class='neutral'>     * overflow (when the input is less than smallest int184 or</span>
  728 |     | <span class='neutral'>     * greater than largest int184).</span>
  729 |     | <span class='neutral'>     *</span>
  730 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int184` operator.</span>
  731 |     | <span class='neutral'>     *</span>
  732 |     | <span class='neutral'>     * Requirements:</span>
  733 |     | <span class='neutral'>     *</span>
  734 |     | <span class='neutral'>     * - input must fit into 184 bits</span>
  735 |     | <span class='neutral'>     */</span>
  736 |     | <span class='neutral'>    function toInt184(int256 value) internal pure returns (int184 downcasted) {</span>
  737 |     | <span class='neutral'>        downcasted = int184(value);</span>
  738 |     | <span class='neutral'>        if (downcasted != value) {</span>
  739 |     | <span class='neutral'>            revert SafeCastOverflowedIntDowncast(184, value);</span>
  740 |     | <span class='neutral'>        }</span>
  741 |     | <span class='neutral'>    }</span>
  742 |     | <span class='neutral'></span>
  743 |     | <span class='neutral'>    /**</span>
  744 |     | <span class='neutral'>     * @dev Returns the downcasted int176 from int256, reverting on</span>
  745 |     | <span class='neutral'>     * overflow (when the input is less than smallest int176 or</span>
  746 |     | <span class='neutral'>     * greater than largest int176).</span>
  747 |     | <span class='neutral'>     *</span>
  748 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int176` operator.</span>
  749 |     | <span class='neutral'>     *</span>
  750 |     | <span class='neutral'>     * Requirements:</span>
  751 |     | <span class='neutral'>     *</span>
  752 |     | <span class='neutral'>     * - input must fit into 176 bits</span>
  753 |     | <span class='neutral'>     */</span>
  754 |     | <span class='neutral'>    function toInt176(int256 value) internal pure returns (int176 downcasted) {</span>
  755 |     | <span class='neutral'>        downcasted = int176(value);</span>
  756 |     | <span class='neutral'>        if (downcasted != value) {</span>
  757 |     | <span class='neutral'>            revert SafeCastOverflowedIntDowncast(176, value);</span>
  758 |     | <span class='neutral'>        }</span>
  759 |     | <span class='neutral'>    }</span>
  760 |     | <span class='neutral'></span>
  761 |     | <span class='neutral'>    /**</span>
  762 |     | <span class='neutral'>     * @dev Returns the downcasted int168 from int256, reverting on</span>
  763 |     | <span class='neutral'>     * overflow (when the input is less than smallest int168 or</span>
  764 |     | <span class='neutral'>     * greater than largest int168).</span>
  765 |     | <span class='neutral'>     *</span>
  766 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int168` operator.</span>
  767 |     | <span class='neutral'>     *</span>
  768 |     | <span class='neutral'>     * Requirements:</span>
  769 |     | <span class='neutral'>     *</span>
  770 |     | <span class='neutral'>     * - input must fit into 168 bits</span>
  771 |     | <span class='neutral'>     */</span>
  772 |     | <span class='neutral'>    function toInt168(int256 value) internal pure returns (int168 downcasted) {</span>
  773 |     | <span class='neutral'>        downcasted = int168(value);</span>
  774 |     | <span class='neutral'>        if (downcasted != value) {</span>
  775 |     | <span class='neutral'>            revert SafeCastOverflowedIntDowncast(168, value);</span>
  776 |     | <span class='neutral'>        }</span>
  777 |     | <span class='neutral'>    }</span>
  778 |     | <span class='neutral'></span>
  779 |     | <span class='neutral'>    /**</span>
  780 |     | <span class='neutral'>     * @dev Returns the downcasted int160 from int256, reverting on</span>
  781 |     | <span class='neutral'>     * overflow (when the input is less than smallest int160 or</span>
  782 |     | <span class='neutral'>     * greater than largest int160).</span>
  783 |     | <span class='neutral'>     *</span>
  784 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int160` operator.</span>
  785 |     | <span class='neutral'>     *</span>
  786 |     | <span class='neutral'>     * Requirements:</span>
  787 |     | <span class='neutral'>     *</span>
  788 |     | <span class='neutral'>     * - input must fit into 160 bits</span>
  789 |     | <span class='neutral'>     */</span>
  790 |     | <span class='neutral'>    function toInt160(int256 value) internal pure returns (int160 downcasted) {</span>
  791 |     | <span class='neutral'>        downcasted = int160(value);</span>
  792 |     | <span class='neutral'>        if (downcasted != value) {</span>
  793 |     | <span class='neutral'>            revert SafeCastOverflowedIntDowncast(160, value);</span>
  794 |     | <span class='neutral'>        }</span>
  795 |     | <span class='neutral'>    }</span>
  796 |     | <span class='neutral'></span>
  797 |     | <span class='neutral'>    /**</span>
  798 |     | <span class='neutral'>     * @dev Returns the downcasted int152 from int256, reverting on</span>
  799 |     | <span class='neutral'>     * overflow (when the input is less than smallest int152 or</span>
  800 |     | <span class='neutral'>     * greater than largest int152).</span>
  801 |     | <span class='neutral'>     *</span>
  802 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int152` operator.</span>
  803 |     | <span class='neutral'>     *</span>
  804 |     | <span class='neutral'>     * Requirements:</span>
  805 |     | <span class='neutral'>     *</span>
  806 |     | <span class='neutral'>     * - input must fit into 152 bits</span>
  807 |     | <span class='neutral'>     */</span>
  808 |     | <span class='neutral'>    function toInt152(int256 value) internal pure returns (int152 downcasted) {</span>
  809 |     | <span class='neutral'>        downcasted = int152(value);</span>
  810 |     | <span class='neutral'>        if (downcasted != value) {</span>
  811 |     | <span class='neutral'>            revert SafeCastOverflowedIntDowncast(152, value);</span>
  812 |     | <span class='neutral'>        }</span>
  813 |     | <span class='neutral'>    }</span>
  814 |     | <span class='neutral'></span>
  815 |     | <span class='neutral'>    /**</span>
  816 |     | <span class='neutral'>     * @dev Returns the downcasted int144 from int256, reverting on</span>
  817 |     | <span class='neutral'>     * overflow (when the input is less than smallest int144 or</span>
  818 |     | <span class='neutral'>     * greater than largest int144).</span>
  819 |     | <span class='neutral'>     *</span>
  820 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int144` operator.</span>
  821 |     | <span class='neutral'>     *</span>
  822 |     | <span class='neutral'>     * Requirements:</span>
  823 |     | <span class='neutral'>     *</span>
  824 |     | <span class='neutral'>     * - input must fit into 144 bits</span>
  825 |     | <span class='neutral'>     */</span>
  826 |     | <span class='neutral'>    function toInt144(int256 value) internal pure returns (int144 downcasted) {</span>
  827 |     | <span class='neutral'>        downcasted = int144(value);</span>
  828 |     | <span class='neutral'>        if (downcasted != value) {</span>
  829 |     | <span class='neutral'>            revert SafeCastOverflowedIntDowncast(144, value);</span>
  830 |     | <span class='neutral'>        }</span>
  831 |     | <span class='neutral'>    }</span>
  832 |     | <span class='neutral'></span>
  833 |     | <span class='neutral'>    /**</span>
  834 |     | <span class='neutral'>     * @dev Returns the downcasted int136 from int256, reverting on</span>
  835 |     | <span class='neutral'>     * overflow (when the input is less than smallest int136 or</span>
  836 |     | <span class='neutral'>     * greater than largest int136).</span>
  837 |     | <span class='neutral'>     *</span>
  838 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int136` operator.</span>
  839 |     | <span class='neutral'>     *</span>
  840 |     | <span class='neutral'>     * Requirements:</span>
  841 |     | <span class='neutral'>     *</span>
  842 |     | <span class='neutral'>     * - input must fit into 136 bits</span>
  843 |     | <span class='neutral'>     */</span>
  844 |     | <span class='neutral'>    function toInt136(int256 value) internal pure returns (int136 downcasted) {</span>
  845 |     | <span class='neutral'>        downcasted = int136(value);</span>
  846 |     | <span class='neutral'>        if (downcasted != value) {</span>
  847 |     | <span class='neutral'>            revert SafeCastOverflowedIntDowncast(136, value);</span>
  848 |     | <span class='neutral'>        }</span>
  849 |     | <span class='neutral'>    }</span>
  850 |     | <span class='neutral'></span>
  851 |     | <span class='neutral'>    /**</span>
  852 |     | <span class='neutral'>     * @dev Returns the downcasted int128 from int256, reverting on</span>
  853 |     | <span class='neutral'>     * overflow (when the input is less than smallest int128 or</span>
  854 |     | <span class='neutral'>     * greater than largest int128).</span>
  855 |     | <span class='neutral'>     *</span>
  856 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int128` operator.</span>
  857 |     | <span class='neutral'>     *</span>
  858 |     | <span class='neutral'>     * Requirements:</span>
  859 |     | <span class='neutral'>     *</span>
  860 |     | <span class='neutral'>     * - input must fit into 128 bits</span>
  861 |     | <span class='neutral'>     */</span>
  862 |     | <span class='neutral'>    function toInt128(int256 value) internal pure returns (int128 downcasted) {</span>
  863 |     | <span class='neutral'>        downcasted = int128(value);</span>
  864 |     | <span class='neutral'>        if (downcasted != value) {</span>
  865 |     | <span class='neutral'>            revert SafeCastOverflowedIntDowncast(128, value);</span>
  866 |     | <span class='neutral'>        }</span>
  867 |     | <span class='neutral'>    }</span>
  868 |     | <span class='neutral'></span>
  869 |     | <span class='neutral'>    /**</span>
  870 |     | <span class='neutral'>     * @dev Returns the downcasted int120 from int256, reverting on</span>
  871 |     | <span class='neutral'>     * overflow (when the input is less than smallest int120 or</span>
  872 |     | <span class='neutral'>     * greater than largest int120).</span>
  873 |     | <span class='neutral'>     *</span>
  874 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int120` operator.</span>
  875 |     | <span class='neutral'>     *</span>
  876 |     | <span class='neutral'>     * Requirements:</span>
  877 |     | <span class='neutral'>     *</span>
  878 |     | <span class='neutral'>     * - input must fit into 120 bits</span>
  879 |     | <span class='neutral'>     */</span>
  880 |     | <span class='neutral'>    function toInt120(int256 value) internal pure returns (int120 downcasted) {</span>
  881 |     | <span class='neutral'>        downcasted = int120(value);</span>
  882 |     | <span class='neutral'>        if (downcasted != value) {</span>
  883 |     | <span class='neutral'>            revert SafeCastOverflowedIntDowncast(120, value);</span>
  884 |     | <span class='neutral'>        }</span>
  885 |     | <span class='neutral'>    }</span>
  886 |     | <span class='neutral'></span>
  887 |     | <span class='neutral'>    /**</span>
  888 |     | <span class='neutral'>     * @dev Returns the downcasted int112 from int256, reverting on</span>
  889 |     | <span class='neutral'>     * overflow (when the input is less than smallest int112 or</span>
  890 |     | <span class='neutral'>     * greater than largest int112).</span>
  891 |     | <span class='neutral'>     *</span>
  892 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int112` operator.</span>
  893 |     | <span class='neutral'>     *</span>
  894 |     | <span class='neutral'>     * Requirements:</span>
  895 |     | <span class='neutral'>     *</span>
  896 |     | <span class='neutral'>     * - input must fit into 112 bits</span>
  897 |     | <span class='neutral'>     */</span>
  898 |     | <span class='neutral'>    function toInt112(int256 value) internal pure returns (int112 downcasted) {</span>
  899 |     | <span class='neutral'>        downcasted = int112(value);</span>
  900 |     | <span class='neutral'>        if (downcasted != value) {</span>
  901 |     | <span class='neutral'>            revert SafeCastOverflowedIntDowncast(112, value);</span>
  902 |     | <span class='neutral'>        }</span>
  903 |     | <span class='neutral'>    }</span>
  904 |     | <span class='neutral'></span>
  905 |     | <span class='neutral'>    /**</span>
  906 |     | <span class='neutral'>     * @dev Returns the downcasted int104 from int256, reverting on</span>
  907 |     | <span class='neutral'>     * overflow (when the input is less than smallest int104 or</span>
  908 |     | <span class='neutral'>     * greater than largest int104).</span>
  909 |     | <span class='neutral'>     *</span>
  910 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int104` operator.</span>
  911 |     | <span class='neutral'>     *</span>
  912 |     | <span class='neutral'>     * Requirements:</span>
  913 |     | <span class='neutral'>     *</span>
  914 |     | <span class='neutral'>     * - input must fit into 104 bits</span>
  915 |     | <span class='neutral'>     */</span>
  916 |     | <span class='neutral'>    function toInt104(int256 value) internal pure returns (int104 downcasted) {</span>
  917 |     | <span class='neutral'>        downcasted = int104(value);</span>
  918 |     | <span class='neutral'>        if (downcasted != value) {</span>
  919 |     | <span class='neutral'>            revert SafeCastOverflowedIntDowncast(104, value);</span>
  920 |     | <span class='neutral'>        }</span>
  921 |     | <span class='neutral'>    }</span>
  922 |     | <span class='neutral'></span>
  923 |     | <span class='neutral'>    /**</span>
  924 |     | <span class='neutral'>     * @dev Returns the downcasted int96 from int256, reverting on</span>
  925 |     | <span class='neutral'>     * overflow (when the input is less than smallest int96 or</span>
  926 |     | <span class='neutral'>     * greater than largest int96).</span>
  927 |     | <span class='neutral'>     *</span>
  928 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int96` operator.</span>
  929 |     | <span class='neutral'>     *</span>
  930 |     | <span class='neutral'>     * Requirements:</span>
  931 |     | <span class='neutral'>     *</span>
  932 |     | <span class='neutral'>     * - input must fit into 96 bits</span>
  933 |     | <span class='neutral'>     */</span>
  934 |     | <span class='neutral'>    function toInt96(int256 value) internal pure returns (int96 downcasted) {</span>
  935 |     | <span class='neutral'>        downcasted = int96(value);</span>
  936 |     | <span class='neutral'>        if (downcasted != value) {</span>
  937 |     | <span class='neutral'>            revert SafeCastOverflowedIntDowncast(96, value);</span>
  938 |     | <span class='neutral'>        }</span>
  939 |     | <span class='neutral'>    }</span>
  940 |     | <span class='neutral'></span>
  941 |     | <span class='neutral'>    /**</span>
  942 |     | <span class='neutral'>     * @dev Returns the downcasted int88 from int256, reverting on</span>
  943 |     | <span class='neutral'>     * overflow (when the input is less than smallest int88 or</span>
  944 |     | <span class='neutral'>     * greater than largest int88).</span>
  945 |     | <span class='neutral'>     *</span>
  946 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int88` operator.</span>
  947 |     | <span class='neutral'>     *</span>
  948 |     | <span class='neutral'>     * Requirements:</span>
  949 |     | <span class='neutral'>     *</span>
  950 |     | <span class='neutral'>     * - input must fit into 88 bits</span>
  951 |     | <span class='neutral'>     */</span>
  952 |     | <span class='neutral'>    function toInt88(int256 value) internal pure returns (int88 downcasted) {</span>
  953 |     | <span class='neutral'>        downcasted = int88(value);</span>
  954 |     | <span class='neutral'>        if (downcasted != value) {</span>
  955 |     | <span class='neutral'>            revert SafeCastOverflowedIntDowncast(88, value);</span>
  956 |     | <span class='neutral'>        }</span>
  957 |     | <span class='neutral'>    }</span>
  958 |     | <span class='neutral'></span>
  959 |     | <span class='neutral'>    /**</span>
  960 |     | <span class='neutral'>     * @dev Returns the downcasted int80 from int256, reverting on</span>
  961 |     | <span class='neutral'>     * overflow (when the input is less than smallest int80 or</span>
  962 |     | <span class='neutral'>     * greater than largest int80).</span>
  963 |     | <span class='neutral'>     *</span>
  964 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int80` operator.</span>
  965 |     | <span class='neutral'>     *</span>
  966 |     | <span class='neutral'>     * Requirements:</span>
  967 |     | <span class='neutral'>     *</span>
  968 |     | <span class='neutral'>     * - input must fit into 80 bits</span>
  969 |     | <span class='neutral'>     */</span>
  970 |     | <span class='neutral'>    function toInt80(int256 value) internal pure returns (int80 downcasted) {</span>
  971 |     | <span class='neutral'>        downcasted = int80(value);</span>
  972 |     | <span class='neutral'>        if (downcasted != value) {</span>
  973 |     | <span class='neutral'>            revert SafeCastOverflowedIntDowncast(80, value);</span>
  974 |     | <span class='neutral'>        }</span>
  975 |     | <span class='neutral'>    }</span>
  976 |     | <span class='neutral'></span>
  977 |     | <span class='neutral'>    /**</span>
  978 |     | <span class='neutral'>     * @dev Returns the downcasted int72 from int256, reverting on</span>
  979 |     | <span class='neutral'>     * overflow (when the input is less than smallest int72 or</span>
  980 |     | <span class='neutral'>     * greater than largest int72).</span>
  981 |     | <span class='neutral'>     *</span>
  982 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int72` operator.</span>
  983 |     | <span class='neutral'>     *</span>
  984 |     | <span class='neutral'>     * Requirements:</span>
  985 |     | <span class='neutral'>     *</span>
  986 |     | <span class='neutral'>     * - input must fit into 72 bits</span>
  987 |     | <span class='neutral'>     */</span>
  988 |     | <span class='neutral'>    function toInt72(int256 value) internal pure returns (int72 downcasted) {</span>
  989 |     | <span class='neutral'>        downcasted = int72(value);</span>
  990 |     | <span class='neutral'>        if (downcasted != value) {</span>
  991 |     | <span class='neutral'>            revert SafeCastOverflowedIntDowncast(72, value);</span>
  992 |     | <span class='neutral'>        }</span>
  993 |     | <span class='neutral'>    }</span>
  994 |     | <span class='neutral'></span>
  995 |     | <span class='neutral'>    /**</span>
  996 |     | <span class='neutral'>     * @dev Returns the downcasted int64 from int256, reverting on</span>
  997 |     | <span class='neutral'>     * overflow (when the input is less than smallest int64 or</span>
  998 |     | <span class='neutral'>     * greater than largest int64).</span>
  999 |     | <span class='neutral'>     *</span>
 1000 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int64` operator.</span>
 1001 |     | <span class='neutral'>     *</span>
 1002 |     | <span class='neutral'>     * Requirements:</span>
 1003 |     | <span class='neutral'>     *</span>
 1004 |     | <span class='neutral'>     * - input must fit into 64 bits</span>
 1005 |     | <span class='neutral'>     */</span>
 1006 |     | <span class='neutral'>    function toInt64(int256 value) internal pure returns (int64 downcasted) {</span>
 1007 |     | <span class='neutral'>        downcasted = int64(value);</span>
 1008 |     | <span class='neutral'>        if (downcasted != value) {</span>
 1009 |     | <span class='neutral'>            revert SafeCastOverflowedIntDowncast(64, value);</span>
 1010 |     | <span class='neutral'>        }</span>
 1011 |     | <span class='neutral'>    }</span>
 1012 |     | <span class='neutral'></span>
 1013 |     | <span class='neutral'>    /**</span>
 1014 |     | <span class='neutral'>     * @dev Returns the downcasted int56 from int256, reverting on</span>
 1015 |     | <span class='neutral'>     * overflow (when the input is less than smallest int56 or</span>
 1016 |     | <span class='neutral'>     * greater than largest int56).</span>
 1017 |     | <span class='neutral'>     *</span>
 1018 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int56` operator.</span>
 1019 |     | <span class='neutral'>     *</span>
 1020 |     | <span class='neutral'>     * Requirements:</span>
 1021 |     | <span class='neutral'>     *</span>
 1022 |     | <span class='neutral'>     * - input must fit into 56 bits</span>
 1023 |     | <span class='neutral'>     */</span>
 1024 |     | <span class='neutral'>    function toInt56(int256 value) internal pure returns (int56 downcasted) {</span>
 1025 |     | <span class='neutral'>        downcasted = int56(value);</span>
 1026 |     | <span class='neutral'>        if (downcasted != value) {</span>
 1027 |     | <span class='neutral'>            revert SafeCastOverflowedIntDowncast(56, value);</span>
 1028 |     | <span class='neutral'>        }</span>
 1029 |     | <span class='neutral'>    }</span>
 1030 |     | <span class='neutral'></span>
 1031 |     | <span class='neutral'>    /**</span>
 1032 |     | <span class='neutral'>     * @dev Returns the downcasted int48 from int256, reverting on</span>
 1033 |     | <span class='neutral'>     * overflow (when the input is less than smallest int48 or</span>
 1034 |     | <span class='neutral'>     * greater than largest int48).</span>
 1035 |     | <span class='neutral'>     *</span>
 1036 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int48` operator.</span>
 1037 |     | <span class='neutral'>     *</span>
 1038 |     | <span class='neutral'>     * Requirements:</span>
 1039 |     | <span class='neutral'>     *</span>
 1040 |     | <span class='neutral'>     * - input must fit into 48 bits</span>
 1041 |     | <span class='neutral'>     */</span>
 1042 |     | <span class='neutral'>    function toInt48(int256 value) internal pure returns (int48 downcasted) {</span>
 1043 |     | <span class='neutral'>        downcasted = int48(value);</span>
 1044 |     | <span class='neutral'>        if (downcasted != value) {</span>
 1045 |     | <span class='neutral'>            revert SafeCastOverflowedIntDowncast(48, value);</span>
 1046 |     | <span class='neutral'>        }</span>
 1047 |     | <span class='neutral'>    }</span>
 1048 |     | <span class='neutral'></span>
 1049 |     | <span class='neutral'>    /**</span>
 1050 |     | <span class='neutral'>     * @dev Returns the downcasted int40 from int256, reverting on</span>
 1051 |     | <span class='neutral'>     * overflow (when the input is less than smallest int40 or</span>
 1052 |     | <span class='neutral'>     * greater than largest int40).</span>
 1053 |     | <span class='neutral'>     *</span>
 1054 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int40` operator.</span>
 1055 |     | <span class='neutral'>     *</span>
 1056 |     | <span class='neutral'>     * Requirements:</span>
 1057 |     | <span class='neutral'>     *</span>
 1058 |     | <span class='neutral'>     * - input must fit into 40 bits</span>
 1059 |     | <span class='neutral'>     */</span>
 1060 |     | <span class='neutral'>    function toInt40(int256 value) internal pure returns (int40 downcasted) {</span>
 1061 |     | <span class='neutral'>        downcasted = int40(value);</span>
 1062 |     | <span class='neutral'>        if (downcasted != value) {</span>
 1063 |     | <span class='neutral'>            revert SafeCastOverflowedIntDowncast(40, value);</span>
 1064 |     | <span class='neutral'>        }</span>
 1065 |     | <span class='neutral'>    }</span>
 1066 |     | <span class='neutral'></span>
 1067 |     | <span class='neutral'>    /**</span>
 1068 |     | <span class='neutral'>     * @dev Returns the downcasted int32 from int256, reverting on</span>
 1069 |     | <span class='neutral'>     * overflow (when the input is less than smallest int32 or</span>
 1070 |     | <span class='neutral'>     * greater than largest int32).</span>
 1071 |     | <span class='neutral'>     *</span>
 1072 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int32` operator.</span>
 1073 |     | <span class='neutral'>     *</span>
 1074 |     | <span class='neutral'>     * Requirements:</span>
 1075 |     | <span class='neutral'>     *</span>
 1076 |     | <span class='neutral'>     * - input must fit into 32 bits</span>
 1077 |     | <span class='neutral'>     */</span>
 1078 |     | <span class='neutral'>    function toInt32(int256 value) internal pure returns (int32 downcasted) {</span>
 1079 |     | <span class='neutral'>        downcasted = int32(value);</span>
 1080 |     | <span class='neutral'>        if (downcasted != value) {</span>
 1081 |     | <span class='neutral'>            revert SafeCastOverflowedIntDowncast(32, value);</span>
 1082 |     | <span class='neutral'>        }</span>
 1083 |     | <span class='neutral'>    }</span>
 1084 |     | <span class='neutral'></span>
 1085 |     | <span class='neutral'>    /**</span>
 1086 |     | <span class='neutral'>     * @dev Returns the downcasted int24 from int256, reverting on</span>
 1087 |     | <span class='neutral'>     * overflow (when the input is less than smallest int24 or</span>
 1088 |     | <span class='neutral'>     * greater than largest int24).</span>
 1089 |     | <span class='neutral'>     *</span>
 1090 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int24` operator.</span>
 1091 |     | <span class='neutral'>     *</span>
 1092 |     | <span class='neutral'>     * Requirements:</span>
 1093 |     | <span class='neutral'>     *</span>
 1094 |     | <span class='neutral'>     * - input must fit into 24 bits</span>
 1095 |     | <span class='neutral'>     */</span>
 1096 |     | <span class='neutral'>    function toInt24(int256 value) internal pure returns (int24 downcasted) {</span>
 1097 |     | <span class='neutral'>        downcasted = int24(value);</span>
 1098 |     | <span class='neutral'>        if (downcasted != value) {</span>
 1099 |     | <span class='neutral'>            revert SafeCastOverflowedIntDowncast(24, value);</span>
 1100 |     | <span class='neutral'>        }</span>
 1101 |     | <span class='neutral'>    }</span>
 1102 |     | <span class='neutral'></span>
 1103 |     | <span class='neutral'>    /**</span>
 1104 |     | <span class='neutral'>     * @dev Returns the downcasted int16 from int256, reverting on</span>
 1105 |     | <span class='neutral'>     * overflow (when the input is less than smallest int16 or</span>
 1106 |     | <span class='neutral'>     * greater than largest int16).</span>
 1107 |     | <span class='neutral'>     *</span>
 1108 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int16` operator.</span>
 1109 |     | <span class='neutral'>     *</span>
 1110 |     | <span class='neutral'>     * Requirements:</span>
 1111 |     | <span class='neutral'>     *</span>
 1112 |     | <span class='neutral'>     * - input must fit into 16 bits</span>
 1113 |     | <span class='neutral'>     */</span>
 1114 |     | <span class='neutral'>    function toInt16(int256 value) internal pure returns (int16 downcasted) {</span>
 1115 |     | <span class='neutral'>        downcasted = int16(value);</span>
 1116 |     | <span class='neutral'>        if (downcasted != value) {</span>
 1117 |     | <span class='neutral'>            revert SafeCastOverflowedIntDowncast(16, value);</span>
 1118 |     | <span class='neutral'>        }</span>
 1119 |     | <span class='neutral'>    }</span>
 1120 |     | <span class='neutral'></span>
 1121 |     | <span class='neutral'>    /**</span>
 1122 |     | <span class='neutral'>     * @dev Returns the downcasted int8 from int256, reverting on</span>
 1123 |     | <span class='neutral'>     * overflow (when the input is less than smallest int8 or</span>
 1124 |     | <span class='neutral'>     * greater than largest int8).</span>
 1125 |     | <span class='neutral'>     *</span>
 1126 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int8` operator.</span>
 1127 |     | <span class='neutral'>     *</span>
 1128 |     | <span class='neutral'>     * Requirements:</span>
 1129 |     | <span class='neutral'>     *</span>
 1130 |     | <span class='neutral'>     * - input must fit into 8 bits</span>
 1131 |     | <span class='neutral'>     */</span>
 1132 |     | <span class='neutral'>    function toInt8(int256 value) internal pure returns (int8 downcasted) {</span>
 1133 |     | <span class='neutral'>        downcasted = int8(value);</span>
 1134 |     | <span class='neutral'>        if (downcasted != value) {</span>
 1135 |     | <span class='neutral'>            revert SafeCastOverflowedIntDowncast(8, value);</span>
 1136 |     | <span class='neutral'>        }</span>
 1137 |     | <span class='neutral'>    }</span>
 1138 |     | <span class='neutral'></span>
 1139 |     | <span class='neutral'>    /**</span>
 1140 |     | <span class='neutral'>     * @dev Converts an unsigned uint256 into a signed int256.</span>
 1141 |     | <span class='neutral'>     *</span>
 1142 |     | <span class='neutral'>     * Requirements:</span>
 1143 |     | <span class='neutral'>     *</span>
 1144 |     | <span class='neutral'>     * - input must be less than or equal to maxInt256.</span>
 1145 |     | <span class='neutral'>     */</span>
 1146 |     | <span class='neutral'>    function toInt256(uint256 value) internal pure returns (int256) {</span>
 1147 |     | <span class='neutral'>        // Note: Unsafe cast below is okay because `type(int256).max` is guaranteed to be positive</span>
 1148 |     | <span class='neutral'>        if (value &gt; uint256(type(int256).max)) {</span>
 1149 |     | <span class='neutral'>            revert SafeCastOverflowedUintToInt(value);</span>
 1150 |     | <span class='neutral'>        }</span>
 1151 |     | <span class='neutral'>        return int256(value);</span>
 1152 |     | <span class='neutral'>    }</span>
 1153 |     | <span class='neutral'></span>
 1154 |     | <span class='neutral'>    /**</span>
 1155 |     | <span class='neutral'>     * @dev Cast a boolean (false or true) to a uint256 (0 or 1) with no jump.</span>
 1156 |     | <span class='neutral'>     */</span>
 1157 |     | <span class='neutral'>    function toUint(bool b) internal pure returns (uint256 u) {</span>
 1158 |     | <span class='neutral'>        assembly (&quot;memory-safe&quot;) {</span>
 1159 |     | <span class='neutral'>            u := iszero(iszero(b))</span>
 1160 |     | <span class='neutral'>        }</span>
 1161 |     | <span class='neutral'>    }</span>
 1162 |     | <span class='neutral'>}</span>
 1163 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise1/testToken.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>import &quot;./token.sol&quot;;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'></span>
  7 |     | <span class='unexecuted'>contract testToken is Token {</span>
  8 |     | <span class='neutral'></span>
  9 |     | <span class='neutral'>    // Token  public token;</span>
 10 |     | <span class='neutral'>    // User user;</span>
 11 |     | <span class='unexecuted'>    address user = msg.sender;</span>
 12 |     | <span class='unexecuted'>    constructor (){</span>
 13 |     | <span class='neutral'>        // token = new Token();</span>
 14 |     | <span class='neutral'>        // user  = new User();</span>
 15 |     | <span class='neutral'></span>
 16 |     | <span class='neutral'>        // token.transfer();</span>
 17 |     | <span class='neutral'>        // token.balances(user) = 10000;</span>
 18 |     | <span class='unexecuted'>        balances[user] = 10_000;</span>
 19 |     | <span class='neutral'>    }</span>
 20 |     | <span class='neutral'></span>
 21 |     | <span class='unexecuted'>    function echidna_test_Balances() public view returns(bool) {</span>
 22 |     | <span class='neutral'>        // assert(balances(user) &lt;= 10000);</span>
 23 |     | <span class='unexecuted'>        return balances[user] &lt;= 10000;</span>
 24 |     | <span class='neutral'>    }</span>
 25 |     | <span class='neutral'>}</span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise1/token.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='unexecuted'>contract Ownable {</span>
  5 |     | <span class='unexecuted'>    address public owner = msg.sender;</span>
  6 |     | <span class='neutral'></span>
  7 |     | <span class='neutral'>    modifier onlyOwner() {</span>
  8 |     | <span class='unexecuted'>        require(msg.sender == owner, &quot;Ownable: Caller is not the owner.&quot;);</span>
  9 |     | <span class='neutral'>        _;</span>
 10 |     | <span class='neutral'>    }</span>
 11 |     | <span class='neutral'>}</span>
 12 |     | <span class='neutral'></span>
 13 |     | <span class='unexecuted'>contract Pausable is Ownable {</span>
 14 |     | <span class='neutral'>    bool private _paused;</span>
 15 |     | <span class='neutral'></span>
 16 |     | <span class='unexecuted'>    function paused() public view returns (bool) {</span>
 17 |     | <span class='unexecuted'>        return _paused;</span>
 18 |     | <span class='neutral'>    }</span>
 19 |     | <span class='neutral'></span>
 20 |     | <span class='unexecuted'>    function pause() public onlyOwner {</span>
 21 |     | <span class='unexecuted'>        _paused = true;</span>
 22 |     | <span class='neutral'>    }</span>
 23 |     | <span class='neutral'></span>
 24 |     | <span class='unexecuted'>    function resume() public onlyOwner {</span>
 25 |     | <span class='unexecuted'>        _paused = false;</span>
 26 |     | <span class='neutral'>    }</span>
 27 |     | <span class='neutral'></span>
 28 |     | <span class='neutral'>    modifier whenNotPaused() {</span>
 29 |     | <span class='unexecuted'>        require(!_paused, &quot;Pausable: Contract is paused.&quot;);</span>
 30 |     | <span class='neutral'>        _;</span>
 31 |     | <span class='neutral'>    }</span>
 32 |     | <span class='neutral'>}</span>
 33 |     | <span class='neutral'></span>
 34 |     | <span class='unexecuted'>contract Token is Ownable, Pausable {</span>
 35 |     | <span class='unexecuted'>    mapping(address =&gt; uint256) public balances;</span>
 36 |     | <span class='neutral'></span>
 37 |     | <span class='unexecuted'>    function transfer(address to, uint256 value) public whenNotPaused {</span>
 38 |     | <span class='neutral'>        // unchecked to save gas</span>
 39 |     | <span class='neutral'>        // require(balances[msg.sender] &gt;= value, &quot;Insufficient balance&quot;);</span>
 40 |     | <span class='neutral'>        // @audit just remove the below unchecked one because it is causing and underflow issue or add above require statement</span>
 41 |     | <span class='neutral'>        // unchecked {</span>
 42 |     | <span class='unexecuted'>            balances[msg.sender] -= value;</span>
 43 |     | <span class='unexecuted'>            balances[to] += value;</span>
 44 |     | <span class='neutral'>        // }</span>
 45 |     | <span class='neutral'>    }</span>
 46 |     | <span class='neutral'>}</span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise2/testToken.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>import &quot;./token.sol&quot;;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>// pause i called at deployment</span>
  7 |     | <span class='neutral'>// Remove Ownership</span>
  8 |     | <span class='neutral'></span>
  9 |     | <span class='neutral'></span>
 10 |     | <span class='unexecuted'>contract testToken is Token {</span>
 11 |     | <span class='neutral'></span>
 12 |     | <span class='neutral'>    // address constant USER_1 = 0x9876543210987654321098765432109876543210;</span>
 13 |     | <span class='unexecuted'>    constructor () {</span>
 14 |     | <span class='unexecuted'>        paused();</span>
 15 |     | <span class='unexecuted'>        owner = address(0);</span>
 16 |     | <span class='neutral'></span>
 17 |     | <span class='neutral'>    }</span>
 18 |     | <span class='neutral'></span>
 19 |     | <span class='neutral'>    // function echidna_test_cannot_be_unpaused() public view returns(bool) {</span>
 20 |     | <span class='neutral'>    //     return balances[USER_1] == 0;</span>
 21 |     | <span class='neutral'>    // }</span>
 22 |     | <span class='neutral'></span>
 23 |     | <span class='unexecuted'>    function echidna_unpause() public view returns(bool){</span>
 24 |     | <span class='unexecuted'>        return (paused() == true);</span>
 25 |     | <span class='neutral'>    }</span>
 26 |     | <span class='neutral'>}</span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise2/token.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='unexecuted'>contract Ownable {</span>
  5 |     | <span class='unexecuted'>    address public owner = msg.sender;</span>
  6 |     | <span class='neutral'>    // @audit To fix the bug we should only remove the below function  </span>
  7 |     | <span class='neutral'></span>
  8 |     | <span class='neutral'></span>
  9 |     | <span class='neutral'>    // function Owner() public {</span>
 10 |     | <span class='neutral'>    //     owner = msg.sender;</span>
 11 |     | <span class='neutral'>    // }</span>
 12 |     | <span class='neutral'></span>
 13 |     | <span class='neutral'>    modifier onlyOwner() {</span>
 14 |     | <span class='unexecuted'>        require(owner == msg.sender);</span>
 15 |     | <span class='neutral'>        _;</span>
 16 |     | <span class='neutral'>    }</span>
 17 |     | <span class='neutral'>}</span>
 18 |     | <span class='neutral'></span>
 19 |     | <span class='unexecuted'>contract Pausable is Ownable {</span>
 20 |     | <span class='neutral'>    bool private _paused;</span>
 21 |     | <span class='neutral'></span>
 22 |     | <span class='unexecuted'>    function paused() public view returns (bool) {</span>
 23 |     | <span class='unexecuted'>        return _paused;</span>
 24 |     | <span class='neutral'>    }</span>
 25 |     | <span class='neutral'></span>
 26 |     | <span class='unexecuted'>    function pause() public onlyOwner {</span>
 27 |     | <span class='unexecuted'>        _paused = true;</span>
 28 |     | <span class='neutral'>    }</span>
 29 |     | <span class='neutral'></span>
 30 |     | <span class='unexecuted'>    function resume() public onlyOwner {</span>
 31 |     | <span class='unexecuted'>        _paused = false;</span>
 32 |     | <span class='neutral'>    }</span>
 33 |     | <span class='neutral'></span>
 34 |     | <span class='neutral'>    modifier whenNotPaused() {</span>
 35 |     | <span class='unexecuted'>        require(!_paused, &quot;Pausable: Contract is paused.&quot;);</span>
 36 |     | <span class='neutral'>        _;</span>
 37 |     | <span class='neutral'>    }</span>
 38 |     | <span class='neutral'>}</span>
 39 |     | <span class='neutral'></span>
 40 |     | <span class='unexecuted'>contract Token is Ownable, Pausable {</span>
 41 |     | <span class='unexecuted'>    mapping(address =&gt; uint256) public balances;</span>
 42 |     | <span class='neutral'></span>
 43 |     | <span class='unexecuted'>    function transfer(address to, uint256 value) public whenNotPaused {</span>
 44 |     | <span class='unexecuted'>        balances[msg.sender] -= value;</span>
 45 |     | <span class='unexecuted'>        balances[to] += value;</span>
 46 |     | <span class='neutral'>    }</span>
 47 |     | <span class='neutral'>}</span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise3/mintable.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>import &quot;./token.sol&quot;;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='unexecuted'>contract MintableToken is Token {</span>
  7 |     | <span class='unexecuted'>    int256 public totalMinted;</span>
  8 |     | <span class='unexecuted'>    int256 public totalMintable;</span>
  9 |     | <span class='neutral'></span>
 10 |     | <span class='unexecuted'>    constructor(int256 totalMintable_) {</span>
 11 |     | <span class='unexecuted'>        totalMintable = totalMintable_;</span>
 12 |     | <span class='neutral'>    }</span>
 13 |     | <span class='neutral'></span>
 14 |     | <span class='neutral'>    //@audit To prevent this type of bug, you must ensure that value is always within the valid range of int256 before performing the cast. Add an explicit check for value:</span>
 15 |     | <span class='neutral'></span>
 16 |     | <span class='neutral'>    // function mint(uint256 value) public onlyOwner {</span>
 17 |     | <span class='neutral'>    //     require(value &lt;= uint256(type(int256).max), &quot;Value exceeds int256 range&quot;);</span>
 18 |     | <span class='neutral'>    //     require(int256(value) + totalMinted &lt;= totalMintable, &quot;Mint exceeds total mintable tokens&quot;);</span>
 19 |     | <span class='neutral'></span>
 20 |     | <span class='neutral'>    //     totalMinted += int256(value);</span>
 21 |     | <span class='neutral'>    //     balances[msg.sender] += value;</span>
 22 |     | <span class='neutral'>    // }</span>
 23 |     | <span class='neutral'></span>
 24 |     | <span class='unexecuted'>    function mint(uint256 value) public onlyOwner {</span>
 25 |     | <span class='unexecuted'>        require(int256(value) + totalMinted &lt; totalMintable);</span>
 26 |     | <span class='neutral'>        // require(value &lt;=  uint256(type(int256).max) , &quot;Value more than the int256 &quot;);</span>
 27 |     | <span class='unexecuted'>        totalMinted += int256(value);</span>
 28 |     | <span class='neutral'></span>
 29 |     | <span class='unexecuted'>        balances[msg.sender] += value;</span>
 30 |     | <span class='neutral'>    }</span>
 31 |     | <span class='neutral'></span>
 32 |     | <span class='neutral'>}</span>
 33 |     | <span class='neutral'>    // @audit i think their are two invariant here</span>
 34 |     | <span class='neutral'>    // 1. will be that the balances of the mag.sender should never greater than totalMinted</span>
 35 |     | <span class='neutral'>    // 2. will be that the totalMintable &gt; totalMinted </span>
 36 |     | <span class='neutral'>    // 3. See if the user can mint more that what is the limit </span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise3/testToken.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'></span>
  5 |     | <span class='neutral'>import &quot;./mintable.sol&quot;;</span>
  6 |     | <span class='neutral'></span>
  7 |     | <span class='unexecuted'>contract testToken is MintableToken {</span>
  8 |     | <span class='neutral'></span>
  9 |     | <span class='neutral'>    // Create a scenario where echidna (tx.origin) becomes the owner of the contract at construction, and totalMintable is set to 10,000. Remember that Echidna needs a constructor without arguments.</span>
 10 |     | <span class='neutral'>    // Add a property to check if echidna can mint more than 10,000 tokens.</span>
 11 |     | <span class='neutral'>    // Once Echidna finds the bug, fix the issue, and re-try your property with Echidna.</span>
 12 |     | <span class='neutral'></span>
 13 |     | <span class='neutral'>    // @audit i think their are two invariant here</span>
 14 |     | <span class='neutral'>    // 1. will be that the balances of the msg.sender should never greater than totalMinted</span>
 15 |     | <span class='neutral'>    // 2. will be that the totalMintable &gt; totalMinted </span>
 16 |     | <span class='neutral'>    // 3. See if the user can mint more that what is the limit </span>
 17 |     | <span class='neutral'></span>
 18 |     | <span class='unexecuted'>    address user = msg.sender;</span>
 19 |     | <span class='neutral'></span>
 20 |     | <span class='unexecuted'>    constructor () MintableToken(10000) {</span>
 21 |     | <span class='unexecuted'>        owner = user;</span>
 22 |     | <span class='neutral'>    }</span>
 23 |     | <span class='neutral'></span>
 24 |     | <span class='unexecuted'>    function echidna_user_can_mint_more_than_totalMintable() public view returns(bool) {</span>
 25 |     | <span class='neutral'>        // return totalMinted &lt; 10000;</span>
 26 |     | <span class='unexecuted'>        return balances[msg.sender] &lt;= 10_000;</span>
 27 |     | <span class='neutral'>    }</span>
 28 |     | <span class='neutral'>    // Below test could have been also performed bu the thing is than you should change the code in the mintable.sol</span>
 29 |     | <span class='neutral'>    // at line 29 --  balances[msg.sender] += value; to balances[owner] += value;</span>
 30 |     | <span class='neutral'>    // function echidna_bal_ofuser_not_greater_than_totalMinted() public view returns(bool){</span>
 31 |     | <span class='neutral'>    //     return int256(balances[owner]) == totalMinted;</span>
 32 |     | <span class='neutral'>    //     // return totalMinted &lt;= totalMintable;</span>
 33 |     | <span class='neutral'>    // }</span>
 34 |     | <span class='neutral'>}</span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise3/token.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>/// @notice The issues from exercise 1 and 2 are fixed.</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='unexecuted'>contract Ownable {</span>
  7 |     | <span class='unexecuted'>    address public owner = msg.sender;</span>
  8 |     | <span class='neutral'></span>
  9 |     | <span class='neutral'>    modifier onlyOwner() {</span>
 10 |     | <span class='unexecuted'>        require(msg.sender == owner, &quot;Ownable: Caller is not the owner.&quot;);</span>
 11 |     | <span class='neutral'>        _;</span>
 12 |     | <span class='neutral'>    }</span>
 13 |     | <span class='neutral'>}</span>
 14 |     | <span class='neutral'></span>
 15 |     | <span class='unexecuted'>contract Pausable is Ownable {</span>
 16 |     | <span class='neutral'>    bool private _paused;</span>
 17 |     | <span class='neutral'></span>
 18 |     | <span class='unexecuted'>    function paused() public view returns (bool) {</span>
 19 |     | <span class='unexecuted'>        return _paused;</span>
 20 |     | <span class='neutral'>    }</span>
 21 |     | <span class='neutral'></span>
 22 |     | <span class='unexecuted'>    function pause() public onlyOwner {</span>
 23 |     | <span class='unexecuted'>        _paused = true;</span>
 24 |     | <span class='neutral'>    }</span>
 25 |     | <span class='neutral'></span>
 26 |     | <span class='unexecuted'>    function resume() public onlyOwner {</span>
 27 |     | <span class='unexecuted'>        _paused = false;</span>
 28 |     | <span class='neutral'>    }</span>
 29 |     | <span class='neutral'></span>
 30 |     | <span class='neutral'>    modifier whenNotPaused() {</span>
 31 |     | <span class='unexecuted'>        require(!_paused, &quot;Pausable: Contract is paused.&quot;);</span>
 32 |     | <span class='neutral'>        _;</span>
 33 |     | <span class='neutral'>    }</span>
 34 |     | <span class='neutral'>}</span>
 35 |     | <span class='neutral'></span>
 36 |     | <span class='unexecuted'>contract Token is Ownable, Pausable {</span>
 37 |     | <span class='unexecuted'>    mapping(address =&gt; uint256) public balances;</span>
 38 |     | <span class='neutral'></span>
 39 |     | <span class='unexecuted'>    function transfer(address to, uint256 value) public whenNotPaused {</span>
 40 |     | <span class='unexecuted'>        balances[msg.sender] -= value;</span>
 41 |     | <span class='unexecuted'>        balances[to] += value;</span>
 42 |     | <span class='neutral'>    }</span>
 43 |     | <span class='neutral'>}</span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise4/testToken.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>import &quot;./token.sol&quot;;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='unexecuted'>contract testToken is Token {</span>
  7 |     | <span class='neutral'>    </span>
  8 |     | <span class='unexecuted'>    function transfer(address to, uint256 value) public override{</span>
  9 |     | <span class='unexecuted'>        uint256 intialBalOfSender = balances[msg.sender];</span>
 10 |     | <span class='unexecuted'>        uint256 intialBalOfReciever = balances[to];</span>
 11 |     | <span class='unexecuted'>        super.transfer(to,value);</span>
 12 |     | <span class='unexecuted'>        assert(intialBalOfSender &gt;= balances[msg.sender]);</span>
 13 |     | <span class='unexecuted'>        assert(intialBalOfReciever &lt;= balances[to]);</span>
 14 |     | <span class='neutral'>    }</span>
 15 |     | <span class='neutral'>}</span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise4/token.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='unexecuted'>contract Ownable {</span>
  5 |     | <span class='unexecuted'>    address public owner = msg.sender;</span>
  6 |     | <span class='neutral'></span>
  7 |     | <span class='unexecuted'>    function transferOwnership(address newOwner) public onlyOwner {</span>
  8 |     | <span class='unexecuted'>        owner = newOwner;</span>
  9 |     | <span class='neutral'>    }</span>
 10 |     | <span class='neutral'></span>
 11 |     | <span class='neutral'>    modifier onlyOwner() {</span>
 12 |     | <span class='unexecuted'>        require(msg.sender == owner, &quot;Ownable: Caller is not the owner.&quot;);</span>
 13 |     | <span class='neutral'>        _;</span>
 14 |     | <span class='neutral'>    }</span>
 15 |     | <span class='neutral'>}</span>
 16 |     | <span class='neutral'></span>
 17 |     | <span class='unexecuted'>contract Pausable is Ownable {</span>
 18 |     | <span class='neutral'>    bool private _paused;</span>
 19 |     | <span class='neutral'></span>
 20 |     | <span class='unexecuted'>    function paused() public view returns (bool) {</span>
 21 |     | <span class='unexecuted'>        return _paused;</span>
 22 |     | <span class='neutral'>    }</span>
 23 |     | <span class='neutral'></span>
 24 |     | <span class='unexecuted'>    function pause() public onlyOwner {</span>
 25 |     | <span class='unexecuted'>        _paused = true;</span>
 26 |     | <span class='neutral'>    }</span>
 27 |     | <span class='neutral'></span>
 28 |     | <span class='unexecuted'>    function resume() public onlyOwner {</span>
 29 |     | <span class='unexecuted'>        _paused = false;</span>
 30 |     | <span class='neutral'>    }</span>
 31 |     | <span class='neutral'></span>
 32 |     | <span class='neutral'>    modifier whenNotPaused() {</span>
 33 |     | <span class='unexecuted'>        require(!_paused, &quot;Pausable: Contract is paused.&quot;);</span>
 34 |     | <span class='neutral'>        _;</span>
 35 |     | <span class='neutral'>    }</span>
 36 |     | <span class='neutral'>}</span>
 37 |     | <span class='neutral'></span>
 38 |     | <span class='unexecuted'>contract Token is Ownable, Pausable {</span>
 39 |     | <span class='neutral'></span>
 40 |     | <span class='unexecuted'>    mapping(address =&gt; uint256) public balances;</span>
 41 |     | <span class='neutral'></span>
 42 |     | <span class='unexecuted'>    function transfer(address to, uint256 value) public virtual whenNotPaused {</span>
 43 |     | <span class='neutral'>        // require(balances[msg.sender] &gt;= value ,&quot;Insuffcient balance&quot;) ;</span>
 44 |     | <span class='neutral'>        // @audit just remove the unchecked keyword or add reuiqre statement above to check underflow and overflow </span>
 45 |     | <span class='neutral'>        // unchecked to save gas</span>
 46 |     | <span class='neutral'>        unchecked {</span>
 47 |     | <span class='unexecuted'>            balances[msg.sender] -= value;</span>
 48 |     | <span class='unexecuted'>            balances[to] += value;</span>
 49 |     | <span class='neutral'>        }</span>
 50 |     | <span class='neutral'>    }</span>
 51 |     | <span class='neutral'>}</span>
 52 |     | <span class='neutral'></span>
 53 |     | <span class='neutral'>// @audit here there could be underflow issue for line 44,45</span>
 54 |     | <span class='neutral'>// msg.sender must have its initial balance or less.</span>
 55 |     | <span class='neutral'>// to must have its initial balance or more.</span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise5/EchidnaNaiveReciever.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'></span>
  3 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  4 |     | <span class='neutral'></span>
  5 |     | <span class='neutral'>import &quot;./FlashLoanReceiver.sol&quot;;</span>
  6 |     | <span class='neutral'>import &quot;./NaiveReceiverLenderPool.sol&quot;;</span>
  7 |     | <span class='neutral'></span>
  8 |     | <span class='unexecuted'>contract EchidnaNaiveReciever {</span>
  9 |     | <span class='neutral'></span>
 10 |     | <span class='neutral'>    NaiveReceiverLenderPool  naiveReceiverLenderPool;</span>
 11 |     | <span class='neutral'>    FlashLoanReceiver  flashLoanReceiver ;</span>
 12 |     | <span class='neutral'></span>
 13 |     | <span class='unexecuted'>    uint256 public poolBalance = 1000 ether;</span>
 14 |     | <span class='unexecuted'>    uint256 public userBalance = 10 ether;</span>
 15 |     | <span class='neutral'></span>
 16 |     | <span class='neutral'>    // the lender pool should have 1000 eth of bal </span>
 17 |     | <span class='neutral'>    // The flashloan reciever also has a bal</span>
 18 |     | <span class='neutral'>    constructor() payable {</span>
 19 |     | <span class='unexecuted'>        naiveReceiverLenderPool = new NaiveReceiverLenderPool();</span>
 20 |     | <span class='unexecuted'>        payable(address(naiveReceiverLenderPool)).transfer(poolBalance);</span>
 21 |     | <span class='unexecuted'>        flashLoanReceiver = new FlashLoanReceiver(payable(address(naiveReceiverLenderPool)));</span>
 22 |     | <span class='neutral'></span>
 23 |     | <span class='neutral'>        // address(this).balance = 2000 ether;</span>
 24 |     | <span class='neutral'>        // naiveReceiverLenderPool.receive(poolBalance);</span>
 25 |     | <span class='neutral'>        // (bool success,) = payable(address(naiveReceiverLenderPool)).call{value: poolBalance}(&quot;&quot;);</span>
 26 |     | <span class='neutral'>        // require(success, &quot;Failed to fund the pool&quot;);</span>
 27 |     | <span class='neutral'></span>
 28 |     | <span class='neutral'>        // (success, ) = payable(address(flashLoanReceiver)).call{value: userBalance}(&quot;&quot;);</span>
 29 |     | <span class='neutral'>        // require(success, &quot;Failed to fund the flash loan receiver&quot;);</span>
 30 |     | <span class='neutral'></span>
 31 |     | <span class='neutral'>        </span>
 32 |     | <span class='unexecuted'>        payable(address(flashLoanReceiver)).transfer(userBalance);</span>
 33 |     | <span class='neutral'></span>
 34 |     | <span class='neutral'>    }</span>
 35 |     | <span class='neutral'></span>
 36 |     | <span class='neutral'>    // function echidna_test_flashloan_fail() public returns(bool) {</span>
 37 |     | <span class='neutral'>    //     naiveReceiverLenderPool.flashLoan(address(flashLoanReceiver),10 ether);</span>
 38 |     | <span class='neutral'>    //     return true;</span>
 39 |     | <span class='neutral'>    // }</span>
 40 |     | <span class='neutral'></span>
 41 |     | <span class='unexecuted'>    function echidna_test_flashloan_fail_dynamic() public view returns(bool) {</span>
 42 |     | <span class='neutral'>        // naiveReceiverLenderPool.flashLoan(address(flashLoanReceiver),amount);</span>
 43 |     | <span class='neutral'>        </span>
 44 |     | <span class='unexecuted'>        return address(flashLoanReceiver).balance &gt;= 10 ether;</span>
 45 |     | <span class='neutral'>    }</span>
 46 |     | <span class='neutral'></span>
 47 |     | <span class='neutral'>}</span>
 48 |     | <span class='neutral'></span>
 49 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise5/FlashLoanReceiver.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'></span>
  3 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  4 |     | <span class='neutral'></span>
  5 |     | <span class='neutral'>import &quot;@openzeppelin/contracts/utils/Address.sol&quot;;</span>
  6 |     | <span class='neutral'></span>
  7 |     | <span class='neutral'>/**</span>
  8 |     | <span class='neutral'> * @title FlashLoanReceiver</span>
  9 |     | <span class='neutral'> * @author Damn Vulnerable DeFi (https://damnvulnerabledefi.xyz)</span>
 10 |     | <span class='neutral'> */</span>
 11 |     | <span class='unexecuted'>contract FlashLoanReceiver {</span>
 12 |     | <span class='neutral'>    using Address for address payable;</span>
 13 |     | <span class='neutral'></span>
 14 |     | <span class='neutral'>    address payable private pool;</span>
 15 |     | <span class='neutral'></span>
 16 |     | <span class='unexecuted'>    constructor(address payable poolAddress) {</span>
 17 |     | <span class='unexecuted'>        pool = poolAddress;</span>
 18 |     | <span class='neutral'>    }</span>
 19 |     | <span class='neutral'></span>
 20 |     | <span class='neutral'>    // Function called by the pool during flash loan</span>
 21 |     | <span class='unexecuted'>    function receiveEther(uint256 fee) public payable {</span>
 22 |     | <span class='unexecuted'>        require(msg.sender == pool, &quot;Sender must be pool&quot;);</span>
 23 |     | <span class='neutral'></span>
 24 |     | <span class='unexecuted'>        uint256 amountToBeRepaid = msg.value + fee;</span>
 25 |     | <span class='neutral'></span>
 26 |     | <span class='unexecuted'>        require(address(this).balance &gt;= amountToBeRepaid, &quot;Cannot borrow that much&quot;);</span>
 27 |     | <span class='neutral'>        </span>
 28 |     | <span class='unexecuted'>        _executeActionDuringFlashLoan();</span>
 29 |     | <span class='neutral'>        </span>
 30 |     | <span class='neutral'>        // Return funds to pool</span>
 31 |     | <span class='unexecuted'>        pool.sendValue(amountToBeRepaid);</span>
 32 |     | <span class='neutral'>    }</span>
 33 |     | <span class='neutral'></span>
 34 |     | <span class='neutral'>    // Internal function where the funds received are used</span>
 35 |     | <span class='unexecuted'>    function _executeActionDuringFlashLoan() internal { }</span>
 36 |     | <span class='neutral'></span>
 37 |     | <span class='neutral'>    // Allow deposits of ETH</span>
 38 |     | <span class='neutral'>    receive () external payable {}</span>
 39 |     | <span class='neutral'>}</span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise5/NaiveReceiverLenderPool.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>import &quot;@openzeppelin/contracts/utils/ReentrancyGuard.sol&quot;;</span>
  5 |     | <span class='neutral'>import &quot;@openzeppelin/contracts/utils/Address.sol&quot;;</span>
  6 |     | <span class='neutral'></span>
  7 |     | <span class='neutral'>/**</span>
  8 |     | <span class='neutral'> * @title NaiveReceiverLenderPool</span>
  9 |     | <span class='neutral'> * @author Damn Vulnerable DeFi (https://damnvulnerabledefi.xyz)</span>
 10 |     | <span class='neutral'> */</span>
 11 |     | <span class='unexecuted'>contract NaiveReceiverLenderPool is ReentrancyGuard {</span>
 12 |     | <span class='neutral'></span>
 13 |     | <span class='neutral'>    using Address for address;</span>
 14 |     | <span class='neutral'></span>
 15 |     | <span class='unexecuted'>    uint256 private constant FIXED_FEE = 1 ether; // not the cheapest flash loan</span>
 16 |     | <span class='neutral'></span>
 17 |     | <span class='unexecuted'>    function fixedFee() external pure returns (uint256) {</span>
 18 |     | <span class='unexecuted'>        return FIXED_FEE;</span>
 19 |     | <span class='neutral'>    }</span>
 20 |     | <span class='neutral'></span>
 21 |     | <span class='unexecuted'>    function flashLoan(address borrower, uint256 borrowAmount) external nonReentrant {</span>
 22 |     | <span class='neutral'></span>
 23 |     | <span class='unexecuted'>        uint256 balanceBefore = address(this).balance;</span>
 24 |     | <span class='unexecuted'>        require(balanceBefore &gt;= borrowAmount, &quot;Not enough ETH in pool&quot;);</span>
 25 |     | <span class='neutral'></span>
 26 |     | <span class='neutral'></span>
 27 |     | <span class='unexecuted'>        require(borrower.isContract(), &quot;Borrower must be a deployed contract&quot;);</span>
 28 |     | <span class='neutral'>        // Transfer ETH and handle control to receiver</span>
 29 |     | <span class='unexecuted'>        borrower.functionCallWithValue(</span>
 30 |     | <span class='unexecuted'>            abi.encodeWithSignature(</span>
 31 |     | <span class='neutral'>                &quot;receiveEther(uint256)&quot;,</span>
 32 |     | <span class='neutral'>                FIXED_FEE</span>
 33 |     | <span class='neutral'>            ),</span>
 34 |     | <span class='unexecuted'>            borrowAmount</span>
 35 |     | <span class='neutral'>        );</span>
 36 |     | <span class='neutral'>        </span>
 37 |     | <span class='unexecuted'>        require(</span>
 38 |     | <span class='unexecuted'>            address(this).balance &gt;= balanceBefore + FIXED_FEE,</span>
 39 |     | <span class='neutral'>            &quot;Flash loan hasn&#39;t been paid back&quot;</span>
 40 |     | <span class='neutral'>        );</span>
 41 |     | <span class='neutral'>    }</span>
 42 |     | <span class='neutral'></span>
 43 |     | <span class='neutral'>    // Allow deposits of ETH</span>
 44 |     | <span class='neutral'>    receive () external payable {}</span>
 45 |     | <span class='neutral'>}</span>
 46 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise6/CustomERC20.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'></span>
  3 |     | <span class='neutral'>pragma solidity ^0.8.20;</span>
  4 |     | <span class='neutral'></span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>import {ERC20} from &quot;@openzeppelin/contracts/token/ERC20/ERC20.sol&quot;;</span>
  7 |     | <span class='neutral'></span>
  8 | *r  | <span class='executed'>contract CustomERC20 is ERC20   {</span>
  9 |     | <span class='neutral'></span>
 10 | *   | <span class='executed'>    constructor() ERC20(&quot;damn&quot;,&quot;dd&quot;) {</span>
 11 | *   | <span class='executed'>        _mint(msg.sender,type(uint256).max);</span>
 12 |     | <span class='neutral'>    }</span>
 13 |     | <span class='neutral'>}</span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise6/DamnValuableToken.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'></span>
  3 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  4 |     | <span class='neutral'></span>
  5 |     | <span class='neutral'>import &quot;@openzeppelin/contracts/token/ERC20/ERC20.sol&quot;;</span>
  6 |     | <span class='neutral'></span>
  7 |     | <span class='neutral'>/**</span>
  8 |     | <span class='neutral'> * @title DamnValuableToken</span>
  9 |     | <span class='neutral'> * @author Damn Vulnerable DeFi (https://damnvulnerabledefi.xyz)</span>
 10 |     | <span class='neutral'> */</span>
 11 | *r  | <span class='executed'>contract DamnValuableToken is ERC20 {</span>
 12 |     | <span class='neutral'></span>
 13 |     | <span class='neutral'>    // Decimals are set to 18 by default in `ERC20`</span>
 14 | *   | <span class='executed'>    constructor() ERC20(&quot;DamnValuableToken&quot;, &quot;DVT&quot;) {</span>
 15 | *   | <span class='executed'>        _mint(msg.sender, type(uint256).max);</span>
 16 |     | <span class='neutral'>    }</span>
 17 |     | <span class='neutral'>}</span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise6/EchidnaReciever.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'></span>
  3 |     | <span class='neutral'>pragma solidity ^0.8.20;</span>
  4 |     | <span class='neutral'></span>
  5 |     | <span class='neutral'>import &quot;./ReceiverUnstoppable.sol&quot;;</span>
  6 |     | <span class='neutral'>// import {ERC20} from &quot;@openzeppelin/contracts/token/ERC20/ERC20.sol&quot;;</span>
  7 |     | <span class='neutral'>import &quot;./DamnValuableToken.sol&quot;;</span>
  8 |     | <span class='neutral'>import &quot;./UnstoppableLender.sol&quot;;</span>
  9 |     | <span class='neutral'></span>
 10 |     | <span class='neutral'></span>
 11 |     | <span class='unexecuted'>contract EchidnaReciever {</span>
 12 |     | <span class='neutral'></span>
 13 |     | <span class='unexecuted'>    address setOwner = msg.sender;</span>
 14 |     | <span class='unexecuted'>    IERC20 public damnValuableToken;</span>
 15 |     | <span class='unexecuted'>    ReceiverUnstoppable public receiverUnstoppable;</span>
 16 |     | <span class='unexecuted'>    UnstoppableLender public unstoppableLender;</span>
 17 |     | <span class='unexecuted'>    uint256 public INITIAL_BAL_In_POOL = 100000;</span>
 18 |     | <span class='unexecuted'>    uint256 public BAL_OF_USER = 100;</span>
 19 |     | <span class='neutral'>    uint256 balanceBefore ;</span>
 20 |     | <span class='neutral'></span>
 21 |     | <span class='unexecuted'>    constructor(){</span>
 22 |     | <span class='unexecuted'>        damnValuableToken = new DamnValuableToken();</span>
 23 |     | <span class='unexecuted'>        unstoppableLender = new UnstoppableLender(address(damnValuableToken));</span>
 24 |     | <span class='unexecuted'>        receiverUnstoppable = new ReceiverUnstoppable(address(unstoppableLender));</span>
 25 |     | <span class='neutral'></span>
 26 |     | <span class='unexecuted'>        damnValuableToken.approve(address(unstoppableLender), INITIAL_BAL_In_POOL);</span>
 27 |     | <span class='unexecuted'>        unstoppableLender.depositTokens(INITIAL_BAL_In_POOL);</span>
 28 |     | <span class='neutral'></span>
 29 |     | <span class='unexecuted'>        damnValuableToken.transfer(setOwner,BAL_OF_USER);</span>
 30 |     | <span class='unexecuted'>        balanceBefore = damnValuableToken.balanceOf(address(unstoppableLender));</span>
 31 |     | <span class='neutral'>    }</span>
 32 |     | <span class='neutral'></span>
 33 |     | <span class='unexecuted'>    function receiveTokens(address tokenAddress, uint256 amount) external {</span>
 34 |     | <span class='unexecuted'>        require(msg.sender == address(unstoppableLender), &quot;Sender must be pool&quot;);</span>
 35 |     | <span class='neutral'>        // Return all tokens to the pool</span>
 36 |     | <span class='unexecuted'>        require(</span>
 37 |     | <span class='unexecuted'>            IERC20(tokenAddress).transfer(msg.sender, amount),</span>
 38 |     | <span class='neutral'>            &quot;Transfer of tokens failed&quot;</span>
 39 |     | <span class='neutral'>        );</span>
 40 |     | <span class='neutral'>    }</span>
 41 |     | <span class='neutral'></span>
 42 |     | <span class='unexecuted'>    function echidna_poolBal_is_always_equal_to_intialBal() public  returns(bool)  {</span>
 43 |     | <span class='neutral'>        // assert(unstoppableLender.poolBalance() == balanceBefore);</span>
 44 |     | <span class='neutral'>        // require(msg.sender == )</span>
 45 |     | <span class='unexecuted'>        unstoppableLender.flashLoan(10);</span>
 46 |     | <span class='neutral'>        // receiverUnstoppable.executeFlashLoan(10);</span>
 47 |     | <span class='unexecuted'>        return true;</span>
 48 |     | <span class='neutral'>    }</span>
 49 |     | <span class='neutral'></span>
 50 |     | <span class='neutral'></span>
 51 |     | <span class='neutral'></span>
 52 |     | <span class='neutral'></span>
 53 |     | <span class='neutral'>}</span>
 54 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise6/ReceiverUnstoppable.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'></span>
  3 |     | <span class='neutral'>pragma solidity ^0.8.17;</span>
  4 |     | <span class='neutral'></span>
  5 |     | <span class='neutral'>import &quot;./UnstoppableLender.sol&quot;;</span>
  6 |     | <span class='neutral'>import {IERC20} from &quot;@openzeppelin/contracts/token/ERC20/IERC20.sol&quot;;</span>
  7 |     | <span class='neutral'></span>
  8 |     | <span class='neutral'>/**</span>
  9 |     | <span class='neutral'> * @title ReceiverUnstoppable</span>
 10 |     | <span class='neutral'> * @author Damn Vulnerable DeFi (https://damnvulnerabledefi.xyz)</span>
 11 |     | <span class='neutral'> */</span>
 12 |     | <span class='unexecuted'>contract ReceiverUnstoppable {</span>
 13 |     | <span class='neutral'></span>
 14 |     | <span class='neutral'>    UnstoppableLender private immutable pool;</span>
 15 |     | <span class='neutral'>    address private immutable owner;</span>
 16 |     | <span class='neutral'></span>
 17 |     | <span class='unexecuted'>    constructor(address poolAddress) {</span>
 18 |     | <span class='unexecuted'>        pool = UnstoppableLender(poolAddress);</span>
 19 |     | <span class='unexecuted'>        owner = msg.sender;</span>
 20 |     | <span class='neutral'>    }</span>
 21 |     | <span class='neutral'></span>
 22 |     | <span class='neutral'>    // Pool will call this function during the flash loan</span>
 23 |     | <span class='unexecuted'>    function receiveTokens(address tokenAddress, uint256 amount) external {</span>
 24 |     | <span class='unexecuted'>        require(msg.sender == address(pool), &quot;Sender must be pool&quot;);</span>
 25 |     | <span class='neutral'>        // Return all tokens to the pool</span>
 26 |     | <span class='unexecuted'>        require(IERC20(tokenAddress).transfer(msg.sender, amount), &quot;Transfer of tokens failed&quot;);</span>
 27 |     | <span class='neutral'>    }</span>
 28 |     | <span class='neutral'></span>
 29 |     | <span class='unexecuted'>    function executeFlashLoan(uint256 amount) external {</span>
 30 |     | <span class='unexecuted'>        require(msg.sender == owner, &quot;Only owner can execute flash loan&quot;);</span>
 31 |     | <span class='unexecuted'>        pool.flashLoan(amount);</span>
 32 |     | <span class='neutral'>    }</span>
 33 |     | <span class='neutral'>}</span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise6/UnstoppableLender.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'></span>
  3 |     | <span class='neutral'>pragma solidity ^0.8.20;</span>
  4 |     | <span class='neutral'></span>
  5 |     | <span class='neutral'>import {IERC20} from &quot;@openzeppelin/contracts/token/ERC20/IERC20.sol&quot;;</span>
  6 |     | <span class='neutral'>import {ReentrancyGuard} from &quot;@openzeppelin/contracts/utils/ReentrancyGuard.sol&quot;;</span>
  7 |     | <span class='neutral'></span>
  8 |     | <span class='neutral'>interface IReceiver {</span>
  9 |     | <span class='neutral'>    function receiveTokens(address tokenAddress, uint256 amount) external;</span>
 10 |     | <span class='neutral'>}</span>
 11 |     | <span class='neutral'></span>
 12 |     | <span class='neutral'>/**</span>
 13 |     | <span class='neutral'> * @title UnstoppableLender</span>
 14 |     | <span class='neutral'> * @author Damn Vulnerable DeFi (https://damnvulnerabledefi.xyz)</span>
 15 |     | <span class='neutral'> */</span>
 16 |     | <span class='unexecuted'>contract UnstoppableLender is ReentrancyGuard {</span>
 17 |     | <span class='neutral'></span>
 18 |     | <span class='unexecuted'>    IERC20 public immutable damnValuableToken;</span>
 19 |     | <span class='unexecuted'>    uint256 public poolBalance;</span>
 20 |     | <span class='neutral'></span>
 21 |     | <span class='unexecuted'>    constructor(address tokenAddress) {</span>
 22 |     | <span class='unexecuted'>        require(tokenAddress != address(0), &quot;Token address cannot be zero&quot;);</span>
 23 |     | <span class='unexecuted'>        damnValuableToken = IERC20(tokenAddress);</span>
 24 |     | <span class='neutral'>    }</span>
 25 |     | <span class='neutral'></span>
 26 |     | <span class='unexecuted'>    function depositTokens(uint256 amount) external nonReentrant {</span>
 27 |     | <span class='unexecuted'>        require(amount &gt; 0, &quot;Must deposit at least one token&quot;);</span>
 28 |     | <span class='neutral'>        // Transfer token from sender. Sender must have first approved them.</span>
 29 |     | <span class='unexecuted'>        damnValuableToken.transferFrom(msg.sender, address(this), amount);</span>
 30 |     | <span class='unexecuted'>        poolBalance = poolBalance + amount;</span>
 31 |     | <span class='neutral'>    }</span>
 32 |     | <span class='neutral'></span>
 33 |     | <span class='unexecuted'>    function flashLoan(uint256 borrowAmount) external nonReentrant {</span>
 34 |     | <span class='unexecuted'>        require(borrowAmount &gt; 0, &quot;Must borrow at least one token&quot;);</span>
 35 |     | <span class='neutral'></span>
 36 |     | <span class='unexecuted'>        uint256 balanceBefore = damnValuableToken.balanceOf(address(this));</span>
 37 |     | <span class='unexecuted'>        require(balanceBefore &gt;= borrowAmount, &quot;Not enough tokens in pool&quot;);</span>
 38 |     | <span class='neutral'></span>
 39 |     | <span class='neutral'>        // Ensured by the protocol via the `depositTokens` function</span>
 40 |     | <span class='unexecuted'>        assert(poolBalance == balanceBefore);</span>
 41 |     | <span class='neutral'>        </span>
 42 |     | <span class='unexecuted'>        damnValuableToken.transfer(msg.sender, borrowAmount);</span>
 43 |     | <span class='neutral'>        </span>
 44 |     | <span class='unexecuted'>        IReceiver(msg.sender).receiveTokens(address(damnValuableToken), borrowAmount);</span>
 45 |     | <span class='neutral'>        </span>
 46 |     | <span class='unexecuted'>        uint256 balanceAfter = damnValuableToken.balanceOf(address(this));</span>
 47 |     | <span class='unexecuted'>        require(balanceAfter &gt;= balanceBefore, &quot;Flash loan hasn&#39;t been paid back&quot;);</span>
 48 |     | <span class='neutral'>    }</span>
 49 |     | <span class='neutral'>}</span>
 50 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise7/EchidnaSideEntrance.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>import &quot;./SideEntranceLenderPool.sol&quot;;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'></span>
  7 |     | <span class='unexecuted'>contract EchidnaSideEntrance   {</span>
  8 |     | <span class='neutral'></span>
  9 |     | <span class='unexecuted'>    SideEntranceLenderPool public pool;</span>
 10 |     | <span class='neutral'></span>
 11 |     | <span class='unexecuted'>    constructor () {</span>
 12 |     | <span class='unexecuted'>        pool = new SideEntranceLenderPool() ;</span>
 13 |     | <span class='neutral'></span>
 14 |     | <span class='neutral'>    }</span>
 15 |     | <span class='neutral'></span>
 16 |     | <span class='neutral'></span>
 17 |     | <span class='neutral'>}</span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise7/SideEntranceLenderPool.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'></span>
  3 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  4 |     | <span class='neutral'>import &quot;@openzeppelin/contracts/utils/Address.sol&quot;;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>interface IFlashLoanEtherReceiver {</span>
  7 |     | <span class='neutral'>    function execute() external payable;</span>
  8 |     | <span class='neutral'>}</span>
  9 |     | <span class='neutral'></span>
 10 |     | <span class='neutral'>/**</span>
 11 |     | <span class='neutral'> * @title SideEntranceLenderPool</span>
 12 |     | <span class='neutral'> * @author Damn Vulnerable DeFi (https://damnvulnerabledefi.xyz)</span>
 13 |     | <span class='neutral'> */</span>
 14 |     | <span class='unexecuted'>contract SideEntranceLenderPool {</span>
 15 |     | <span class='neutral'>    using Address for address payable;</span>
 16 |     | <span class='neutral'></span>
 17 |     | <span class='neutral'>    mapping (address =&gt; uint256) private balances;</span>
 18 |     | <span class='neutral'></span>
 19 |     | <span class='unexecuted'>    function deposit() external payable {</span>
 20 |     | <span class='unexecuted'>        balances[msg.sender] += msg.value;</span>
 21 |     | <span class='neutral'>    }</span>
 22 |     | <span class='neutral'></span>
 23 |     | <span class='unexecuted'>    function withdraw() external {</span>
 24 |     | <span class='unexecuted'>        uint256 amountToWithdraw = balances[msg.sender];</span>
 25 |     | <span class='unexecuted'>        balances[msg.sender] = 0;</span>
 26 |     | <span class='unexecuted'>        payable(msg.sender).sendValue(amountToWithdraw);</span>
 27 |     | <span class='neutral'>    }</span>
 28 |     | <span class='neutral'></span>
 29 |     | <span class='unexecuted'>    function flashLoan(uint256 amount) external {</span>
 30 |     | <span class='unexecuted'>        uint256 balanceBefore = address(this).balance;</span>
 31 |     | <span class='unexecuted'>        require(balanceBefore &gt;= amount, &quot;Not enough ETH in balance&quot;);</span>
 32 |     | <span class='neutral'>        </span>
 33 |     | <span class='unexecuted'>        IFlashLoanEtherReceiver(msg.sender).execute{value: amount}();</span>
 34 |     | <span class='neutral'></span>
 35 |     | <span class='unexecuted'>        require(address(this).balance &gt;= balanceBefore, &quot;Flash loan hasn&#39;t been paid back&quot;);        </span>
 36 |     | <span class='neutral'>    }</span>
 37 |     | <span class='neutral'>}</span>
 38 |     | <span class='neutral'> </span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise8/AccountingToken.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'></span>
  3 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  4 |     | <span class='neutral'></span>
  5 |     | <span class='neutral'>import &quot;@openzeppelin/contracts/token/ERC20/extensions/ERC20Snapshot.sol&quot;;</span>
  6 |     | <span class='neutral'>import &quot;@openzeppelin/contracts/access/AccessControl.sol&quot;;</span>
  7 |     | <span class='neutral'></span>
  8 |     | <span class='neutral'>/**</span>
  9 |     | <span class='neutral'> * @title AccountingToken</span>
 10 |     | <span class='neutral'> * @author Damn Vulnerable DeFi (https://damnvulnerabledefi.xyz)</span>
 11 |     | <span class='neutral'> * @notice A limited pseudo-ERC20 token to keep track of deposits and withdrawals</span>
 12 |     | <span class='neutral'> *         with snapshotting capabilities</span>
 13 |     | <span class='neutral'> */</span>
 14 | *r  | <span class='executed'>contract AccountingToken is ERC20Snapshot, AccessControl {</span>
 15 |     | <span class='neutral'></span>
 16 | *   | <span class='executed'>    bytes32 public constant MINTER_ROLE = keccak256(&quot;MINTER_ROLE&quot;);</span>
 17 | *   | <span class='executed'>    bytes32 public constant SNAPSHOT_ROLE = keccak256(&quot;SNAPSHOT_ROLE&quot;);</span>
 18 | *   | <span class='executed'>    bytes32 public constant BURNER_ROLE = keccak256(&quot;BURNER_ROLE&quot;);</span>
 19 |     | <span class='neutral'></span>
 20 | *   | <span class='executed'>    constructor() ERC20(&quot;rToken&quot;, &quot;rTKN&quot;) {</span>
 21 | *   | <span class='executed'>        _setupRole(DEFAULT_ADMIN_ROLE, msg.sender);</span>
 22 | *   | <span class='executed'>        _setupRole(MINTER_ROLE, msg.sender);</span>
 23 | *   | <span class='executed'>        _setupRole(SNAPSHOT_ROLE, msg.sender);</span>
 24 | *   | <span class='executed'>        _setupRole(BURNER_ROLE, msg.sender);</span>
 25 |     | <span class='neutral'>    }</span>
 26 |     | <span class='neutral'></span>
 27 | *   | <span class='executed'>    function mint(address to, uint256 amount) external {</span>
 28 | *r  | <span class='executed'>        require(hasRole(MINTER_ROLE, msg.sender), &quot;Forbidden&quot;);</span>
 29 | *   | <span class='executed'>        _mint(to, amount);</span>
 30 |     | <span class='neutral'>    }</span>
 31 |     | <span class='neutral'></span>
 32 | *   | <span class='executed'>    function burn(address from, uint256 amount) external {</span>
 33 | *r  | <span class='executed'>        require(hasRole(BURNER_ROLE, msg.sender), &quot;Forbidden&quot;);</span>
 34 | *   | <span class='executed'>        _burn(from, amount);</span>
 35 |     | <span class='neutral'>    }</span>
 36 |     | <span class='neutral'></span>
 37 | *   | <span class='executed'>    function snapshot() external returns (uint256) {</span>
 38 | *r  | <span class='executed'>        require(hasRole(SNAPSHOT_ROLE, msg.sender), &quot;Forbidden&quot;);</span>
 39 | *   | <span class='executed'>        return _snapshot();</span>
 40 |     | <span class='neutral'>    }</span>
 41 |     | <span class='neutral'></span>
 42 |     | <span class='neutral'>    // Do not need transfer of this token</span>
 43 |     | <span class='neutral'>    /*</span>
 44 |     | <span class='neutral'>    function _transfer(address, address, uint256) internal pure override {</span>
 45 |     | <span class='neutral'>        revert(&quot;Not implemented&quot;);</span>
 46 |     | <span class='neutral'>    }*/</span>
 47 |     | <span class='neutral'></span>
 48 |     | <span class='neutral'>    // Do not need allowance of this token</span>
 49 | *   | <span class='executed'>    function _approve(address, address, uint256) internal pure override {</span>
 50 | *r  | <span class='executed'>        revert(&quot;Not implemented&quot;);</span>
 51 |     | <span class='neutral'>    }</span>
 52 |     | <span class='neutral'>}</span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise8/DamnValuableToken.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'></span>
  3 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  4 |     | <span class='neutral'></span>
  5 |     | <span class='neutral'>import &quot;@openzeppelin/contracts/token/ERC20/ERC20.sol&quot;;</span>
  6 |     | <span class='neutral'></span>
  7 |     | <span class='neutral'>/**</span>
  8 |     | <span class='neutral'> * @title DamnValuableToken</span>
  9 |     | <span class='neutral'> * @author Damn Vulnerable DeFi (https://damnvulnerabledefi.xyz)</span>
 10 |     | <span class='neutral'> */</span>
 11 | *r  | <span class='executed'>contract DamnValuableToken is ERC20 {</span>
 12 |     | <span class='neutral'></span>
 13 |     | <span class='neutral'>    // Decimals are set to 18 by default in `ERC20`</span>
 14 | *   | <span class='executed'>    constructor() ERC20(&quot;DamnValuableToken&quot;, &quot;DVT&quot;) {</span>
 15 | *   | <span class='executed'>        _mint(msg.sender, type(uint256).max);</span>
 16 |     | <span class='neutral'>    }</span>
 17 |     | <span class='neutral'>}</span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise8/EchidnaRewarder.sol</b>
<code>
   1 |     | <span class='neutral'>// // SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>pragma solidity ^0.8.7;</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>import &quot;./FlashLoanerPool.sol&quot;;</span>
   5 |     | <span class='neutral'>import &quot;./RewardToken.sol&quot;;</span>
   6 |     | <span class='neutral'>import &quot;./AccountingToken.sol&quot;;</span>
   7 |     | <span class='neutral'>import &quot;./TheRewarderPool.sol&quot;;</span>
   8 |     | <span class='neutral'>import &quot;./DamnValuableToken.sol&quot;;</span>
   9 |     | <span class='neutral'></span>
  10 |     | <span class='neutral'>/**</span>
  11 |     | <span class='neutral'> * @notice to run echidna use following command:</span>
  12 |     | <span class='neutral'> * npx hardhat clean &amp;&amp; npx hardhat compile --force &amp;&amp; echidna-test . --contract EchidnaRewarder --config ./the-rewarder.yaml</span>
  13 |     | <span class='neutral'> */</span>
  14 |     | <span class='neutral'></span>
  15 |     | <span class='neutral'>// this contract is used to set fuzzing environment (to deploy all necessary contracts)</span>
  16 | *   | <span class='executed'>contract RewarderTaskDeployer {</span>
  17 | *   | <span class='executed'>    uint256 private TOKENS_IN_LENDER_POOL = 1_000_000 ether;</span>
  18 | *   | <span class='executed'>    uint256 private TOKENS_PER_USER = 100 ether;</span>
  19 |     | <span class='neutral'></span>
  20 | *   | <span class='executed'>    function deployPoolsAndToken()</span>
  21 |     | <span class='neutral'>        public</span>
  22 |     | <span class='neutral'>        payable</span>
  23 |     | <span class='neutral'>        returns (</span>
  24 | *   | <span class='executed'>            DamnValuableToken,</span>
  25 | *   | <span class='executed'>            FlashLoanerPool,</span>
  26 | *   | <span class='executed'>            TheRewarderPool</span>
  27 |     | <span class='neutral'>        )</span>
  28 |     | <span class='neutral'>    {</span>
  29 |     | <span class='neutral'>        // deploy DamnValuableToken</span>
  30 | *   | <span class='executed'>        DamnValuableToken token;</span>
  31 | *   | <span class='executed'>        token = new DamnValuableToken();</span>
  32 |     | <span class='neutral'>        // deploy FlashLoanerPool</span>
  33 | *   | <span class='executed'>        FlashLoanerPool pool;</span>
  34 | *   | <span class='executed'>        pool = new FlashLoanerPool(address(token));</span>
  35 |     | <span class='neutral'>        // add liquidity to FlashLoanerPool deployed</span>
  36 | *   | <span class='executed'>        token.transfer(address(pool), TOKENS_IN_LENDER_POOL);</span>
  37 |     | <span class='neutral'>        // deploy TheRewarderPool</span>
  38 | *   | <span class='executed'>        TheRewarderPool rewarder;</span>
  39 | *   | <span class='executed'>        rewarder = new TheRewarderPool(address(token));</span>
  40 |     | <span class='neutral'>        // deposit tokens to the rewarder pool (simulate a deposit of 4 users)</span>
  41 | *   | <span class='executed'>        token.approve(address(rewarder), TOKENS_PER_USER * 4);</span>
  42 | *   | <span class='executed'>        rewarder.deposit(TOKENS_PER_USER * 4);</span>
  43 |     | <span class='neutral'>        // return</span>
  44 | *   | <span class='executed'>        return (token, pool, rewarder);</span>
  45 |     | <span class='neutral'>    }</span>
  46 |     | <span class='neutral'>}</span>
  47 |     | <span class='neutral'></span>
  48 | *r  | <span class='executed'>contract EchidnaRewarder {</span>
  49 | *   | <span class='executed'>    uint256 REWARDS_ROUND_MIN_DURATION = 5 days;</span>
  50 |     | <span class='neutral'>    uint256 flashLoanAmount;</span>
  51 |     | <span class='neutral'>    uint256 reward;</span>
  52 |     | <span class='neutral'></span>
  53 |     | <span class='neutral'>    FlashLoanerPool pool;</span>
  54 |     | <span class='neutral'>    TheRewarderPool rewarder;</span>
  55 |     | <span class='neutral'>    RewardToken rewardToken;</span>
  56 |     | <span class='neutral'>    DamnValuableToken damnValuableToken;</span>
  57 |     | <span class='neutral'></span>
  58 |     | <span class='neutral'>    bool private depositEnabled;</span>
  59 |     | <span class='neutral'>    bool private withdrawalEnabled;</span>
  60 |     | <span class='neutral'>    bool private rewardsDistributionEnabled;</span>
  61 |     | <span class='neutral'></span>
  62 |     | <span class='neutral'>    // set Echidna fuzzing env</span>
  63 | *   | <span class='executed'>    constructor() payable {</span>
  64 | *   | <span class='executed'>        RewarderTaskDeployer deployer = new RewarderTaskDeployer();</span>
  65 | *   | <span class='executed'>        (damnValuableToken, pool, rewarder) = deployer.deployPoolsAndToken();</span>
  66 | *   | <span class='executed'>        rewardToken = rewarder.rewardToken();</span>
  67 |     | <span class='neutral'>    }</span>
  68 |     | <span class='neutral'></span>
  69 | *   | <span class='executed'>    function receiveFlashLoan(uint256 amount) external {</span>
  70 | *r  | <span class='executed'>        require(</span>
  71 | *   | <span class='executed'>            msg.sender == address(pool),</span>
  72 |     | <span class='neutral'>            &quot;Only pool can call this function.&quot;</span>
  73 |     | <span class='neutral'>        );</span>
  74 |     | <span class='neutral'>        // call selected functions</span>
  75 | *   | <span class='executed'>        selectFunctionsToCallInCallback();</span>
  76 |     | <span class='neutral'>        // get max reward amount for checking the INVARIANT</span>
  77 | *   | <span class='executed'>        reward = rewardToken.balanceOf(address(this));</span>
  78 |     | <span class='neutral'>        // repay the loan</span>
  79 | *   | <span class='executed'>        damnValuableToken.transfer(address(pool), amount);</span>
  80 |     | <span class='neutral'>    }</span>
  81 |     | <span class='neutral'></span>
  82 |     | <span class='neutral'>    /**</span>
  83 |     | <span class='neutral'>     * @notice functions to be called in callback</span>
  84 |     | <span class='neutral'>     * @dev order must be defined by a user</span>
  85 |     | <span class='neutral'>     */</span>
  86 | *   | <span class='executed'>    function selectFunctionsToCallInCallback() internal {</span>
  87 |     | <span class='neutral'>        // deposit to the pool with prior approval</span>
  88 | *   | <span class='executed'>        if (depositEnabled) {</span>
  89 | *   | <span class='executed'>            damnValuableToken.approve(address(rewarder), flashLoanAmount);</span>
  90 | *   | <span class='executed'>            rewarder.deposit(flashLoanAmount);</span>
  91 |     | <span class='neutral'>        }</span>
  92 |     | <span class='neutral'>        // withdraw from the pool</span>
  93 | *   | <span class='executed'>        if (withdrawalEnabled) {</span>
  94 | *   | <span class='executed'>            rewarder.withdraw(flashLoanAmount);</span>
  95 |     | <span class='neutral'>        }</span>
  96 |     | <span class='neutral'>        // distribute rewards</span>
  97 | *   | <span class='executed'>        if (rewardsDistributionEnabled) {</span>
  98 | *   | <span class='executed'>            rewarder.distributeRewards();</span>
  99 |     | <span class='neutral'>        }</span>
 100 |     | <span class='neutral'>    }</span>
 101 |     | <span class='neutral'></span>
 102 | *   | <span class='executed'>    function setEnableDeposit(bool _enabled) external {</span>
 103 | *   | <span class='executed'>        depositEnabled = _enabled;</span>
 104 |     | <span class='neutral'>    }</span>
 105 |     | <span class='neutral'></span>
 106 | *   | <span class='executed'>    function setEnableWithdrawal(bool _enabled) external {</span>
 107 | *   | <span class='executed'>        withdrawalEnabled = _enabled;</span>
 108 |     | <span class='neutral'>    }</span>
 109 |     | <span class='neutral'></span>
 110 | *   | <span class='executed'>    function setRewardsDistributionEnabled(bool _enabled) external {</span>
 111 | *   | <span class='executed'>        rewardsDistributionEnabled = _enabled;</span>
 112 |     | <span class='neutral'>    }</span>
 113 |     | <span class='neutral'></span>
 114 | *   | <span class='executed'>    function flashLoan(uint256 _amount) public {</span>
 115 | *   | <span class='executed'>        uint256 lastRewardsTimestamp = rewarder.lastRecordedSnapshotTimestamp();</span>
 116 | *r  | <span class='executed'>        require(</span>
 117 | *   | <span class='executed'>            block.timestamp &gt;=</span>
 118 | *   | <span class='executed'>                lastRewardsTimestamp + REWARDS_ROUND_MIN_DURATION,</span>
 119 |     | <span class='neutral'>            &quot;It is useless to call flashloan if no rewards can be taken as ETH is precious.&quot;</span>
 120 |     | <span class='neutral'>        );</span>
 121 | *r  | <span class='executed'>        require(</span>
 122 | *   | <span class='executed'>            _amount &lt;= damnValuableToken.balanceOf(address(pool)),</span>
 123 |     | <span class='neutral'>            &quot;Cannot borrow more than it is in the pool.&quot;</span>
 124 |     | <span class='neutral'>        );</span>
 125 |     | <span class='neutral'>        // set _amount into storage to have the value available in selectFunctionsToCallInCallback()</span>
 126 | *   | <span class='executed'>        flashLoanAmount = _amount;</span>
 127 |     | <span class='neutral'>        // call flashloan</span>
 128 | *r  | <span class='executed'>        pool.flashLoan(flashLoanAmount);</span>
 129 |     | <span class='neutral'>    }</span>
 130 |     | <span class='neutral'></span>
 131 |     | <span class='neutral'>    /**</span>
 132 |     | <span class='neutral'>     * @notice INVARIANT: one user cannot get almost all of rewards</span>
 133 |     | <span class='neutral'>     * (max reward is 100 per turnus)</span>
 134 |     | <span class='neutral'>     */</span>
 135 | *   | <span class='executed'>    function testRewards() public view {</span>
 136 | *   | <span class='executed'>        assert(reward &lt; 99 ether);</span>
 137 |     | <span class='neutral'>    }</span>
 138 |     | <span class='neutral'>}</span>
 139 |     | <span class='neutral'>// pragma solidity ^0.8.0;</span>
 140 |     | <span class='neutral'></span>
 141 |     | <span class='neutral'>// import &quot;./AccountingToken.sol&quot;;</span>
 142 |     | <span class='neutral'>// import &quot;./DamnValuableToken.sol&quot;;</span>
 143 |     | <span class='neutral'>// import &quot;./FlashLoanerPool.sol&quot;;</span>
 144 |     | <span class='neutral'>// import &quot;./RewardToken.sol&quot;;</span>
 145 |     | <span class='neutral'>// import &quot;./TheRewarderPool.sol&quot;;</span>
 146 |     | <span class='neutral'>// // import &quot;&quot;</span>
 147 |     | <span class='neutral'></span>
 148 |     | <span class='neutral'>// contract setUp {</span>
 149 |     | <span class='neutral'></span>
 150 |     | <span class='neutral'>//     // DamnValuableToken public damnToken;</span>
 151 |     | <span class='neutral'>//     // FlashLoanerPool public flashPool;</span>
 152 |     | <span class='neutral'>//     // TheRewarderPool public rewarderPool;</span>
 153 |     | <span class='neutral'>//     // RewardToken public rewardToken;</span>
 154 |     | <span class='neutral'>//     // AccountingToken public accToken;</span>
 155 |     | <span class='neutral'></span>
 156 |     | <span class='neutral'>//     uint256 public poolTokenBalance = 100000;</span>
 157 |     | <span class='neutral'>//     uint256 public userTokenBalance = 100;</span>
 158 |     | <span class='neutral'></span>
 159 |     | <span class='neutral'>//     function deploy() public returns(DamnValuableToken,FlashLoanerPool,TheRewarderPool,AccountingToken,RewardToken) {</span>
 160 |     | <span class='neutral'>//         DamnValuableToken damnToken;</span>
 161 |     | <span class='neutral'>//         FlashLoanerPool flashPool;</span>
 162 |     | <span class='neutral'>//         TheRewarderPool rewarderPool;</span>
 163 |     | <span class='neutral'>//         RewardToken rewardToken;</span>
 164 |     | <span class='neutral'>//         AccountingToken accToken;</span>
 165 |     | <span class='neutral'></span>
 166 |     | <span class='neutral'>//         damnToken = new DamnValuableToken();</span>
 167 |     | <span class='neutral'>//         flashPool =  new FlashLoanerPool(address(damnToken));</span>
 168 |     | <span class='neutral'>//         rewarderPool = new TheRewarderPool(address(damnToken));</span>
 169 |     | <span class='neutral'>//         accToken = rewarderPool.accToken();</span>
 170 |     | <span class='neutral'>//         rewardToken = rewarderPool.rewardToken();</span>
 171 |     | <span class='neutral'></span>
 172 |     | <span class='neutral'>//         damnToken.transfer(address(flashPool), poolTokenBalance);</span>
 173 |     | <span class='neutral'>        </span>
 174 |     | <span class='neutral'>//         damnToken.approve(address(rewarderPool), userTokenBalance * 4);</span>
 175 |     | <span class='neutral'>//         rewarderPool.deposit( userTokenBalance * 4);</span>
 176 |     | <span class='neutral'>//         return (damnToken, flashPool, rewarderPool, accToken, rewardToken);</span>
 177 |     | <span class='neutral'>//     }</span>
 178 |     | <span class='neutral'></span>
 179 |     | <span class='neutral'>// }</span>
 180 |     | <span class='neutral'></span>
 181 |     | <span class='neutral'>// contract EchidnaRewarder {</span>
 182 |     | <span class='neutral'></span>
 183 |     | <span class='neutral'>//     uint256 public MIN_DURATION = 5 days;</span>
 184 |     | <span class='neutral'></span>
 185 |     | <span class='neutral'>//     DamnValuableToken public damnToken;</span>
 186 |     | <span class='neutral'>//     FlashLoanerPool public flashPool;</span>
 187 |     | <span class='neutral'>//     TheRewarderPool public rewarderPool;</span>
 188 |     | <span class='neutral'>//     RewardToken public rewardToken;</span>
 189 |     | <span class='neutral'>//     AccountingToken public accToken;</span>
 190 |     | <span class='neutral'></span>
 191 |     | <span class='neutral'>//     constructor() {</span>
 192 |     | <span class='neutral'>//         setUp  deployer = new setUp();</span>
 193 |     | <span class='neutral'>//         (damnToken, flashPool, rewarderPool, accToken, rewardToken) = deployer.deploy();</span>
 194 |     | <span class='neutral'>//     }</span>
 195 |     | <span class='neutral'></span>
 196 |     | <span class='neutral'></span>
 197 |     | <span class='neutral'>// }</span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise8/FlashLoanerPool.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'></span>
  3 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  4 |     | <span class='neutral'></span>
  5 |     | <span class='neutral'>import &quot;@openzeppelin/contracts/utils/ReentrancyGuard.sol&quot;;</span>
  6 |     | <span class='neutral'>import &quot;@openzeppelin/contracts/utils/Address.sol&quot;;</span>
  7 |     | <span class='neutral'>import &quot;./DamnValuableToken.sol&quot;;</span>
  8 |     | <span class='neutral'></span>
  9 |     | <span class='neutral'>/**</span>
 10 |     | <span class='neutral'> * @title FlashLoanerPool</span>
 11 |     | <span class='neutral'> * @author Damn Vulnerable DeFi (https://damnvulnerabledefi.xyz)</span>
 12 |     | <span class='neutral'></span>
 13 |     | <span class='neutral'> * @dev A simple pool to get flash loans of DVT</span>
 14 |     | <span class='neutral'> */</span>
 15 | *r  | <span class='executed'>contract FlashLoanerPool is ReentrancyGuard {</span>
 16 |     | <span class='neutral'></span>
 17 |     | <span class='neutral'>    using Address for address;</span>
 18 |     | <span class='neutral'></span>
 19 | *   | <span class='executed'>    DamnValuableToken public immutable liquidityToken;</span>
 20 |     | <span class='neutral'></span>
 21 | *   | <span class='executed'>    constructor(address liquidityTokenAddress) {</span>
 22 | *   | <span class='executed'>        liquidityToken = DamnValuableToken(liquidityTokenAddress);</span>
 23 |     | <span class='neutral'>    }</span>
 24 |     | <span class='neutral'></span>
 25 |     | <span class='neutral'>    // Flashloan caller should be a contract address</span>
 26 | *   | <span class='executed'>    function flashLoan(uint256 amount) external nonReentrant {</span>
 27 | *   | <span class='executed'>        uint256 balanceBefore = liquidityToken.balanceOf(address(this));</span>
 28 | *r  | <span class='executed'>        require(amount &lt;= balanceBefore, &quot;Not enough token balance&quot;);</span>
 29 |     | <span class='neutral'></span>
 30 | *r  | <span class='executed'>        require(msg.sender.isContract(), &quot;Borrower must be a deployed contract&quot;);</span>
 31 |     | <span class='neutral'>        </span>
 32 | *   | <span class='executed'>        liquidityToken.transfer(msg.sender, amount);</span>
 33 |     | <span class='neutral'></span>
 34 | *   | <span class='executed'>        msg.sender.functionCall(</span>
 35 | *   | <span class='executed'>            abi.encodeWithSignature(</span>
 36 |     | <span class='neutral'>                &quot;receiveFlashLoan(uint256)&quot;,</span>
 37 | *   | <span class='executed'>                amount</span>
 38 |     | <span class='neutral'>            )</span>
 39 |     | <span class='neutral'>        );</span>
 40 |     | <span class='neutral'></span>
 41 | *   | <span class='executed'>        require(liquidityToken.balanceOf(address(this)) &gt;= balanceBefore, &quot;Flash loan not paid back&quot;);</span>
 42 |     | <span class='neutral'>    }</span>
 43 |     | <span class='neutral'>}</span>
 44 |     | <span class='neutral'></span>
 45 |     | <span class='neutral'></span>
 46 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise8/RewardToken.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'></span>
  3 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  4 |     | <span class='neutral'></span>
  5 |     | <span class='neutral'>import &quot;@openzeppelin/contracts/token/ERC20/ERC20.sol&quot;;</span>
  6 |     | <span class='neutral'>import &quot;@openzeppelin/contracts/access/AccessControl.sol&quot;;</span>
  7 |     | <span class='neutral'></span>
  8 |     | <span class='neutral'>/**</span>
  9 |     | <span class='neutral'> * @title RewardToken</span>
 10 |     | <span class='neutral'> * @author Damn Vulnerable DeFi (https://damnvulnerabledefi.xyz)</span>
 11 |     | <span class='neutral'> * @dev A mintable ERC20 with 2 decimals to issue rewards</span>
 12 |     | <span class='neutral'> */</span>
 13 | *r  | <span class='executed'>contract RewardToken is ERC20, AccessControl {</span>
 14 |     | <span class='neutral'></span>
 15 | *   | <span class='executed'>    bytes32 public constant MINTER_ROLE = keccak256(&quot;MINTER_ROLE&quot;);</span>
 16 |     | <span class='neutral'></span>
 17 | *   | <span class='executed'>    constructor() ERC20(&quot;Reward Token&quot;, &quot;RWT&quot;) {</span>
 18 | *   | <span class='executed'>        _setupRole(DEFAULT_ADMIN_ROLE, msg.sender);</span>
 19 | *   | <span class='executed'>        _setupRole(MINTER_ROLE, msg.sender);</span>
 20 |     | <span class='neutral'>    }</span>
 21 |     | <span class='neutral'></span>
 22 | *   | <span class='executed'>    function mint(address to, uint256 amount) external {</span>
 23 | *r  | <span class='executed'>        require(hasRole(MINTER_ROLE, msg.sender));</span>
 24 | *   | <span class='executed'>        _mint(to, amount);</span>
 25 |     | <span class='neutral'>    }</span>
 26 |     | <span class='neutral'>}</span>
 27 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise8/TheRewarderPool.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'></span>
   3 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
   4 |     | <span class='neutral'></span>
   5 |     | <span class='neutral'>import &quot;./RewardToken.sol&quot;;</span>
   6 |     | <span class='neutral'>import &quot;./DamnValuableToken.sol&quot;;</span>
   7 |     | <span class='neutral'>import &quot;./AccountingToken.sol&quot;;</span>
   8 |     | <span class='neutral'></span>
   9 |     | <span class='neutral'>/**</span>
  10 |     | <span class='neutral'> * @title TheRewarderPool</span>
  11 |     | <span class='neutral'> * @author Damn Vulnerable DeFi (https://damnvulnerabledefi.xyz)</span>
  12 |     | <span class='neutral'></span>
  13 |     | <span class='neutral'> */</span>
  14 | *r  | <span class='executed'>contract TheRewarderPool {</span>
  15 |     | <span class='neutral'></span>
  16 |     | <span class='neutral'>    // Minimum duration of each round of rewards in seconds</span>
  17 | *   | <span class='executed'>    uint256 private constant REWARDS_ROUND_MIN_DURATION = 5 days;</span>
  18 |     | <span class='neutral'></span>
  19 | *   | <span class='executed'>    uint256 public lastSnapshotIdForRewards;</span>
  20 | *   | <span class='executed'>    uint256 public lastRecordedSnapshotTimestamp;</span>
  21 |     | <span class='neutral'></span>
  22 | *   | <span class='executed'>    mapping(address =&gt; uint256) public lastRewardTimestamps;</span>
  23 |     | <span class='neutral'></span>
  24 |     | <span class='neutral'>    // Token deposited into the pool by users</span>
  25 | *   | <span class='executed'>    DamnValuableToken public immutable liquidityToken;</span>
  26 |     | <span class='neutral'></span>
  27 |     | <span class='neutral'>    // Token used for internal accounting and snapshots</span>
  28 |     | <span class='neutral'>    // Pegged 1:1 with the liquidity token</span>
  29 | *   | <span class='executed'>    AccountingToken public accToken;</span>
  30 |     | <span class='neutral'>    </span>
  31 |     | <span class='neutral'>    // Token in which rewards are issued</span>
  32 | *   | <span class='executed'>    RewardToken public immutable rewardToken;</span>
  33 |     | <span class='neutral'></span>
  34 |     | <span class='neutral'>    // Track number of rounds</span>
  35 | *   | <span class='executed'>    uint256 public roundNumber;</span>
  36 |     | <span class='neutral'></span>
  37 | *   | <span class='executed'>    constructor(address tokenAddress) {</span>
  38 |     | <span class='neutral'>        // Assuming all three tokens have 18 decimals</span>
  39 | *   | <span class='executed'>        liquidityToken = DamnValuableToken(tokenAddress);</span>
  40 | *   | <span class='executed'>        accToken = new AccountingToken();</span>
  41 | *   | <span class='executed'>        rewardToken = new RewardToken();</span>
  42 |     | <span class='neutral'></span>
  43 | *   | <span class='executed'>        _recordSnapshot();</span>
  44 |     | <span class='neutral'>    }</span>
  45 |     | <span class='neutral'></span>
  46 |     | <span class='neutral'>    /**</span>
  47 |     | <span class='neutral'>     * @notice sender must have approved `amountToDeposit` liquidity tokens in advance</span>
  48 |     | <span class='neutral'>     */</span>
  49 | *   | <span class='executed'>    function deposit(uint256 amountToDeposit) external {</span>
  50 | *r  | <span class='executed'>        require(amountToDeposit &gt; 0, &quot;Must deposit tokens&quot;);</span>
  51 |     | <span class='neutral'>        </span>
  52 | *r  | <span class='executed'>        accToken.mint(msg.sender, amountToDeposit);</span>
  53 | *   | <span class='executed'>        distributeRewards();</span>
  54 |     | <span class='neutral'></span>
  55 | *   | <span class='executed'>        require(</span>
  56 | *r  | <span class='executed'>            liquidityToken.transferFrom(msg.sender, address(this), amountToDeposit)</span>
  57 |     | <span class='neutral'>        );</span>
  58 |     | <span class='neutral'>    }</span>
  59 |     | <span class='neutral'></span>
  60 | *   | <span class='executed'>    function withdraw(uint256 amountToWithdraw) external {</span>
  61 | *r  | <span class='executed'>        accToken.burn(msg.sender, amountToWithdraw);</span>
  62 | *   | <span class='executed'>        require(liquidityToken.transfer(msg.sender, amountToWithdraw));</span>
  63 |     | <span class='neutral'>    }</span>
  64 |     | <span class='neutral'></span>
  65 | *   | <span class='executed'>    function distributeRewards() public returns (uint256) {</span>
  66 | *   | <span class='executed'>        uint256 rewards = 0;</span>
  67 |     | <span class='neutral'></span>
  68 | *   | <span class='executed'>        if(isNewRewardsRound()) {</span>
  69 | *   | <span class='executed'>            _recordSnapshot();</span>
  70 |     | <span class='neutral'>        }        </span>
  71 |     | <span class='neutral'>        </span>
  72 | *   | <span class='executed'>        uint256 totalDeposits = accToken.totalSupplyAt(lastSnapshotIdForRewards);</span>
  73 | *   | <span class='executed'>        uint256 amountDeposited = accToken.balanceOfAt(msg.sender, lastSnapshotIdForRewards);</span>
  74 |     | <span class='neutral'></span>
  75 | *   | <span class='executed'>        if (amountDeposited &gt; 0 &amp;&amp; totalDeposits &gt; 0) {</span>
  76 | *   | <span class='executed'>            rewards = (amountDeposited * 100 * 10 ** 18) / totalDeposits;</span>
  77 |     | <span class='neutral'></span>
  78 | *   | <span class='executed'>            if(rewards &gt; 0 &amp;&amp; !_hasRetrievedReward(msg.sender)) {</span>
  79 | *   | <span class='executed'>                rewardToken.mint(msg.sender, rewards);</span>
  80 | *   | <span class='executed'>                lastRewardTimestamps[msg.sender] = block.timestamp;</span>
  81 |     | <span class='neutral'>            }</span>
  82 |     | <span class='neutral'>        }</span>
  83 |     | <span class='neutral'></span>
  84 | *   | <span class='executed'>        return rewards;     </span>
  85 |     | <span class='neutral'>    }</span>
  86 |     | <span class='neutral'></span>
  87 | *   | <span class='executed'>    function _recordSnapshot() private {</span>
  88 | *   | <span class='executed'>        lastSnapshotIdForRewards = accToken.snapshot();</span>
  89 | *   | <span class='executed'>        lastRecordedSnapshotTimestamp = block.timestamp;</span>
  90 | *   | <span class='executed'>        roundNumber++;</span>
  91 |     | <span class='neutral'>    }</span>
  92 |     | <span class='neutral'></span>
  93 | *   | <span class='executed'>    function _hasRetrievedReward(address account) private view returns (bool) {</span>
  94 | *   | <span class='executed'>        return (</span>
  95 | *   | <span class='executed'>            lastRewardTimestamps[account] &gt;= lastRecordedSnapshotTimestamp &amp;&amp;</span>
  96 | *   | <span class='executed'>            lastRewardTimestamps[account] &lt;= lastRecordedSnapshotTimestamp + REWARDS_ROUND_MIN_DURATION</span>
  97 |     | <span class='neutral'>        );</span>
  98 |     | <span class='neutral'>    }</span>
  99 |     | <span class='neutral'></span>
 100 | *   | <span class='executed'>    function isNewRewardsRound() public view returns (bool) {</span>
 101 | *   | <span class='executed'>        return block.timestamp &gt;= lastRecordedSnapshotTimestamp + REWARDS_ROUND_MIN_DURATION;</span>
 102 |     | <span class='neutral'>    }</span>
 103 |     | <span class='neutral'>}</span>
 104 |     | <span class='neutral'></span>

</code>
<br />


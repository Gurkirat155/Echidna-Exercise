<style> code { white-space: pre-wrap; display: block; background-color: #eee; }.executed { background-color: #afa; }.reverted { background-color: #ffa; }.unexecuted { background-color: #faa; }.neutral { background-color: #eee; }</style><b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/lib/openzeppelin-contracts/contracts/interfaces/draft-IERC6093.sol</b>
<code>
   1 |     | <span class='unexecuted'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v5.1.0) (interfaces/draft-IERC6093.sol)</span>
   3 |     | <span class='neutral'>pragma solidity ^0.8.20;</span>
   4 |     | <span class='neutral'></span>
   5 |     | <span class='neutral'>/**</span>
   6 |     | <span class='neutral'> * @dev Standard ERC-20 Errors</span>
   7 |     | <span class='neutral'> * Interface of the https://eips.ethereum.org/EIPS/eip-6093[ERC-6093] custom errors for ERC-20 tokens.</span>
   8 |     | <span class='neutral'> */</span>
   9 |     | <span class='neutral'>interface IERC20Errors {</span>
  10 |     | <span class='neutral'>    /**</span>
  11 |     | <span class='neutral'>     * @dev Indicates an error related to the current `balance` of a `sender`. Used in transfers.</span>
  12 |     | <span class='neutral'>     * @param sender Address whose tokens are being transferred.</span>
  13 |     | <span class='neutral'>     * @param balance Current balance for the interacting account.</span>
  14 |     | <span class='neutral'>     * @param needed Minimum amount required to perform a transfer.</span>
  15 |     | <span class='neutral'>     */</span>
  16 |     | <span class='neutral'>    error ERC20InsufficientBalance(address sender, uint256 balance, uint256 needed);</span>
  17 |     | <span class='neutral'></span>
  18 |     | <span class='neutral'>    /**</span>
  19 |     | <span class='neutral'>     * @dev Indicates a failure with the token `sender`. Used in transfers.</span>
  20 |     | <span class='neutral'>     * @param sender Address whose tokens are being transferred.</span>
  21 |     | <span class='neutral'>     */</span>
  22 |     | <span class='neutral'>    error ERC20InvalidSender(address sender);</span>
  23 |     | <span class='neutral'></span>
  24 |     | <span class='neutral'>    /**</span>
  25 |     | <span class='neutral'>     * @dev Indicates a failure with the token `receiver`. Used in transfers.</span>
  26 |     | <span class='neutral'>     * @param receiver Address to which tokens are being transferred.</span>
  27 |     | <span class='neutral'>     */</span>
  28 |     | <span class='neutral'>    error ERC20InvalidReceiver(address receiver);</span>
  29 |     | <span class='neutral'></span>
  30 |     | <span class='neutral'>    /**</span>
  31 |     | <span class='neutral'>     * @dev Indicates a failure with the `spender`’s `allowance`. Used in transfers.</span>
  32 |     | <span class='neutral'>     * @param spender Address that may be allowed to operate on tokens without being their owner.</span>
  33 |     | <span class='neutral'>     * @param allowance Amount of tokens a `spender` is allowed to operate with.</span>
  34 |     | <span class='neutral'>     * @param needed Minimum amount required to perform a transfer.</span>
  35 |     | <span class='neutral'>     */</span>
  36 |     | <span class='neutral'>    error ERC20InsufficientAllowance(address spender, uint256 allowance, uint256 needed);</span>
  37 |     | <span class='neutral'></span>
  38 |     | <span class='neutral'>    /**</span>
  39 |     | <span class='neutral'>     * @dev Indicates a failure with the `approver` of a token to be approved. Used in approvals.</span>
  40 |     | <span class='neutral'>     * @param approver Address initiating an approval operation.</span>
  41 |     | <span class='neutral'>     */</span>
  42 |     | <span class='neutral'>    error ERC20InvalidApprover(address approver);</span>
  43 |     | <span class='neutral'></span>
  44 |     | <span class='neutral'>    /**</span>
  45 |     | <span class='neutral'>     * @dev Indicates a failure with the `spender` to be approved. Used in approvals.</span>
  46 |     | <span class='neutral'>     * @param spender Address that may be allowed to operate on tokens without being their owner.</span>
  47 |     | <span class='neutral'>     */</span>
  48 |     | <span class='neutral'>    error ERC20InvalidSpender(address spender);</span>
  49 |     | <span class='neutral'>}</span>
  50 |     | <span class='neutral'></span>
  51 |     | <span class='neutral'>/**</span>
  52 |     | <span class='neutral'> * @dev Standard ERC-721 Errors</span>
  53 |     | <span class='neutral'> * Interface of the https://eips.ethereum.org/EIPS/eip-6093[ERC-6093] custom errors for ERC-721 tokens.</span>
  54 |     | <span class='neutral'> */</span>
  55 |     | <span class='neutral'>interface IERC721Errors {</span>
  56 |     | <span class='neutral'>    /**</span>
  57 |     | <span class='neutral'>     * @dev Indicates that an address can&#39;t be an owner. For example, `address(0)` is a forbidden owner in ERC-20.</span>
  58 |     | <span class='neutral'>     * Used in balance queries.</span>
  59 |     | <span class='neutral'>     * @param owner Address of the current owner of a token.</span>
  60 |     | <span class='neutral'>     */</span>
  61 |     | <span class='neutral'>    error ERC721InvalidOwner(address owner);</span>
  62 |     | <span class='neutral'></span>
  63 |     | <span class='neutral'>    /**</span>
  64 |     | <span class='neutral'>     * @dev Indicates a `tokenId` whose `owner` is the zero address.</span>
  65 |     | <span class='neutral'>     * @param tokenId Identifier number of a token.</span>
  66 |     | <span class='neutral'>     */</span>
  67 |     | <span class='neutral'>    error ERC721NonexistentToken(uint256 tokenId);</span>
  68 |     | <span class='neutral'></span>
  69 |     | <span class='neutral'>    /**</span>
  70 |     | <span class='neutral'>     * @dev Indicates an error related to the ownership over a particular token. Used in transfers.</span>
  71 |     | <span class='neutral'>     * @param sender Address whose tokens are being transferred.</span>
  72 |     | <span class='neutral'>     * @param tokenId Identifier number of a token.</span>
  73 |     | <span class='neutral'>     * @param owner Address of the current owner of a token.</span>
  74 |     | <span class='neutral'>     */</span>
  75 |     | <span class='neutral'>    error ERC721IncorrectOwner(address sender, uint256 tokenId, address owner);</span>
  76 |     | <span class='neutral'></span>
  77 |     | <span class='neutral'>    /**</span>
  78 |     | <span class='neutral'>     * @dev Indicates a failure with the token `sender`. Used in transfers.</span>
  79 |     | <span class='neutral'>     * @param sender Address whose tokens are being transferred.</span>
  80 |     | <span class='neutral'>     */</span>
  81 |     | <span class='neutral'>    error ERC721InvalidSender(address sender);</span>
  82 |     | <span class='neutral'></span>
  83 |     | <span class='neutral'>    /**</span>
  84 |     | <span class='neutral'>     * @dev Indicates a failure with the token `receiver`. Used in transfers.</span>
  85 |     | <span class='neutral'>     * @param receiver Address to which tokens are being transferred.</span>
  86 |     | <span class='neutral'>     */</span>
  87 |     | <span class='neutral'>    error ERC721InvalidReceiver(address receiver);</span>
  88 |     | <span class='neutral'></span>
  89 |     | <span class='neutral'>    /**</span>
  90 |     | <span class='neutral'>     * @dev Indicates a failure with the `operator`’s approval. Used in transfers.</span>
  91 |     | <span class='neutral'>     * @param operator Address that may be allowed to operate on tokens without being their owner.</span>
  92 |     | <span class='neutral'>     * @param tokenId Identifier number of a token.</span>
  93 |     | <span class='neutral'>     */</span>
  94 |     | <span class='neutral'>    error ERC721InsufficientApproval(address operator, uint256 tokenId);</span>
  95 |     | <span class='neutral'></span>
  96 |     | <span class='neutral'>    /**</span>
  97 |     | <span class='neutral'>     * @dev Indicates a failure with the `approver` of a token to be approved. Used in approvals.</span>
  98 |     | <span class='neutral'>     * @param approver Address initiating an approval operation.</span>
  99 |     | <span class='neutral'>     */</span>
 100 |     | <span class='neutral'>    error ERC721InvalidApprover(address approver);</span>
 101 |     | <span class='neutral'></span>
 102 |     | <span class='neutral'>    /**</span>
 103 |     | <span class='neutral'>     * @dev Indicates a failure with the `operator` to be approved. Used in approvals.</span>
 104 |     | <span class='neutral'>     * @param operator Address that may be allowed to operate on tokens without being their owner.</span>
 105 |     | <span class='neutral'>     */</span>
 106 |     | <span class='neutral'>    error ERC721InvalidOperator(address operator);</span>
 107 |     | <span class='neutral'>}</span>
 108 |     | <span class='neutral'></span>
 109 |     | <span class='neutral'>/**</span>
 110 |     | <span class='neutral'> * @dev Standard ERC-1155 Errors</span>
 111 |     | <span class='neutral'> * Interface of the https://eips.ethereum.org/EIPS/eip-6093[ERC-6093] custom errors for ERC-1155 tokens.</span>
 112 |     | <span class='neutral'> */</span>
 113 |     | <span class='neutral'>interface IERC1155Errors {</span>
 114 |     | <span class='neutral'>    /**</span>
 115 |     | <span class='neutral'>     * @dev Indicates an error related to the current `balance` of a `sender`. Used in transfers.</span>
 116 |     | <span class='neutral'>     * @param sender Address whose tokens are being transferred.</span>
 117 |     | <span class='neutral'>     * @param balance Current balance for the interacting account.</span>
 118 |     | <span class='neutral'>     * @param needed Minimum amount required to perform a transfer.</span>
 119 |     | <span class='neutral'>     * @param tokenId Identifier number of a token.</span>
 120 |     | <span class='neutral'>     */</span>
 121 |     | <span class='neutral'>    error ERC1155InsufficientBalance(address sender, uint256 balance, uint256 needed, uint256 tokenId);</span>
 122 |     | <span class='neutral'></span>
 123 |     | <span class='neutral'>    /**</span>
 124 |     | <span class='neutral'>     * @dev Indicates a failure with the token `sender`. Used in transfers.</span>
 125 |     | <span class='neutral'>     * @param sender Address whose tokens are being transferred.</span>
 126 |     | <span class='neutral'>     */</span>
 127 |     | <span class='neutral'>    error ERC1155InvalidSender(address sender);</span>
 128 |     | <span class='neutral'></span>
 129 |     | <span class='neutral'>    /**</span>
 130 |     | <span class='neutral'>     * @dev Indicates a failure with the token `receiver`. Used in transfers.</span>
 131 |     | <span class='neutral'>     * @param receiver Address to which tokens are being transferred.</span>
 132 |     | <span class='neutral'>     */</span>
 133 |     | <span class='neutral'>    error ERC1155InvalidReceiver(address receiver);</span>
 134 |     | <span class='neutral'></span>
 135 |     | <span class='neutral'>    /**</span>
 136 |     | <span class='neutral'>     * @dev Indicates a failure with the `operator`’s approval. Used in transfers.</span>
 137 |     | <span class='neutral'>     * @param operator Address that may be allowed to operate on tokens without being their owner.</span>
 138 |     | <span class='neutral'>     * @param owner Address of the current owner of a token.</span>
 139 |     | <span class='neutral'>     */</span>
 140 |     | <span class='neutral'>    error ERC1155MissingApprovalForAll(address operator, address owner);</span>
 141 |     | <span class='neutral'></span>
 142 |     | <span class='neutral'>    /**</span>
 143 |     | <span class='neutral'>     * @dev Indicates a failure with the `approver` of a token to be approved. Used in approvals.</span>
 144 |     | <span class='neutral'>     * @param approver Address initiating an approval operation.</span>
 145 |     | <span class='neutral'>     */</span>
 146 |     | <span class='neutral'>    error ERC1155InvalidApprover(address approver);</span>
 147 |     | <span class='neutral'></span>
 148 |     | <span class='neutral'>    /**</span>
 149 |     | <span class='neutral'>     * @dev Indicates a failure with the `operator` to be approved. Used in approvals.</span>
 150 |     | <span class='neutral'>     * @param operator Address that may be allowed to operate on tokens without being their owner.</span>
 151 |     | <span class='neutral'>     */</span>
 152 |     | <span class='neutral'>    error ERC1155InvalidOperator(address operator);</span>
 153 |     | <span class='neutral'></span>
 154 |     | <span class='neutral'>    /**</span>
 155 |     | <span class='neutral'>     * @dev Indicates an array length mismatch between ids and values in a safeBatchTransferFrom operation.</span>
 156 |     | <span class='neutral'>     * Used in batch transfers.</span>
 157 |     | <span class='neutral'>     * @param idsLength Length of the array of token identifiers</span>
 158 |     | <span class='neutral'>     * @param valuesLength Length of the array of token amounts</span>
 159 |     | <span class='neutral'>     */</span>
 160 |     | <span class='neutral'>    error ERC1155InvalidArrayLength(uint256 idsLength, uint256 valuesLength);</span>
 161 |     | <span class='neutral'>}</span>
 162 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v5.2.0) (token/ERC20/ERC20.sol)</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>pragma solidity ^0.8.20;</span>
   5 |     | <span class='neutral'></span>
   6 |     | <span class='neutral'>import {IERC20} from &quot;./IERC20.sol&quot;;</span>
   7 |     | <span class='neutral'>import {IERC20Metadata} from &quot;./extensions/IERC20Metadata.sol&quot;;</span>
   8 |     | <span class='neutral'>import {Context} from &quot;../../utils/Context.sol&quot;;</span>
   9 |     | <span class='neutral'>import {IERC20Errors} from &quot;../../interfaces/draft-IERC6093.sol&quot;;</span>
  10 |     | <span class='neutral'></span>
  11 |     | <span class='neutral'>/**</span>
  12 |     | <span class='neutral'> * @dev Implementation of the {IERC20} interface.</span>
  13 |     | <span class='neutral'> *</span>
  14 |     | <span class='neutral'> * This implementation is agnostic to the way tokens are created. This means</span>
  15 |     | <span class='neutral'> * that a supply mechanism has to be added in a derived contract using {_mint}.</span>
  16 |     | <span class='neutral'> *</span>
  17 |     | <span class='neutral'> * TIP: For a detailed writeup see our guide</span>
  18 |     | <span class='neutral'> * https://forum.openzeppelin.com/t/how-to-implement-erc20-supply-mechanisms/226[How</span>
  19 |     | <span class='neutral'> * to implement supply mechanisms].</span>
  20 |     | <span class='neutral'> *</span>
  21 |     | <span class='neutral'> * The default value of {decimals} is 18. To change this, you should override</span>
  22 |     | <span class='neutral'> * this function so it returns a different value.</span>
  23 |     | <span class='neutral'> *</span>
  24 |     | <span class='neutral'> * We have followed general OpenZeppelin Contracts guidelines: functions revert</span>
  25 |     | <span class='neutral'> * instead returning `false` on failure. This behavior is nonetheless</span>
  26 |     | <span class='neutral'> * conventional and does not conflict with the expectations of ERC-20</span>
  27 |     | <span class='neutral'> * applications.</span>
  28 |     | <span class='neutral'> */</span>
  29 |     | <span class='neutral'>abstract contract ERC20 is Context, IERC20, IERC20Metadata, IERC20Errors {</span>
  30 |     | <span class='neutral'>    mapping(address account =&gt; uint256) private _balances;</span>
  31 |     | <span class='neutral'></span>
  32 |     | <span class='neutral'>    mapping(address account =&gt; mapping(address spender =&gt; uint256)) private _allowances;</span>
  33 |     | <span class='neutral'></span>
  34 |     | <span class='neutral'>    uint256 private _totalSupply;</span>
  35 |     | <span class='neutral'></span>
  36 |     | <span class='neutral'>    string private _name;</span>
  37 |     | <span class='neutral'>    string private _symbol;</span>
  38 |     | <span class='neutral'></span>
  39 |     | <span class='neutral'>    /**</span>
  40 |     | <span class='neutral'>     * @dev Sets the values for {name} and {symbol}.</span>
  41 |     | <span class='neutral'>     *</span>
  42 |     | <span class='neutral'>     * All two of these values are immutable: they can only be set once during</span>
  43 |     | <span class='neutral'>     * construction.</span>
  44 |     | <span class='neutral'>     */</span>
  45 |     | <span class='unexecuted'>    constructor(string memory name_, string memory symbol_) {</span>
  46 |     | <span class='unexecuted'>        _name = name_;</span>
  47 |     | <span class='unexecuted'>        _symbol = symbol_;</span>
  48 |     | <span class='neutral'>    }</span>
  49 |     | <span class='neutral'></span>
  50 |     | <span class='neutral'>    /**</span>
  51 |     | <span class='neutral'>     * @dev Returns the name of the token.</span>
  52 |     | <span class='neutral'>     */</span>
  53 |     | <span class='unexecuted'>    function name() public view virtual returns (string memory) {</span>
  54 |     | <span class='unexecuted'>        return _name;</span>
  55 |     | <span class='neutral'>    }</span>
  56 |     | <span class='neutral'></span>
  57 |     | <span class='neutral'>    /**</span>
  58 |     | <span class='neutral'>     * @dev Returns the symbol of the token, usually a shorter version of the</span>
  59 |     | <span class='neutral'>     * name.</span>
  60 |     | <span class='neutral'>     */</span>
  61 |     | <span class='unexecuted'>    function symbol() public view virtual returns (string memory) {</span>
  62 |     | <span class='unexecuted'>        return _symbol;</span>
  63 |     | <span class='neutral'>    }</span>
  64 |     | <span class='neutral'></span>
  65 |     | <span class='neutral'>    /**</span>
  66 |     | <span class='neutral'>     * @dev Returns the number of decimals used to get its user representation.</span>
  67 |     | <span class='neutral'>     * For example, if `decimals` equals `2`, a balance of `505` tokens should</span>
  68 |     | <span class='neutral'>     * be displayed to a user as `5.05` (`505 / 10 ** 2`).</span>
  69 |     | <span class='neutral'>     *</span>
  70 |     | <span class='neutral'>     * Tokens usually opt for a value of 18, imitating the relationship between</span>
  71 |     | <span class='neutral'>     * Ether and Wei. This is the default value returned by this function, unless</span>
  72 |     | <span class='neutral'>     * it&#39;s overridden.</span>
  73 |     | <span class='neutral'>     *</span>
  74 |     | <span class='neutral'>     * NOTE: This information is only used for _display_ purposes: it in</span>
  75 |     | <span class='neutral'>     * no way affects any of the arithmetic of the contract, including</span>
  76 |     | <span class='neutral'>     * {IERC20-balanceOf} and {IERC20-transfer}.</span>
  77 |     | <span class='neutral'>     */</span>
  78 |     | <span class='unexecuted'>    function decimals() public view virtual returns (uint8) {</span>
  79 |     | <span class='unexecuted'>        return 18;</span>
  80 |     | <span class='neutral'>    }</span>
  81 |     | <span class='neutral'></span>
  82 |     | <span class='neutral'>    /**</span>
  83 |     | <span class='neutral'>     * @dev See {IERC20-totalSupply}.</span>
  84 |     | <span class='neutral'>     */</span>
  85 |     | <span class='unexecuted'>    function totalSupply() public view virtual returns (uint256) {</span>
  86 |     | <span class='unexecuted'>        return _totalSupply;</span>
  87 |     | <span class='neutral'>    }</span>
  88 |     | <span class='neutral'></span>
  89 |     | <span class='neutral'>    /**</span>
  90 |     | <span class='neutral'>     * @dev See {IERC20-balanceOf}.</span>
  91 |     | <span class='neutral'>     */</span>
  92 |     | <span class='unexecuted'>    function balanceOf(address account) public view virtual returns (uint256) {</span>
  93 |     | <span class='unexecuted'>        return _balances[account];</span>
  94 |     | <span class='neutral'>    }</span>
  95 |     | <span class='neutral'></span>
  96 |     | <span class='neutral'>    /**</span>
  97 |     | <span class='neutral'>     * @dev See {IERC20-transfer}.</span>
  98 |     | <span class='neutral'>     *</span>
  99 |     | <span class='neutral'>     * Requirements:</span>
 100 |     | <span class='neutral'>     *</span>
 101 |     | <span class='neutral'>     * - `to` cannot be the zero address.</span>
 102 |     | <span class='neutral'>     * - the caller must have a balance of at least `value`.</span>
 103 |     | <span class='neutral'>     */</span>
 104 |     | <span class='unexecuted'>    function transfer(address to, uint256 value) public virtual returns (bool) {</span>
 105 |     | <span class='unexecuted'>        address owner = _msgSender();</span>
 106 |     | <span class='unexecuted'>        _transfer(owner, to, value);</span>
 107 |     | <span class='unexecuted'>        return true;</span>
 108 |     | <span class='neutral'>    }</span>
 109 |     | <span class='neutral'></span>
 110 |     | <span class='neutral'>    /**</span>
 111 |     | <span class='neutral'>     * @dev See {IERC20-allowance}.</span>
 112 |     | <span class='neutral'>     */</span>
 113 |     | <span class='unexecuted'>    function allowance(address owner, address spender) public view virtual returns (uint256) {</span>
 114 |     | <span class='unexecuted'>        return _allowances[owner][spender];</span>
 115 |     | <span class='neutral'>    }</span>
 116 |     | <span class='neutral'></span>
 117 |     | <span class='neutral'>    /**</span>
 118 |     | <span class='neutral'>     * @dev See {IERC20-approve}.</span>
 119 |     | <span class='neutral'>     *</span>
 120 |     | <span class='neutral'>     * NOTE: If `value` is the maximum `uint256`, the allowance is not updated on</span>
 121 |     | <span class='neutral'>     * `transferFrom`. This is semantically equivalent to an infinite approval.</span>
 122 |     | <span class='neutral'>     *</span>
 123 |     | <span class='neutral'>     * Requirements:</span>
 124 |     | <span class='neutral'>     *</span>
 125 |     | <span class='neutral'>     * - `spender` cannot be the zero address.</span>
 126 |     | <span class='neutral'>     */</span>
 127 |     | <span class='unexecuted'>    function approve(address spender, uint256 value) public virtual returns (bool) {</span>
 128 |     | <span class='unexecuted'>        address owner = _msgSender();</span>
 129 |     | <span class='unexecuted'>        _approve(owner, spender, value);</span>
 130 |     | <span class='unexecuted'>        return true;</span>
 131 |     | <span class='neutral'>    }</span>
 132 |     | <span class='neutral'></span>
 133 |     | <span class='neutral'>    /**</span>
 134 |     | <span class='neutral'>     * @dev See {IERC20-transferFrom}.</span>
 135 |     | <span class='neutral'>     *</span>
 136 |     | <span class='neutral'>     * Skips emitting an {Approval} event indicating an allowance update. This is not</span>
 137 |     | <span class='neutral'>     * required by the ERC. See {xref-ERC20-_approve-address-address-uint256-bool-}[_approve].</span>
 138 |     | <span class='neutral'>     *</span>
 139 |     | <span class='neutral'>     * NOTE: Does not update the allowance if the current allowance</span>
 140 |     | <span class='neutral'>     * is the maximum `uint256`.</span>
 141 |     | <span class='neutral'>     *</span>
 142 |     | <span class='neutral'>     * Requirements:</span>
 143 |     | <span class='neutral'>     *</span>
 144 |     | <span class='neutral'>     * - `from` and `to` cannot be the zero address.</span>
 145 |     | <span class='neutral'>     * - `from` must have a balance of at least `value`.</span>
 146 |     | <span class='neutral'>     * - the caller must have allowance for ``from``&#39;s tokens of at least</span>
 147 |     | <span class='neutral'>     * `value`.</span>
 148 |     | <span class='neutral'>     */</span>
 149 |     | <span class='unexecuted'>    function transferFrom(address from, address to, uint256 value) public virtual returns (bool) {</span>
 150 |     | <span class='unexecuted'>        address spender = _msgSender();</span>
 151 |     | <span class='unexecuted'>        _spendAllowance(from, spender, value);</span>
 152 |     | <span class='unexecuted'>        _transfer(from, to, value);</span>
 153 |     | <span class='unexecuted'>        return true;</span>
 154 |     | <span class='neutral'>    }</span>
 155 |     | <span class='neutral'></span>
 156 |     | <span class='neutral'>    /**</span>
 157 |     | <span class='neutral'>     * @dev Moves a `value` amount of tokens from `from` to `to`.</span>
 158 |     | <span class='neutral'>     *</span>
 159 |     | <span class='neutral'>     * This internal function is equivalent to {transfer}, and can be used to</span>
 160 |     | <span class='neutral'>     * e.g. implement automatic token fees, slashing mechanisms, etc.</span>
 161 |     | <span class='neutral'>     *</span>
 162 |     | <span class='neutral'>     * Emits a {Transfer} event.</span>
 163 |     | <span class='neutral'>     *</span>
 164 |     | <span class='neutral'>     * NOTE: This function is not virtual, {_update} should be overridden instead.</span>
 165 |     | <span class='neutral'>     */</span>
 166 |     | <span class='unexecuted'>    function _transfer(address from, address to, uint256 value) internal {</span>
 167 |     | <span class='unexecuted'>        if (from == address(0)) {</span>
 168 |     | <span class='unexecuted'>            revert ERC20InvalidSender(address(0));</span>
 169 |     | <span class='neutral'>        }</span>
 170 |     | <span class='unexecuted'>        if (to == address(0)) {</span>
 171 |     | <span class='unexecuted'>            revert ERC20InvalidReceiver(address(0));</span>
 172 |     | <span class='neutral'>        }</span>
 173 |     | <span class='unexecuted'>        _update(from, to, value);</span>
 174 |     | <span class='neutral'>    }</span>
 175 |     | <span class='neutral'></span>
 176 |     | <span class='neutral'>    /**</span>
 177 |     | <span class='neutral'>     * @dev Transfers a `value` amount of tokens from `from` to `to`, or alternatively mints (or burns) if `from`</span>
 178 |     | <span class='neutral'>     * (or `to`) is the zero address. All customizations to transfers, mints, and burns should be done by overriding</span>
 179 |     | <span class='neutral'>     * this function.</span>
 180 |     | <span class='neutral'>     *</span>
 181 |     | <span class='neutral'>     * Emits a {Transfer} event.</span>
 182 |     | <span class='neutral'>     */</span>
 183 |     | <span class='unexecuted'>    function _update(address from, address to, uint256 value) internal virtual {</span>
 184 |     | <span class='unexecuted'>        if (from == address(0)) {</span>
 185 |     | <span class='neutral'>            // Overflow check required: The rest of the code assumes that totalSupply never overflows</span>
 186 |     | <span class='unexecuted'>            _totalSupply += value;</span>
 187 |     | <span class='unexecuted'>        } else {</span>
 188 |     | <span class='unexecuted'>            uint256 fromBalance = _balances[from];</span>
 189 |     | <span class='unexecuted'>            if (fromBalance &lt; value) {</span>
 190 |     | <span class='unexecuted'>                revert ERC20InsufficientBalance(from, fromBalance, value);</span>
 191 |     | <span class='neutral'>            }</span>
 192 |     | <span class='neutral'>            unchecked {</span>
 193 |     | <span class='neutral'>                // Overflow not possible: value &lt;= fromBalance &lt;= totalSupply.</span>
 194 |     | <span class='unexecuted'>                _balances[from] = fromBalance - value;</span>
 195 |     | <span class='neutral'>            }</span>
 196 |     | <span class='neutral'>        }</span>
 197 |     | <span class='neutral'></span>
 198 |     | <span class='unexecuted'>        if (to == address(0)) {</span>
 199 |     | <span class='neutral'>            unchecked {</span>
 200 |     | <span class='neutral'>                // Overflow not possible: value &lt;= totalSupply or value &lt;= fromBalance &lt;= totalSupply.</span>
 201 |     | <span class='unexecuted'>                _totalSupply -= value;</span>
 202 |     | <span class='neutral'>            }</span>
 203 |     | <span class='neutral'>        } else {</span>
 204 |     | <span class='neutral'>            unchecked {</span>
 205 |     | <span class='neutral'>                // Overflow not possible: balance + value is at most totalSupply, which we know fits into a uint256.</span>
 206 |     | <span class='unexecuted'>                _balances[to] += value;</span>
 207 |     | <span class='neutral'>            }</span>
 208 |     | <span class='neutral'>        }</span>
 209 |     | <span class='neutral'></span>
 210 |     | <span class='unexecuted'>        emit Transfer(from, to, value);</span>
 211 |     | <span class='neutral'>    }</span>
 212 |     | <span class='neutral'></span>
 213 |     | <span class='neutral'>    /**</span>
 214 |     | <span class='neutral'>     * @dev Creates a `value` amount of tokens and assigns them to `account`, by transferring it from address(0).</span>
 215 |     | <span class='neutral'>     * Relies on the `_update` mechanism</span>
 216 |     | <span class='neutral'>     *</span>
 217 |     | <span class='neutral'>     * Emits a {Transfer} event with `from` set to the zero address.</span>
 218 |     | <span class='neutral'>     *</span>
 219 |     | <span class='neutral'>     * NOTE: This function is not virtual, {_update} should be overridden instead.</span>
 220 |     | <span class='neutral'>     */</span>
 221 |     | <span class='unexecuted'>    function _mint(address account, uint256 value) internal {</span>
 222 |     | <span class='unexecuted'>        if (account == address(0)) {</span>
 223 |     | <span class='unexecuted'>            revert ERC20InvalidReceiver(address(0));</span>
 224 |     | <span class='neutral'>        }</span>
 225 |     | <span class='unexecuted'>        _update(address(0), account, value);</span>
 226 |     | <span class='neutral'>    }</span>
 227 |     | <span class='neutral'></span>
 228 |     | <span class='neutral'>    /**</span>
 229 |     | <span class='neutral'>     * @dev Destroys a `value` amount of tokens from `account`, lowering the total supply.</span>
 230 |     | <span class='neutral'>     * Relies on the `_update` mechanism.</span>
 231 |     | <span class='neutral'>     *</span>
 232 |     | <span class='neutral'>     * Emits a {Transfer} event with `to` set to the zero address.</span>
 233 |     | <span class='neutral'>     *</span>
 234 |     | <span class='neutral'>     * NOTE: This function is not virtual, {_update} should be overridden instead</span>
 235 |     | <span class='neutral'>     */</span>
 236 |     | <span class='neutral'>    function _burn(address account, uint256 value) internal {</span>
 237 |     | <span class='neutral'>        if (account == address(0)) {</span>
 238 |     | <span class='neutral'>            revert ERC20InvalidSender(address(0));</span>
 239 |     | <span class='neutral'>        }</span>
 240 |     | <span class='neutral'>        _update(account, address(0), value);</span>
 241 |     | <span class='neutral'>    }</span>
 242 |     | <span class='neutral'></span>
 243 |     | <span class='neutral'>    /**</span>
 244 |     | <span class='neutral'>     * @dev Sets `value` as the allowance of `spender` over the `owner` s tokens.</span>
 245 |     | <span class='neutral'>     *</span>
 246 |     | <span class='neutral'>     * This internal function is equivalent to `approve`, and can be used to</span>
 247 |     | <span class='neutral'>     * e.g. set automatic allowances for certain subsystems, etc.</span>
 248 |     | <span class='neutral'>     *</span>
 249 |     | <span class='neutral'>     * Emits an {Approval} event.</span>
 250 |     | <span class='neutral'>     *</span>
 251 |     | <span class='neutral'>     * Requirements:</span>
 252 |     | <span class='neutral'>     *</span>
 253 |     | <span class='neutral'>     * - `owner` cannot be the zero address.</span>
 254 |     | <span class='neutral'>     * - `spender` cannot be the zero address.</span>
 255 |     | <span class='neutral'>     *</span>
 256 |     | <span class='neutral'>     * Overrides to this logic should be done to the variant with an additional `bool emitEvent` argument.</span>
 257 |     | <span class='neutral'>     */</span>
 258 |     | <span class='unexecuted'>    function _approve(address owner, address spender, uint256 value) internal {</span>
 259 |     | <span class='unexecuted'>        _approve(owner, spender, value, true);</span>
 260 |     | <span class='neutral'>    }</span>
 261 |     | <span class='neutral'></span>
 262 |     | <span class='neutral'>    /**</span>
 263 |     | <span class='neutral'>     * @dev Variant of {_approve} with an optional flag to enable or disable the {Approval} event.</span>
 264 |     | <span class='neutral'>     *</span>
 265 |     | <span class='neutral'>     * By default (when calling {_approve}) the flag is set to true. On the other hand, approval changes made by</span>
 266 |     | <span class='neutral'>     * `_spendAllowance` during the `transferFrom` operation set the flag to false. This saves gas by not emitting any</span>
 267 |     | <span class='neutral'>     * `Approval` event during `transferFrom` operations.</span>
 268 |     | <span class='neutral'>     *</span>
 269 |     | <span class='neutral'>     * Anyone who wishes to continue emitting `Approval` events on the`transferFrom` operation can force the flag to</span>
 270 |     | <span class='neutral'>     * true using the following override:</span>
 271 |     | <span class='neutral'>     *</span>
 272 |     | <span class='neutral'>     * ```solidity</span>
 273 |     | <span class='neutral'>     * function _approve(address owner, address spender, uint256 value, bool) internal virtual override {</span>
 274 |     | <span class='neutral'>     *     super._approve(owner, spender, value, true);</span>
 275 |     | <span class='neutral'>     * }</span>
 276 |     | <span class='neutral'>     * ```</span>
 277 |     | <span class='neutral'>     *</span>
 278 |     | <span class='neutral'>     * Requirements are the same as {_approve}.</span>
 279 |     | <span class='neutral'>     */</span>
 280 |     | <span class='unexecuted'>    function _approve(address owner, address spender, uint256 value, bool emitEvent) internal virtual {</span>
 281 |     | <span class='unexecuted'>        if (owner == address(0)) {</span>
 282 |     | <span class='unexecuted'>            revert ERC20InvalidApprover(address(0));</span>
 283 |     | <span class='neutral'>        }</span>
 284 |     | <span class='unexecuted'>        if (spender == address(0)) {</span>
 285 |     | <span class='unexecuted'>            revert ERC20InvalidSpender(address(0));</span>
 286 |     | <span class='neutral'>        }</span>
 287 |     | <span class='unexecuted'>        _allowances[owner][spender] = value;</span>
 288 |     | <span class='unexecuted'>        if (emitEvent) {</span>
 289 |     | <span class='unexecuted'>            emit Approval(owner, spender, value);</span>
 290 |     | <span class='neutral'>        }</span>
 291 |     | <span class='neutral'>    }</span>
 292 |     | <span class='neutral'></span>
 293 |     | <span class='neutral'>    /**</span>
 294 |     | <span class='neutral'>     * @dev Updates `owner` s allowance for `spender` based on spent `value`.</span>
 295 |     | <span class='neutral'>     *</span>
 296 |     | <span class='neutral'>     * Does not update the allowance value in case of infinite allowance.</span>
 297 |     | <span class='neutral'>     * Revert if not enough allowance is available.</span>
 298 |     | <span class='neutral'>     *</span>
 299 |     | <span class='neutral'>     * Does not emit an {Approval} event.</span>
 300 |     | <span class='neutral'>     */</span>
 301 |     | <span class='unexecuted'>    function _spendAllowance(address owner, address spender, uint256 value) internal virtual {</span>
 302 |     | <span class='unexecuted'>        uint256 currentAllowance = allowance(owner, spender);</span>
 303 |     | <span class='unexecuted'>        if (currentAllowance &lt; type(uint256).max) {</span>
 304 |     | <span class='unexecuted'>            if (currentAllowance &lt; value) {</span>
 305 |     | <span class='unexecuted'>                revert ERC20InsufficientAllowance(spender, currentAllowance, value);</span>
 306 |     | <span class='neutral'>            }</span>
 307 |     | <span class='neutral'>            unchecked {</span>
 308 |     | <span class='unexecuted'>                _approve(owner, spender, currentAllowance - value, false);</span>
 309 |     | <span class='neutral'>            }</span>
 310 |     | <span class='neutral'>        }</span>
 311 |     | <span class='neutral'>    }</span>
 312 |     | <span class='neutral'>}</span>
 313 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/lib/openzeppelin-contracts/contracts/token/ERC20/IERC20.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v5.1.0) (token/ERC20/IERC20.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.20;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>/**</span>
  7 |     | <span class='neutral'> * @dev Interface of the ERC-20 standard as defined in the ERC.</span>
  8 |     | <span class='neutral'> */</span>
  9 |     | <span class='neutral'>interface IERC20 {</span>
 10 |     | <span class='neutral'>    /**</span>
 11 |     | <span class='neutral'>     * @dev Emitted when `value` tokens are moved from one account (`from`) to</span>
 12 |     | <span class='neutral'>     * another (`to`).</span>
 13 |     | <span class='neutral'>     *</span>
 14 |     | <span class='neutral'>     * Note that `value` may be zero.</span>
 15 |     | <span class='neutral'>     */</span>
 16 |     | <span class='neutral'>    event Transfer(address indexed from, address indexed to, uint256 value);</span>
 17 |     | <span class='neutral'></span>
 18 |     | <span class='neutral'>    /**</span>
 19 |     | <span class='neutral'>     * @dev Emitted when the allowance of a `spender` for an `owner` is set by</span>
 20 |     | <span class='neutral'>     * a call to {approve}. `value` is the new allowance.</span>
 21 |     | <span class='neutral'>     */</span>
 22 |     | <span class='neutral'>    event Approval(address indexed owner, address indexed spender, uint256 value);</span>
 23 |     | <span class='neutral'></span>
 24 |     | <span class='neutral'>    /**</span>
 25 |     | <span class='neutral'>     * @dev Returns the value of tokens in existence.</span>
 26 |     | <span class='neutral'>     */</span>
 27 |     | <span class='neutral'>    function totalSupply() external view returns (uint256);</span>
 28 |     | <span class='neutral'></span>
 29 |     | <span class='neutral'>    /**</span>
 30 |     | <span class='neutral'>     * @dev Returns the value of tokens owned by `account`.</span>
 31 |     | <span class='neutral'>     */</span>
 32 |     | <span class='neutral'>    function balanceOf(address account) external view returns (uint256);</span>
 33 |     | <span class='neutral'></span>
 34 |     | <span class='neutral'>    /**</span>
 35 |     | <span class='neutral'>     * @dev Moves a `value` amount of tokens from the caller&#39;s account to `to`.</span>
 36 |     | <span class='neutral'>     *</span>
 37 |     | <span class='neutral'>     * Returns a boolean value indicating whether the operation succeeded.</span>
 38 |     | <span class='neutral'>     *</span>
 39 |     | <span class='neutral'>     * Emits a {Transfer} event.</span>
 40 |     | <span class='neutral'>     */</span>
 41 |     | <span class='neutral'>    function transfer(address to, uint256 value) external returns (bool);</span>
 42 |     | <span class='neutral'></span>
 43 |     | <span class='neutral'>    /**</span>
 44 |     | <span class='neutral'>     * @dev Returns the remaining number of tokens that `spender` will be</span>
 45 |     | <span class='neutral'>     * allowed to spend on behalf of `owner` through {transferFrom}. This is</span>
 46 |     | <span class='neutral'>     * zero by default.</span>
 47 |     | <span class='neutral'>     *</span>
 48 |     | <span class='neutral'>     * This value changes when {approve} or {transferFrom} are called.</span>
 49 |     | <span class='neutral'>     */</span>
 50 |     | <span class='neutral'>    function allowance(address owner, address spender) external view returns (uint256);</span>
 51 |     | <span class='neutral'></span>
 52 |     | <span class='neutral'>    /**</span>
 53 |     | <span class='neutral'>     * @dev Sets a `value` amount of tokens as the allowance of `spender` over the</span>
 54 |     | <span class='neutral'>     * caller&#39;s tokens.</span>
 55 |     | <span class='neutral'>     *</span>
 56 |     | <span class='neutral'>     * Returns a boolean value indicating whether the operation succeeded.</span>
 57 |     | <span class='neutral'>     *</span>
 58 |     | <span class='neutral'>     * IMPORTANT: Beware that changing an allowance with this method brings the risk</span>
 59 |     | <span class='neutral'>     * that someone may use both the old and the new allowance by unfortunate</span>
 60 |     | <span class='neutral'>     * transaction ordering. One possible solution to mitigate this race</span>
 61 |     | <span class='neutral'>     * condition is to first reduce the spender&#39;s allowance to 0 and set the</span>
 62 |     | <span class='neutral'>     * desired value afterwards:</span>
 63 |     | <span class='neutral'>     * https://github.com/ethereum/EIPs/issues/20#issuecomment-263524729</span>
 64 |     | <span class='neutral'>     *</span>
 65 |     | <span class='neutral'>     * Emits an {Approval} event.</span>
 66 |     | <span class='neutral'>     */</span>
 67 |     | <span class='neutral'>    function approve(address spender, uint256 value) external returns (bool);</span>
 68 |     | <span class='neutral'></span>
 69 |     | <span class='neutral'>    /**</span>
 70 |     | <span class='neutral'>     * @dev Moves a `value` amount of tokens from `from` to `to` using the</span>
 71 |     | <span class='neutral'>     * allowance mechanism. `value` is then deducted from the caller&#39;s</span>
 72 |     | <span class='neutral'>     * allowance.</span>
 73 |     | <span class='neutral'>     *</span>
 74 |     | <span class='neutral'>     * Returns a boolean value indicating whether the operation succeeded.</span>
 75 |     | <span class='neutral'>     *</span>
 76 |     | <span class='neutral'>     * Emits a {Transfer} event.</span>
 77 |     | <span class='neutral'>     */</span>
 78 |     | <span class='neutral'>    function transferFrom(address from, address to, uint256 value) external returns (bool);</span>
 79 |     | <span class='neutral'>}</span>
 80 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/lib/openzeppelin-contracts/contracts/token/ERC20/extensions/IERC20Metadata.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v5.1.0) (token/ERC20/extensions/IERC20Metadata.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.20;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>import {IERC20} from &quot;../IERC20.sol&quot;;</span>
  7 |     | <span class='neutral'></span>
  8 |     | <span class='neutral'>/**</span>
  9 |     | <span class='neutral'> * @dev Interface for the optional metadata functions from the ERC-20 standard.</span>
 10 |     | <span class='neutral'> */</span>
 11 |     | <span class='neutral'>interface IERC20Metadata is IERC20 {</span>
 12 |     | <span class='neutral'>    /**</span>
 13 |     | <span class='neutral'>     * @dev Returns the name of the token.</span>
 14 |     | <span class='neutral'>     */</span>
 15 |     | <span class='neutral'>    function name() external view returns (string memory);</span>
 16 |     | <span class='neutral'></span>
 17 |     | <span class='neutral'>    /**</span>
 18 |     | <span class='neutral'>     * @dev Returns the symbol of the token.</span>
 19 |     | <span class='neutral'>     */</span>
 20 |     | <span class='neutral'>    function symbol() external view returns (string memory);</span>
 21 |     | <span class='neutral'></span>
 22 |     | <span class='neutral'>    /**</span>
 23 |     | <span class='neutral'>     * @dev Returns the decimals places of the token.</span>
 24 |     | <span class='neutral'>     */</span>
 25 |     | <span class='neutral'>    function decimals() external view returns (uint8);</span>
 26 |     | <span class='neutral'>}</span>
 27 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/lib/openzeppelin-contracts/contracts/utils/Address.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'></span>
   3 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
   4 |     | <span class='neutral'></span>
   5 |     | <span class='neutral'>/**</span>
   6 |     | <span class='neutral'> * @dev Collection of functions related to the address type</span>
   7 |     | <span class='neutral'> */</span>
   8 |     | <span class='unexecuted'>library Address {</span>
   9 |     | <span class='neutral'>    /**</span>
  10 |     | <span class='neutral'>     * @dev Returns true if `account` is a contract.</span>
  11 |     | <span class='neutral'>     *</span>
  12 |     | <span class='neutral'>     * [IMPORTANT]</span>
  13 |     | <span class='neutral'>     * ====</span>
  14 |     | <span class='neutral'>     * It is unsafe to assume that an address for which this function returns</span>
  15 |     | <span class='neutral'>     * false is an externally-owned account (EOA) and not a contract.</span>
  16 |     | <span class='neutral'>     *</span>
  17 |     | <span class='neutral'>     * Among others, `isContract` will return false for the following</span>
  18 |     | <span class='neutral'>     * types of addresses:</span>
  19 |     | <span class='neutral'>     *</span>
  20 |     | <span class='neutral'>     *  - an externally-owned account</span>
  21 |     | <span class='neutral'>     *  - a contract in construction</span>
  22 |     | <span class='neutral'>     *  - an address where a contract will be created</span>
  23 |     | <span class='neutral'>     *  - an address where a contract lived, but was destroyed</span>
  24 |     | <span class='neutral'>     * ====</span>
  25 |     | <span class='neutral'>     */</span>
  26 | *   | <span class='executed'>    function isContract(address account) internal view returns (bool) {</span>
  27 |     | <span class='neutral'>        // This method relies on extcodesize, which returns 0 for contracts in</span>
  28 |     | <span class='neutral'>        // construction, since the code is only stored at the end of the</span>
  29 |     | <span class='neutral'>        // constructor execution.</span>
  30 |     | <span class='neutral'></span>
  31 | *   | <span class='executed'>        uint256 size;</span>
  32 |     | <span class='neutral'>        assembly {</span>
  33 | *   | <span class='executed'>            size := extcodesize(account)</span>
  34 |     | <span class='neutral'>        }</span>
  35 | *   | <span class='executed'>        return size &gt; 0;</span>
  36 |     | <span class='neutral'>    }</span>
  37 |     | <span class='neutral'></span>
  38 |     | <span class='neutral'>    /**</span>
  39 |     | <span class='neutral'>     * @dev Replacement for Solidity&#39;s `transfer`: sends `amount` wei to</span>
  40 |     | <span class='neutral'>     * `recipient`, forwarding all available gas and reverting on errors.</span>
  41 |     | <span class='neutral'>     *</span>
  42 |     | <span class='neutral'>     * https://eips.ethereum.org/EIPS/eip-1884[EIP1884] increases the gas cost</span>
  43 |     | <span class='neutral'>     * of certain opcodes, possibly making contracts go over the 2300 gas limit</span>
  44 |     | <span class='neutral'>     * imposed by `transfer`, making them unable to receive funds via</span>
  45 |     | <span class='neutral'>     * `transfer`. {sendValue} removes this limitation.</span>
  46 |     | <span class='neutral'>     *</span>
  47 |     | <span class='neutral'>     * https://diligence.consensys.net/posts/2019/09/stop-using-soliditys-transfer-now/[Learn more].</span>
  48 |     | <span class='neutral'>     *</span>
  49 |     | <span class='neutral'>     * IMPORTANT: because control is transferred to `recipient`, care must be</span>
  50 |     | <span class='neutral'>     * taken to not create reentrancy vulnerabilities. Consider using</span>
  51 |     | <span class='neutral'>     * {ReentrancyGuard} or the</span>
  52 |     | <span class='neutral'>     * https://solidity.readthedocs.io/en/v0.5.11/security-considerations.html#use-the-checks-effects-interactions-pattern[checks-effects-interactions pattern].</span>
  53 |     | <span class='neutral'>     */</span>
  54 | *   | <span class='executed'>    function sendValue(address payable recipient, uint256 amount) internal {</span>
  55 | *   | <span class='executed'>        require(address(this).balance &gt;= amount, &quot;Address: insufficient balance&quot;);</span>
  56 |     | <span class='neutral'></span>
  57 | *   | <span class='executed'>        (bool success, ) = recipient.call{value: amount}(&quot;&quot;);</span>
  58 | *   | <span class='executed'>        require(success, &quot;Address: unable to send value, recipient may have reverted&quot;);</span>
  59 |     | <span class='neutral'>    }</span>
  60 |     | <span class='neutral'></span>
  61 |     | <span class='neutral'>    /**</span>
  62 |     | <span class='neutral'>     * @dev Performs a Solidity function call using a low level `call`. A</span>
  63 |     | <span class='neutral'>     * plain `call` is an unsafe replacement for a function call: use this</span>
  64 |     | <span class='neutral'>     * function instead.</span>
  65 |     | <span class='neutral'>     *</span>
  66 |     | <span class='neutral'>     * If `target` reverts with a revert reason, it is bubbled up by this</span>
  67 |     | <span class='neutral'>     * function (like regular Solidity function calls).</span>
  68 |     | <span class='neutral'>     *</span>
  69 |     | <span class='neutral'>     * Returns the raw returned data. To convert to the expected return value,</span>
  70 |     | <span class='neutral'>     * use https://solidity.readthedocs.io/en/latest/units-and-global-variables.html?highlight=abi.decode#abi-encoding-and-decoding-functions[`abi.decode`].</span>
  71 |     | <span class='neutral'>     *</span>
  72 |     | <span class='neutral'>     * Requirements:</span>
  73 |     | <span class='neutral'>     *</span>
  74 |     | <span class='neutral'>     * - `target` must be a contract.</span>
  75 |     | <span class='neutral'>     * - calling `target` with `data` must not revert.</span>
  76 |     | <span class='neutral'>     *</span>
  77 |     | <span class='neutral'>     * _Available since v3.1._</span>
  78 |     | <span class='neutral'>     */</span>
  79 |     | <span class='neutral'>    function functionCall(address target, bytes memory data) internal returns (bytes memory) {</span>
  80 |     | <span class='neutral'>        return functionCall(target, data, &quot;Address: low-level call failed&quot;);</span>
  81 |     | <span class='neutral'>    }</span>
  82 |     | <span class='neutral'></span>
  83 |     | <span class='neutral'>    /**</span>
  84 |     | <span class='neutral'>     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`], but with</span>
  85 |     | <span class='neutral'>     * `errorMessage` as a fallback revert reason when `target` reverts.</span>
  86 |     | <span class='neutral'>     *</span>
  87 |     | <span class='neutral'>     * _Available since v3.1._</span>
  88 |     | <span class='neutral'>     */</span>
  89 |     | <span class='neutral'>    function functionCall(</span>
  90 |     | <span class='neutral'>        address target,</span>
  91 |     | <span class='neutral'>        bytes memory data,</span>
  92 |     | <span class='neutral'>        string memory errorMessage</span>
  93 |     | <span class='neutral'>    ) internal returns (bytes memory) {</span>
  94 |     | <span class='neutral'>        return functionCallWithValue(target, data, 0, errorMessage);</span>
  95 |     | <span class='neutral'>    }</span>
  96 |     | <span class='neutral'></span>
  97 |     | <span class='neutral'>    /**</span>
  98 |     | <span class='neutral'>     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],</span>
  99 |     | <span class='neutral'>     * but also transferring `value` wei to `target`.</span>
 100 |     | <span class='neutral'>     *</span>
 101 |     | <span class='neutral'>     * Requirements:</span>
 102 |     | <span class='neutral'>     *</span>
 103 |     | <span class='neutral'>     * - the calling contract must have an ETH balance of at least `value`.</span>
 104 |     | <span class='neutral'>     * - the called Solidity function must be `payable`.</span>
 105 |     | <span class='neutral'>     *</span>
 106 |     | <span class='neutral'>     * _Available since v3.1._</span>
 107 |     | <span class='neutral'>     */</span>
 108 | *   | <span class='executed'>    function functionCallWithValue(</span>
 109 |     | <span class='neutral'>        address target,</span>
 110 |     | <span class='neutral'>        bytes memory data,</span>
 111 |     | <span class='neutral'>        uint256 value</span>
 112 | *   | <span class='executed'>    ) internal returns (bytes memory) {</span>
 113 | *   | <span class='executed'>        return functionCallWithValue(target, data, value, &quot;Address: low-level call with value failed&quot;);</span>
 114 |     | <span class='neutral'>    }</span>
 115 |     | <span class='neutral'></span>
 116 |     | <span class='neutral'>    /**</span>
 117 |     | <span class='neutral'>     * @dev Same as {xref-Address-functionCallWithValue-address-bytes-uint256-}[`functionCallWithValue`], but</span>
 118 |     | <span class='neutral'>     * with `errorMessage` as a fallback revert reason when `target` reverts.</span>
 119 |     | <span class='neutral'>     *</span>
 120 |     | <span class='neutral'>     * _Available since v3.1._</span>
 121 |     | <span class='neutral'>     */</span>
 122 | *   | <span class='executed'>    function functionCallWithValue(</span>
 123 |     | <span class='neutral'>        address target,</span>
 124 |     | <span class='neutral'>        bytes memory data,</span>
 125 |     | <span class='neutral'>        uint256 value,</span>
 126 |     | <span class='neutral'>        string memory errorMessage</span>
 127 | *   | <span class='executed'>    ) internal returns (bytes memory) {</span>
 128 | *   | <span class='executed'>        require(address(this).balance &gt;= value, &quot;Address: insufficient balance for call&quot;);</span>
 129 | *   | <span class='executed'>        require(isContract(target), &quot;Address: call to non-contract&quot;);</span>
 130 |     | <span class='neutral'></span>
 131 | *   | <span class='executed'>        (bool success, bytes memory returndata) = target.call{value: value}(data);</span>
 132 | *   | <span class='executed'>        return verifyCallResult(success, returndata, errorMessage);</span>
 133 |     | <span class='neutral'>    }</span>
 134 |     | <span class='neutral'></span>
 135 |     | <span class='neutral'>    /**</span>
 136 |     | <span class='neutral'>     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],</span>
 137 |     | <span class='neutral'>     * but performing a static call.</span>
 138 |     | <span class='neutral'>     *</span>
 139 |     | <span class='neutral'>     * _Available since v3.3._</span>
 140 |     | <span class='neutral'>     */</span>
 141 |     | <span class='neutral'>    function functionStaticCall(address target, bytes memory data) internal view returns (bytes memory) {</span>
 142 |     | <span class='neutral'>        return functionStaticCall(target, data, &quot;Address: low-level static call failed&quot;);</span>
 143 |     | <span class='neutral'>    }</span>
 144 |     | <span class='neutral'></span>
 145 |     | <span class='neutral'>    /**</span>
 146 |     | <span class='neutral'>     * @dev Same as {xref-Address-functionCall-address-bytes-string-}[`functionCall`],</span>
 147 |     | <span class='neutral'>     * but performing a static call.</span>
 148 |     | <span class='neutral'>     *</span>
 149 |     | <span class='neutral'>     * _Available since v3.3._</span>
 150 |     | <span class='neutral'>     */</span>
 151 |     | <span class='neutral'>    function functionStaticCall(</span>
 152 |     | <span class='neutral'>        address target,</span>
 153 |     | <span class='neutral'>        bytes memory data,</span>
 154 |     | <span class='neutral'>        string memory errorMessage</span>
 155 |     | <span class='neutral'>    ) internal view returns (bytes memory) {</span>
 156 |     | <span class='neutral'>        require(isContract(target), &quot;Address: static call to non-contract&quot;);</span>
 157 |     | <span class='neutral'></span>
 158 |     | <span class='neutral'>        (bool success, bytes memory returndata) = target.staticcall(data);</span>
 159 |     | <span class='neutral'>        return verifyCallResult(success, returndata, errorMessage);</span>
 160 |     | <span class='neutral'>    }</span>
 161 |     | <span class='neutral'></span>
 162 |     | <span class='neutral'>    /**</span>
 163 |     | <span class='neutral'>     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],</span>
 164 |     | <span class='neutral'>     * but performing a delegate call.</span>
 165 |     | <span class='neutral'>     *</span>
 166 |     | <span class='neutral'>     * _Available since v3.4._</span>
 167 |     | <span class='neutral'>     */</span>
 168 |     | <span class='neutral'>    function functionDelegateCall(address target, bytes memory data) internal returns (bytes memory) {</span>
 169 |     | <span class='neutral'>        return functionDelegateCall(target, data, &quot;Address: low-level delegate call failed&quot;);</span>
 170 |     | <span class='neutral'>    }</span>
 171 |     | <span class='neutral'></span>
 172 |     | <span class='neutral'>    /**</span>
 173 |     | <span class='neutral'>     * @dev Same as {xref-Address-functionCall-address-bytes-string-}[`functionCall`],</span>
 174 |     | <span class='neutral'>     * but performing a delegate call.</span>
 175 |     | <span class='neutral'>     *</span>
 176 |     | <span class='neutral'>     * _Available since v3.4._</span>
 177 |     | <span class='neutral'>     */</span>
 178 |     | <span class='neutral'>    function functionDelegateCall(</span>
 179 |     | <span class='neutral'>        address target,</span>
 180 |     | <span class='neutral'>        bytes memory data,</span>
 181 |     | <span class='neutral'>        string memory errorMessage</span>
 182 |     | <span class='neutral'>    ) internal returns (bytes memory) {</span>
 183 |     | <span class='neutral'>        require(isContract(target), &quot;Address: delegate call to non-contract&quot;);</span>
 184 |     | <span class='neutral'></span>
 185 |     | <span class='neutral'>        (bool success, bytes memory returndata) = target.delegatecall(data);</span>
 186 |     | <span class='neutral'>        return verifyCallResult(success, returndata, errorMessage);</span>
 187 |     | <span class='neutral'>    }</span>
 188 |     | <span class='neutral'></span>
 189 |     | <span class='neutral'>    /**</span>
 190 |     | <span class='neutral'>     * @dev Tool to verifies that a low level call was successful, and revert if it wasn&#39;t, either by bubbling the</span>
 191 |     | <span class='neutral'>     * revert reason using the provided one.</span>
 192 |     | <span class='neutral'>     *</span>
 193 |     | <span class='neutral'>     * _Available since v4.3._</span>
 194 |     | <span class='neutral'>     */</span>
 195 | *   | <span class='executed'>    function verifyCallResult(</span>
 196 |     | <span class='neutral'>        bool success,</span>
 197 |     | <span class='neutral'>        bytes memory returndata,</span>
 198 |     | <span class='neutral'>        string memory errorMessage</span>
 199 | *   | <span class='executed'>    ) internal pure returns (bytes memory) {</span>
 200 | *   | <span class='executed'>        if (success) {</span>
 201 | *   | <span class='executed'>            return returndata;</span>
 202 |     | <span class='neutral'>        } else {</span>
 203 |     | <span class='neutral'>            // Look for revert reason and bubble it up if present</span>
 204 | *   | <span class='executed'>            if (returndata.length &gt; 0) {</span>
 205 |     | <span class='neutral'>                // The easiest way to bubble the revert reason is using memory via assembly</span>
 206 |     | <span class='neutral'></span>
 207 |     | <span class='neutral'>                assembly {</span>
 208 |     | <span class='unexecuted'>                    let returndata_size := mload(returndata)</span>
 209 |     | <span class='unexecuted'>                    revert(add(32, returndata), returndata_size)</span>
 210 |     | <span class='neutral'>                }</span>
 211 |     | <span class='neutral'>            } else {</span>
 212 | *r  | <span class='executed'>                revert(errorMessage);</span>
 213 |     | <span class='neutral'>            }</span>
 214 |     | <span class='neutral'>        }</span>
 215 |     | <span class='neutral'>    }</span>
 216 |     | <span class='neutral'>}</span>
 217 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/lib/openzeppelin-contracts/contracts/utils/Context.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v5.0.1) (utils/Context.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.20;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>/**</span>
  7 |     | <span class='neutral'> * @dev Provides information about the current execution context, including the</span>
  8 |     | <span class='neutral'> * sender of the transaction and its data. While these are generally available</span>
  9 |     | <span class='neutral'> * via msg.sender and msg.data, they should not be accessed in such a direct</span>
 10 |     | <span class='neutral'> * manner, since when dealing with meta-transactions the account sending and</span>
 11 |     | <span class='neutral'> * paying for execution may not be the actual sender (as far as an application</span>
 12 |     | <span class='neutral'> * is concerned).</span>
 13 |     | <span class='neutral'> *</span>
 14 |     | <span class='neutral'> * This contract is only required for intermediate, library-like contracts.</span>
 15 |     | <span class='neutral'> */</span>
 16 |     | <span class='neutral'>abstract contract Context {</span>
 17 |     | <span class='unexecuted'>    function _msgSender() internal view virtual returns (address) {</span>
 18 |     | <span class='unexecuted'>        return msg.sender;</span>
 19 |     | <span class='neutral'>    }</span>
 20 |     | <span class='neutral'></span>
 21 |     | <span class='neutral'>    function _msgData() internal view virtual returns (bytes calldata) {</span>
 22 |     | <span class='neutral'>        return msg.data;</span>
 23 |     | <span class='neutral'>    }</span>
 24 |     | <span class='neutral'></span>
 25 |     | <span class='neutral'>    function _contextSuffixLength() internal view virtual returns (uint256) {</span>
 26 |     | <span class='neutral'>        return 0;</span>
 27 |     | <span class='neutral'>    }</span>
 28 |     | <span class='neutral'>}</span>
 29 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/lib/openzeppelin-contracts/contracts/utils/ReentrancyGuard.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v5.1.0) (utils/ReentrancyGuard.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.20;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>/**</span>
  7 |     | <span class='neutral'> * @dev Contract module that helps prevent reentrant calls to a function.</span>
  8 |     | <span class='neutral'> *</span>
  9 |     | <span class='neutral'> * Inheriting from `ReentrancyGuard` will make the {nonReentrant} modifier</span>
 10 |     | <span class='neutral'> * available, which can be applied to functions to make sure there are no nested</span>
 11 |     | <span class='neutral'> * (reentrant) calls to them.</span>
 12 |     | <span class='neutral'> *</span>
 13 |     | <span class='neutral'> * Note that because there is a single `nonReentrant` guard, functions marked as</span>
 14 |     | <span class='neutral'> * `nonReentrant` may not call one another. This can be worked around by making</span>
 15 |     | <span class='neutral'> * those functions `private`, and then adding `external` `nonReentrant` entry</span>
 16 |     | <span class='neutral'> * points to them.</span>
 17 |     | <span class='neutral'> *</span>
 18 |     | <span class='neutral'> * TIP: If EIP-1153 (transient storage) is available on the chain you&#39;re deploying at,</span>
 19 |     | <span class='neutral'> * consider using {ReentrancyGuardTransient} instead.</span>
 20 |     | <span class='neutral'> *</span>
 21 |     | <span class='neutral'> * TIP: If you would like to learn more about reentrancy and alternative ways</span>
 22 |     | <span class='neutral'> * to protect against it, check out our blog post</span>
 23 |     | <span class='neutral'> * https://blog.openzeppelin.com/reentrancy-after-istanbul/[Reentrancy After Istanbul].</span>
 24 |     | <span class='neutral'> */</span>
 25 |     | <span class='neutral'>abstract contract ReentrancyGuard {</span>
 26 |     | <span class='neutral'>    // Booleans are more expensive than uint256 or any type that takes up a full</span>
 27 |     | <span class='neutral'>    // word because each write operation emits an extra SLOAD to first read the</span>
 28 |     | <span class='neutral'>    // slot&#39;s contents, replace the bits taken up by the boolean, and then write</span>
 29 |     | <span class='neutral'>    // back. This is the compiler&#39;s defense against contract upgrades and</span>
 30 |     | <span class='neutral'>    // pointer aliasing, and it cannot be disabled.</span>
 31 |     | <span class='neutral'></span>
 32 |     | <span class='neutral'>    // The values being non-zero value makes deployment a bit more expensive,</span>
 33 |     | <span class='neutral'>    // but in exchange the refund on every call to nonReentrant will be lower in</span>
 34 |     | <span class='neutral'>    // amount. Since refunds are capped to a percentage of the total</span>
 35 |     | <span class='neutral'>    // transaction&#39;s gas, it is best to keep them low in cases like this one, to</span>
 36 |     | <span class='neutral'>    // increase the likelihood of the full refund coming into effect.</span>
 37 | *   | <span class='executed'>    uint256 private constant NOT_ENTERED = 1;</span>
 38 | *   | <span class='executed'>    uint256 private constant ENTERED = 2;</span>
 39 |     | <span class='neutral'></span>
 40 |     | <span class='neutral'>    uint256 private _status;</span>
 41 |     | <span class='neutral'></span>
 42 |     | <span class='neutral'>    /**</span>
 43 |     | <span class='neutral'>     * @dev Unauthorized reentrant call.</span>
 44 |     | <span class='neutral'>     */</span>
 45 |     | <span class='neutral'>    error ReentrancyGuardReentrantCall();</span>
 46 |     | <span class='neutral'></span>
 47 |     | <span class='neutral'>    constructor() {</span>
 48 | *   | <span class='executed'>        _status = NOT_ENTERED;</span>
 49 |     | <span class='neutral'>    }</span>
 50 |     | <span class='neutral'></span>
 51 |     | <span class='neutral'>    /**</span>
 52 |     | <span class='neutral'>     * @dev Prevents a contract from calling itself, directly or indirectly.</span>
 53 |     | <span class='neutral'>     * Calling a `nonReentrant` function from another `nonReentrant`</span>
 54 |     | <span class='neutral'>     * function is not supported. It is possible to prevent this from happening</span>
 55 |     | <span class='neutral'>     * by making the `nonReentrant` function external, and making it call a</span>
 56 |     | <span class='neutral'>     * `private` function that does the actual work.</span>
 57 |     | <span class='neutral'>     */</span>
 58 |     | <span class='neutral'>    modifier nonReentrant() {</span>
 59 | *   | <span class='executed'>        _nonReentrantBefore();</span>
 60 |     | <span class='neutral'>        _;</span>
 61 | *   | <span class='executed'>        _nonReentrantAfter();</span>
 62 |     | <span class='neutral'>    }</span>
 63 |     | <span class='neutral'></span>
 64 | *   | <span class='executed'>    function _nonReentrantBefore() private {</span>
 65 |     | <span class='neutral'>        // On the first call to nonReentrant, _status will be NOT_ENTERED</span>
 66 | *   | <span class='executed'>        if (_status == ENTERED) {</span>
 67 |     | <span class='unexecuted'>            revert ReentrancyGuardReentrantCall();</span>
 68 |     | <span class='neutral'>        }</span>
 69 |     | <span class='neutral'></span>
 70 |     | <span class='neutral'>        // Any calls to nonReentrant after this point will fail</span>
 71 | *   | <span class='executed'>        _status = ENTERED;</span>
 72 |     | <span class='neutral'>    }</span>
 73 |     | <span class='neutral'></span>
 74 | *   | <span class='executed'>    function _nonReentrantAfter() private {</span>
 75 |     | <span class='neutral'>        // By storing the original value once again, a refund is triggered (see</span>
 76 |     | <span class='neutral'>        // https://eips.ethereum.org/EIPS/eip-2200)</span>
 77 | *   | <span class='executed'>        _status = NOT_ENTERED;</span>
 78 |     | <span class='neutral'>    }</span>
 79 |     | <span class='neutral'></span>
 80 |     | <span class='neutral'>    /**</span>
 81 |     | <span class='neutral'>     * @dev Returns true if the reentrancy guard is currently set to &quot;entered&quot;, which indicates there is a</span>
 82 |     | <span class='neutral'>     * `nonReentrant` function in the call stack.</span>
 83 |     | <span class='neutral'>     */</span>
 84 |     | <span class='neutral'>    function _reentrancyGuardEntered() internal view returns (bool) {</span>
 85 |     | <span class='neutral'>        return _status == ENTERED;</span>
 86 |     | <span class='neutral'>    }</span>
 87 |     | <span class='neutral'>}</span>
 88 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise1/testToken.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>import &quot;./token.sol&quot;;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'></span>
  7 |     | <span class='unexecuted'>contract testToken is Token {</span>
  8 |     | <span class='neutral'></span>
  9 |     | <span class='neutral'>    // Token  public token;</span>
 10 |     | <span class='neutral'>    // User user;</span>
 11 |     | <span class='unexecuted'>    address user = msg.sender;</span>
 12 |     | <span class='unexecuted'>    constructor (){</span>
 13 |     | <span class='neutral'>        // token = new Token();</span>
 14 |     | <span class='neutral'>        // user  = new User();</span>
 15 |     | <span class='neutral'></span>
 16 |     | <span class='neutral'>        // token.transfer();</span>
 17 |     | <span class='neutral'>        // token.balances(user) = 10000;</span>
 18 |     | <span class='unexecuted'>        balances[user] = 10_000;</span>
 19 |     | <span class='neutral'>    }</span>
 20 |     | <span class='neutral'></span>
 21 |     | <span class='unexecuted'>    function echidna_test_Balances() public view returns(bool) {</span>
 22 |     | <span class='neutral'>        // assert(balances(user) &lt;= 10000);</span>
 23 |     | <span class='unexecuted'>        return balances[user] &lt;= 10000;</span>
 24 |     | <span class='neutral'>    }</span>
 25 |     | <span class='neutral'>}</span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise1/token.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='unexecuted'>contract Ownable {</span>
  5 |     | <span class='unexecuted'>    address public owner = msg.sender;</span>
  6 |     | <span class='neutral'></span>
  7 |     | <span class='neutral'>    modifier onlyOwner() {</span>
  8 |     | <span class='unexecuted'>        require(msg.sender == owner, &quot;Ownable: Caller is not the owner.&quot;);</span>
  9 |     | <span class='neutral'>        _;</span>
 10 |     | <span class='neutral'>    }</span>
 11 |     | <span class='neutral'>}</span>
 12 |     | <span class='neutral'></span>
 13 |     | <span class='unexecuted'>contract Pausable is Ownable {</span>
 14 |     | <span class='neutral'>    bool private _paused;</span>
 15 |     | <span class='neutral'></span>
 16 |     | <span class='unexecuted'>    function paused() public view returns (bool) {</span>
 17 |     | <span class='unexecuted'>        return _paused;</span>
 18 |     | <span class='neutral'>    }</span>
 19 |     | <span class='neutral'></span>
 20 |     | <span class='unexecuted'>    function pause() public onlyOwner {</span>
 21 |     | <span class='unexecuted'>        _paused = true;</span>
 22 |     | <span class='neutral'>    }</span>
 23 |     | <span class='neutral'></span>
 24 |     | <span class='unexecuted'>    function resume() public onlyOwner {</span>
 25 |     | <span class='unexecuted'>        _paused = false;</span>
 26 |     | <span class='neutral'>    }</span>
 27 |     | <span class='neutral'></span>
 28 |     | <span class='neutral'>    modifier whenNotPaused() {</span>
 29 |     | <span class='unexecuted'>        require(!_paused, &quot;Pausable: Contract is paused.&quot;);</span>
 30 |     | <span class='neutral'>        _;</span>
 31 |     | <span class='neutral'>    }</span>
 32 |     | <span class='neutral'>}</span>
 33 |     | <span class='neutral'></span>
 34 |     | <span class='unexecuted'>contract Token is Ownable, Pausable {</span>
 35 |     | <span class='unexecuted'>    mapping(address =&gt; uint256) public balances;</span>
 36 |     | <span class='neutral'></span>
 37 |     | <span class='unexecuted'>    function transfer(address to, uint256 value) public whenNotPaused {</span>
 38 |     | <span class='neutral'>        // unchecked to save gas</span>
 39 |     | <span class='neutral'>        // require(balances[msg.sender] &gt;= value, &quot;Insufficient balance&quot;);</span>
 40 |     | <span class='neutral'>        // @audit just remove the below unchecked one because it is causing and underflow issue or add above require statement</span>
 41 |     | <span class='neutral'>        // unchecked {</span>
 42 |     | <span class='unexecuted'>            balances[msg.sender] -= value;</span>
 43 |     | <span class='unexecuted'>            balances[to] += value;</span>
 44 |     | <span class='neutral'>        // }</span>
 45 |     | <span class='neutral'>    }</span>
 46 |     | <span class='neutral'>}</span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise2/testToken.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>import &quot;./token.sol&quot;;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>// pause i called at deployment</span>
  7 |     | <span class='neutral'>// Remove Ownership</span>
  8 |     | <span class='neutral'></span>
  9 |     | <span class='neutral'></span>
 10 |     | <span class='unexecuted'>contract testToken is Token {</span>
 11 |     | <span class='neutral'></span>
 12 |     | <span class='neutral'>    // address constant USER_1 = 0x9876543210987654321098765432109876543210;</span>
 13 |     | <span class='unexecuted'>    constructor () {</span>
 14 |     | <span class='unexecuted'>        paused();</span>
 15 |     | <span class='unexecuted'>        owner = address(0);</span>
 16 |     | <span class='neutral'></span>
 17 |     | <span class='neutral'>    }</span>
 18 |     | <span class='neutral'></span>
 19 |     | <span class='neutral'>    // function echidna_test_cannot_be_unpaused() public view returns(bool) {</span>
 20 |     | <span class='neutral'>    //     return balances[USER_1] == 0;</span>
 21 |     | <span class='neutral'>    // }</span>
 22 |     | <span class='neutral'></span>
 23 |     | <span class='unexecuted'>    function echidna_unpause() public view returns(bool){</span>
 24 |     | <span class='unexecuted'>        return (paused() == true);</span>
 25 |     | <span class='neutral'>    }</span>
 26 |     | <span class='neutral'>}</span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise2/token.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='unexecuted'>contract Ownable {</span>
  5 |     | <span class='unexecuted'>    address public owner = msg.sender;</span>
  6 |     | <span class='neutral'>    // @audit To fix the bug we should only remove the below function  </span>
  7 |     | <span class='neutral'></span>
  8 |     | <span class='neutral'></span>
  9 |     | <span class='neutral'>    // function Owner() public {</span>
 10 |     | <span class='neutral'>    //     owner = msg.sender;</span>
 11 |     | <span class='neutral'>    // }</span>
 12 |     | <span class='neutral'></span>
 13 |     | <span class='neutral'>    modifier onlyOwner() {</span>
 14 |     | <span class='unexecuted'>        require(owner == msg.sender);</span>
 15 |     | <span class='neutral'>        _;</span>
 16 |     | <span class='neutral'>    }</span>
 17 |     | <span class='neutral'>}</span>
 18 |     | <span class='neutral'></span>
 19 |     | <span class='unexecuted'>contract Pausable is Ownable {</span>
 20 |     | <span class='neutral'>    bool private _paused;</span>
 21 |     | <span class='neutral'></span>
 22 |     | <span class='unexecuted'>    function paused() public view returns (bool) {</span>
 23 |     | <span class='unexecuted'>        return _paused;</span>
 24 |     | <span class='neutral'>    }</span>
 25 |     | <span class='neutral'></span>
 26 |     | <span class='unexecuted'>    function pause() public onlyOwner {</span>
 27 |     | <span class='unexecuted'>        _paused = true;</span>
 28 |     | <span class='neutral'>    }</span>
 29 |     | <span class='neutral'></span>
 30 |     | <span class='unexecuted'>    function resume() public onlyOwner {</span>
 31 |     | <span class='unexecuted'>        _paused = false;</span>
 32 |     | <span class='neutral'>    }</span>
 33 |     | <span class='neutral'></span>
 34 |     | <span class='neutral'>    modifier whenNotPaused() {</span>
 35 |     | <span class='unexecuted'>        require(!_paused, &quot;Pausable: Contract is paused.&quot;);</span>
 36 |     | <span class='neutral'>        _;</span>
 37 |     | <span class='neutral'>    }</span>
 38 |     | <span class='neutral'>}</span>
 39 |     | <span class='neutral'></span>
 40 |     | <span class='unexecuted'>contract Token is Ownable, Pausable {</span>
 41 |     | <span class='unexecuted'>    mapping(address =&gt; uint256) public balances;</span>
 42 |     | <span class='neutral'></span>
 43 |     | <span class='unexecuted'>    function transfer(address to, uint256 value) public whenNotPaused {</span>
 44 |     | <span class='unexecuted'>        balances[msg.sender] -= value;</span>
 45 |     | <span class='unexecuted'>        balances[to] += value;</span>
 46 |     | <span class='neutral'>    }</span>
 47 |     | <span class='neutral'>}</span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise3/mintable.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>import &quot;./token.sol&quot;;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='unexecuted'>contract MintableToken is Token {</span>
  7 |     | <span class='unexecuted'>    int256 public totalMinted;</span>
  8 |     | <span class='unexecuted'>    int256 public totalMintable;</span>
  9 |     | <span class='neutral'></span>
 10 |     | <span class='unexecuted'>    constructor(int256 totalMintable_) {</span>
 11 |     | <span class='unexecuted'>        totalMintable = totalMintable_;</span>
 12 |     | <span class='neutral'>    }</span>
 13 |     | <span class='neutral'></span>
 14 |     | <span class='neutral'>    //@audit To prevent this type of bug, you must ensure that value is always within the valid range of int256 before performing the cast. Add an explicit check for value:</span>
 15 |     | <span class='neutral'></span>
 16 |     | <span class='neutral'>    // function mint(uint256 value) public onlyOwner {</span>
 17 |     | <span class='neutral'>    //     require(value &lt;= uint256(type(int256).max), &quot;Value exceeds int256 range&quot;);</span>
 18 |     | <span class='neutral'>    //     require(int256(value) + totalMinted &lt;= totalMintable, &quot;Mint exceeds total mintable tokens&quot;);</span>
 19 |     | <span class='neutral'></span>
 20 |     | <span class='neutral'>    //     totalMinted += int256(value);</span>
 21 |     | <span class='neutral'>    //     balances[msg.sender] += value;</span>
 22 |     | <span class='neutral'>    // }</span>
 23 |     | <span class='neutral'></span>
 24 |     | <span class='unexecuted'>    function mint(uint256 value) public onlyOwner {</span>
 25 |     | <span class='unexecuted'>        require(int256(value) + totalMinted &lt; totalMintable);</span>
 26 |     | <span class='neutral'>        // require(value &lt;=  uint256(type(int256).max) , &quot;Value more than the int256 &quot;);</span>
 27 |     | <span class='unexecuted'>        totalMinted += int256(value);</span>
 28 |     | <span class='neutral'></span>
 29 |     | <span class='unexecuted'>        balances[msg.sender] += value;</span>
 30 |     | <span class='neutral'>    }</span>
 31 |     | <span class='neutral'></span>
 32 |     | <span class='neutral'>}</span>
 33 |     | <span class='neutral'>    // @audit i think their are two invariant here</span>
 34 |     | <span class='neutral'>    // 1. will be that the balances of the mag.sender should never greater than totalMinted</span>
 35 |     | <span class='neutral'>    // 2. will be that the totalMintable &gt; totalMinted </span>
 36 |     | <span class='neutral'>    // 3. See if the user can mint more that what is the limit </span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise3/testToken.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'></span>
  5 |     | <span class='neutral'>import &quot;./mintable.sol&quot;;</span>
  6 |     | <span class='neutral'></span>
  7 |     | <span class='unexecuted'>contract testToken is MintableToken {</span>
  8 |     | <span class='neutral'></span>
  9 |     | <span class='neutral'>    // Create a scenario where echidna (tx.origin) becomes the owner of the contract at construction, and totalMintable is set to 10,000. Remember that Echidna needs a constructor without arguments.</span>
 10 |     | <span class='neutral'>    // Add a property to check if echidna can mint more than 10,000 tokens.</span>
 11 |     | <span class='neutral'>    // Once Echidna finds the bug, fix the issue, and re-try your property with Echidna.</span>
 12 |     | <span class='neutral'></span>
 13 |     | <span class='neutral'>    // @audit i think their are two invariant here</span>
 14 |     | <span class='neutral'>    // 1. will be that the balances of the msg.sender should never greater than totalMinted</span>
 15 |     | <span class='neutral'>    // 2. will be that the totalMintable &gt; totalMinted </span>
 16 |     | <span class='neutral'>    // 3. See if the user can mint more that what is the limit </span>
 17 |     | <span class='neutral'></span>
 18 |     | <span class='unexecuted'>    address user = msg.sender;</span>
 19 |     | <span class='neutral'></span>
 20 |     | <span class='unexecuted'>    constructor () MintableToken(10000) {</span>
 21 |     | <span class='unexecuted'>        owner = user;</span>
 22 |     | <span class='neutral'>    }</span>
 23 |     | <span class='neutral'></span>
 24 |     | <span class='unexecuted'>    function echidna_user_can_mint_more_than_totalMintable() public view returns(bool) {</span>
 25 |     | <span class='neutral'>        // return totalMinted &lt; 10000;</span>
 26 |     | <span class='unexecuted'>        return balances[msg.sender] &lt;= 10_000;</span>
 27 |     | <span class='neutral'>    }</span>
 28 |     | <span class='neutral'>    // Below test could have been also performed bu the thing is than you should change the code in the mintable.sol</span>
 29 |     | <span class='neutral'>    // at line 29 --  balances[msg.sender] += value; to balances[owner] += value;</span>
 30 |     | <span class='neutral'>    // function echidna_bal_ofuser_not_greater_than_totalMinted() public view returns(bool){</span>
 31 |     | <span class='neutral'>    //     return int256(balances[owner]) == totalMinted;</span>
 32 |     | <span class='neutral'>    //     // return totalMinted &lt;= totalMintable;</span>
 33 |     | <span class='neutral'>    // }</span>
 34 |     | <span class='neutral'>}</span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise3/token.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>/// @notice The issues from exercise 1 and 2 are fixed.</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='unexecuted'>contract Ownable {</span>
  7 |     | <span class='unexecuted'>    address public owner = msg.sender;</span>
  8 |     | <span class='neutral'></span>
  9 |     | <span class='neutral'>    modifier onlyOwner() {</span>
 10 |     | <span class='unexecuted'>        require(msg.sender == owner, &quot;Ownable: Caller is not the owner.&quot;);</span>
 11 |     | <span class='neutral'>        _;</span>
 12 |     | <span class='neutral'>    }</span>
 13 |     | <span class='neutral'>}</span>
 14 |     | <span class='neutral'></span>
 15 |     | <span class='unexecuted'>contract Pausable is Ownable {</span>
 16 |     | <span class='neutral'>    bool private _paused;</span>
 17 |     | <span class='neutral'></span>
 18 |     | <span class='unexecuted'>    function paused() public view returns (bool) {</span>
 19 |     | <span class='unexecuted'>        return _paused;</span>
 20 |     | <span class='neutral'>    }</span>
 21 |     | <span class='neutral'></span>
 22 |     | <span class='unexecuted'>    function pause() public onlyOwner {</span>
 23 |     | <span class='unexecuted'>        _paused = true;</span>
 24 |     | <span class='neutral'>    }</span>
 25 |     | <span class='neutral'></span>
 26 |     | <span class='unexecuted'>    function resume() public onlyOwner {</span>
 27 |     | <span class='unexecuted'>        _paused = false;</span>
 28 |     | <span class='neutral'>    }</span>
 29 |     | <span class='neutral'></span>
 30 |     | <span class='neutral'>    modifier whenNotPaused() {</span>
 31 |     | <span class='unexecuted'>        require(!_paused, &quot;Pausable: Contract is paused.&quot;);</span>
 32 |     | <span class='neutral'>        _;</span>
 33 |     | <span class='neutral'>    }</span>
 34 |     | <span class='neutral'>}</span>
 35 |     | <span class='neutral'></span>
 36 |     | <span class='unexecuted'>contract Token is Ownable, Pausable {</span>
 37 |     | <span class='unexecuted'>    mapping(address =&gt; uint256) public balances;</span>
 38 |     | <span class='neutral'></span>
 39 |     | <span class='unexecuted'>    function transfer(address to, uint256 value) public whenNotPaused {</span>
 40 |     | <span class='unexecuted'>        balances[msg.sender] -= value;</span>
 41 |     | <span class='unexecuted'>        balances[to] += value;</span>
 42 |     | <span class='neutral'>    }</span>
 43 |     | <span class='neutral'>}</span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise4/testToken.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>import &quot;./token.sol&quot;;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='unexecuted'>contract testToken is Token {</span>
  7 |     | <span class='neutral'>    </span>
  8 |     | <span class='unexecuted'>    function transfer(address to, uint256 value) public override{</span>
  9 |     | <span class='unexecuted'>        uint256 intialBalOfSender = balances[msg.sender];</span>
 10 |     | <span class='unexecuted'>        uint256 intialBalOfReciever = balances[to];</span>
 11 |     | <span class='unexecuted'>        super.transfer(to,value);</span>
 12 |     | <span class='unexecuted'>        assert(intialBalOfSender &gt;= balances[msg.sender]);</span>
 13 |     | <span class='unexecuted'>        assert(intialBalOfReciever &lt;= balances[to]);</span>
 14 |     | <span class='neutral'>    }</span>
 15 |     | <span class='neutral'>}</span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise4/token.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='unexecuted'>contract Ownable {</span>
  5 |     | <span class='unexecuted'>    address public owner = msg.sender;</span>
  6 |     | <span class='neutral'></span>
  7 |     | <span class='unexecuted'>    function transferOwnership(address newOwner) public onlyOwner {</span>
  8 |     | <span class='unexecuted'>        owner = newOwner;</span>
  9 |     | <span class='neutral'>    }</span>
 10 |     | <span class='neutral'></span>
 11 |     | <span class='neutral'>    modifier onlyOwner() {</span>
 12 |     | <span class='unexecuted'>        require(msg.sender == owner, &quot;Ownable: Caller is not the owner.&quot;);</span>
 13 |     | <span class='neutral'>        _;</span>
 14 |     | <span class='neutral'>    }</span>
 15 |     | <span class='neutral'>}</span>
 16 |     | <span class='neutral'></span>
 17 |     | <span class='unexecuted'>contract Pausable is Ownable {</span>
 18 |     | <span class='neutral'>    bool private _paused;</span>
 19 |     | <span class='neutral'></span>
 20 |     | <span class='unexecuted'>    function paused() public view returns (bool) {</span>
 21 |     | <span class='unexecuted'>        return _paused;</span>
 22 |     | <span class='neutral'>    }</span>
 23 |     | <span class='neutral'></span>
 24 |     | <span class='unexecuted'>    function pause() public onlyOwner {</span>
 25 |     | <span class='unexecuted'>        _paused = true;</span>
 26 |     | <span class='neutral'>    }</span>
 27 |     | <span class='neutral'></span>
 28 |     | <span class='unexecuted'>    function resume() public onlyOwner {</span>
 29 |     | <span class='unexecuted'>        _paused = false;</span>
 30 |     | <span class='neutral'>    }</span>
 31 |     | <span class='neutral'></span>
 32 |     | <span class='neutral'>    modifier whenNotPaused() {</span>
 33 |     | <span class='unexecuted'>        require(!_paused, &quot;Pausable: Contract is paused.&quot;);</span>
 34 |     | <span class='neutral'>        _;</span>
 35 |     | <span class='neutral'>    }</span>
 36 |     | <span class='neutral'>}</span>
 37 |     | <span class='neutral'></span>
 38 |     | <span class='unexecuted'>contract Token is Ownable, Pausable {</span>
 39 |     | <span class='neutral'></span>
 40 |     | <span class='unexecuted'>    mapping(address =&gt; uint256) public balances;</span>
 41 |     | <span class='neutral'></span>
 42 |     | <span class='unexecuted'>    function transfer(address to, uint256 value) public virtual whenNotPaused {</span>
 43 |     | <span class='neutral'>        // require(balances[msg.sender] &gt;= value ,&quot;Insuffcient balance&quot;) ;</span>
 44 |     | <span class='neutral'>        // @audit just remove the unchecked keyword or add reuiqre statement above to check underflow and overflow </span>
 45 |     | <span class='neutral'>        // unchecked to save gas</span>
 46 |     | <span class='neutral'>        unchecked {</span>
 47 |     | <span class='unexecuted'>            balances[msg.sender] -= value;</span>
 48 |     | <span class='unexecuted'>            balances[to] += value;</span>
 49 |     | <span class='neutral'>        }</span>
 50 |     | <span class='neutral'>    }</span>
 51 |     | <span class='neutral'>}</span>
 52 |     | <span class='neutral'></span>
 53 |     | <span class='neutral'>// @audit here there could be underflow issue for line 44,45</span>
 54 |     | <span class='neutral'>// msg.sender must have its initial balance or less.</span>
 55 |     | <span class='neutral'>// to must have its initial balance or more.</span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise5/EchidnaTest.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'></span>
  3 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  4 |     | <span class='neutral'></span>
  5 |     | <span class='neutral'>import &quot;./FlashLoanReceiver.sol&quot;;</span>
  6 |     | <span class='neutral'>import &quot;./NaiveReceiverLenderPool.sol&quot;;</span>
  7 |     | <span class='neutral'>import &quot;@openzeppelin/contracts/utils/Address.sol&quot;;</span>
  8 |     | <span class='neutral'></span>
  9 | *   | <span class='executed'>contract EchidnaTest {</span>
 10 |     | <span class='neutral'></span>
 11 |     | <span class='neutral'>    using Address for address payable;</span>
 12 |     | <span class='neutral'></span>
 13 |     | <span class='neutral'>    NaiveReceiverLenderPool  naiveReceiverLenderPool;</span>
 14 |     | <span class='neutral'>    FlashLoanReceiver  flashLoanReceiver ;</span>
 15 |     | <span class='neutral'></span>
 16 | *   | <span class='executed'>    uint256 public poolBalance = 1000 ether;</span>
 17 | *   | <span class='executed'>    uint256 public userBalance = 10 ether;</span>
 18 |     | <span class='neutral'></span>
 19 |     | <span class='neutral'>    // the lender pool should have 1000 eth of bal </span>
 20 |     | <span class='neutral'>    // The flashloan reciever also has a bal</span>
 21 |     | <span class='neutral'>    constructor() payable {</span>
 22 | *   | <span class='executed'>        naiveReceiverLenderPool = new NaiveReceiverLenderPool();</span>
 23 | *   | <span class='executed'>        payable(address(naiveReceiverLenderPool)).sendValue(poolBalance);</span>
 24 | *   | <span class='executed'>        flashLoanReceiver = new FlashLoanReceiver(payable(address(naiveReceiverLenderPool)));</span>
 25 |     | <span class='neutral'></span>
 26 |     | <span class='neutral'>        // address(this).balance = 2000 ether;</span>
 27 |     | <span class='neutral'>        // naiveReceiverLenderPool.receive(poolBalance);</span>
 28 |     | <span class='neutral'>        // (bool success,) = payable(address(naiveReceiverLenderPool)).call{value: poolBalance}(&quot;&quot;);</span>
 29 |     | <span class='neutral'>        // require(success, &quot;Failed to fund the pool&quot;);</span>
 30 |     | <span class='neutral'></span>
 31 |     | <span class='neutral'>        // (success, ) = payable(address(flashLoanReceiver)).call{value: userBalance}(&quot;&quot;);</span>
 32 |     | <span class='neutral'>        // require(success, &quot;Failed to fund the flash loan receiver&quot;);</span>
 33 |     | <span class='neutral'></span>
 34 |     | <span class='neutral'>        </span>
 35 | *   | <span class='executed'>        payable(address(flashLoanReceiver)).sendValue(userBalance);</span>
 36 |     | <span class='neutral'></span>
 37 |     | <span class='neutral'>    }</span>
 38 |     | <span class='neutral'></span>
 39 |     | <span class='unexecuted'>    function echidna_test_flashloan_fail() public returns(bool) {</span>
 40 |     | <span class='unexecuted'>        naiveReceiverLenderPool.flashLoan(address(flashLoanReceiver),10 ether);</span>
 41 |     | <span class='unexecuted'>        return true;</span>
 42 |     | <span class='neutral'>    }</span>
 43 |     | <span class='neutral'></span>
 44 |     | <span class='neutral'>    // function echidna_test_flashloan_fail_dynamic(uint256 amount) public returns(bool) {</span>
 45 |     | <span class='neutral'>    //     naiveReceiverLenderPool.flashLoan(address(flashLoanReceiver),amount);</span>
 46 |     | <span class='neutral'>    //     return true;</span>
 47 |     | <span class='neutral'>    // }</span>
 48 |     | <span class='neutral'></span>
 49 |     | <span class='neutral'>}</span>
 50 |     | <span class='neutral'></span>
 51 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise5/FlashLoanReceiver.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'></span>
  3 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  4 |     | <span class='neutral'></span>
  5 |     | <span class='neutral'>import &quot;@openzeppelin/contracts/utils/Address.sol&quot;;</span>
  6 |     | <span class='neutral'></span>
  7 |     | <span class='neutral'>/**</span>
  8 |     | <span class='neutral'> * @title FlashLoanReceiver</span>
  9 |     | <span class='neutral'> * @author Damn Vulnerable DeFi (https://damnvulnerabledefi.xyz)</span>
 10 |     | <span class='neutral'> */</span>
 11 | *r  | <span class='executed'>contract FlashLoanReceiver {</span>
 12 |     | <span class='neutral'>    using Address for address payable;</span>
 13 |     | <span class='neutral'></span>
 14 |     | <span class='neutral'>    address payable private pool;</span>
 15 |     | <span class='neutral'></span>
 16 | *   | <span class='executed'>    constructor(address payable poolAddress) {</span>
 17 | *   | <span class='executed'>        pool = poolAddress;</span>
 18 |     | <span class='neutral'>    }</span>
 19 |     | <span class='neutral'></span>
 20 |     | <span class='neutral'>    // Function called by the pool during flash loan</span>
 21 | *   | <span class='executed'>    function receiveEther(uint256 fee) public payable {</span>
 22 | *r  | <span class='executed'>        require(msg.sender == pool, &quot;Sender must be pool&quot;);</span>
 23 |     | <span class='neutral'></span>
 24 | *   | <span class='executed'>        uint256 amountToBeRepaid = msg.value + fee;</span>
 25 |     | <span class='neutral'></span>
 26 | *   | <span class='executed'>        require(address(this).balance &gt;= amountToBeRepaid, &quot;Cannot borrow that much&quot;);</span>
 27 |     | <span class='neutral'>        </span>
 28 | *   | <span class='executed'>        _executeActionDuringFlashLoan();</span>
 29 |     | <span class='neutral'>        </span>
 30 |     | <span class='neutral'>        // Return funds to pool</span>
 31 | *   | <span class='executed'>        pool.sendValue(amountToBeRepaid);</span>
 32 |     | <span class='neutral'>    }</span>
 33 |     | <span class='neutral'></span>
 34 |     | <span class='neutral'>    // Internal function where the funds received are used</span>
 35 | *   | <span class='executed'>    function _executeActionDuringFlashLoan() internal { }</span>
 36 |     | <span class='neutral'></span>
 37 |     | <span class='neutral'>    // Allow deposits of ETH</span>
 38 |     | <span class='neutral'>    receive () external payable {}</span>
 39 |     | <span class='neutral'>}</span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise5/NaiveReceiverLenderPool.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>import &quot;@openzeppelin/contracts/utils/ReentrancyGuard.sol&quot;;</span>
  5 |     | <span class='neutral'>import &quot;@openzeppelin/contracts/utils/Address.sol&quot;;</span>
  6 |     | <span class='neutral'></span>
  7 |     | <span class='neutral'>/**</span>
  8 |     | <span class='neutral'> * @title NaiveReceiverLenderPool</span>
  9 |     | <span class='neutral'> * @author Damn Vulnerable DeFi (https://damnvulnerabledefi.xyz)</span>
 10 |     | <span class='neutral'> */</span>
 11 | *r  | <span class='executed'>contract NaiveReceiverLenderPool is ReentrancyGuard {</span>
 12 |     | <span class='neutral'></span>
 13 |     | <span class='neutral'>    using Address for address;</span>
 14 |     | <span class='neutral'></span>
 15 | *   | <span class='executed'>    uint256 private constant FIXED_FEE = 1 ether; // not the cheapest flash loan</span>
 16 |     | <span class='neutral'></span>
 17 | *   | <span class='executed'>    function fixedFee() external pure returns (uint256) {</span>
 18 | *   | <span class='executed'>        return FIXED_FEE;</span>
 19 |     | <span class='neutral'>    }</span>
 20 |     | <span class='neutral'></span>
 21 | *   | <span class='executed'>    function flashLoan(address borrower, uint256 borrowAmount) external nonReentrant {</span>
 22 |     | <span class='neutral'></span>
 23 | *   | <span class='executed'>        uint256 balanceBefore = address(this).balance;</span>
 24 | *r  | <span class='executed'>        require(balanceBefore &gt;= borrowAmount, &quot;Not enough ETH in pool&quot;);</span>
 25 |     | <span class='neutral'></span>
 26 |     | <span class='neutral'></span>
 27 | *r  | <span class='executed'>        require(borrower.isContract(), &quot;Borrower must be a deployed contract&quot;);</span>
 28 |     | <span class='neutral'>        // Transfer ETH and handle control to receiver</span>
 29 | *   | <span class='executed'>        borrower.functionCallWithValue(</span>
 30 | *   | <span class='executed'>            abi.encodeWithSignature(</span>
 31 |     | <span class='neutral'>                &quot;receiveEther(uint256)&quot;,</span>
 32 |     | <span class='neutral'>                FIXED_FEE</span>
 33 |     | <span class='neutral'>            ),</span>
 34 | *   | <span class='executed'>            borrowAmount</span>
 35 |     | <span class='neutral'>        );</span>
 36 |     | <span class='neutral'>        </span>
 37 | *   | <span class='executed'>        require(</span>
 38 | *   | <span class='executed'>            address(this).balance &gt;= balanceBefore + FIXED_FEE,</span>
 39 |     | <span class='neutral'>            &quot;Flash loan hasn&#39;t been paid back&quot;</span>
 40 |     | <span class='neutral'>        );</span>
 41 |     | <span class='neutral'>    }</span>
 42 |     | <span class='neutral'></span>
 43 |     | <span class='neutral'>    // Allow deposits of ETH</span>
 44 |     | <span class='neutral'>    receive () external payable {}</span>
 45 |     | <span class='neutral'>}</span>
 46 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise6/CustomERC20.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'></span>
  3 |     | <span class='neutral'>pragma solidity ^0.8.20;</span>
  4 |     | <span class='neutral'></span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>import {ERC20} from &quot;@openzeppelin/contracts/token/ERC20/ERC20.sol&quot;;</span>
  7 |     | <span class='neutral'></span>
  8 |     | <span class='unexecuted'>contract CustomERC20 is ERC20   {</span>
  9 |     | <span class='neutral'></span>
 10 |     | <span class='unexecuted'>    constructor() ERC20(&quot;damn&quot;,&quot;dd&quot;) {</span>
 11 |     | <span class='unexecuted'>        _mint(msg.sender,type(uint256).max);</span>
 12 |     | <span class='neutral'>    }</span>
 13 |     | <span class='neutral'>}</span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise6/DamnValuableToken.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'></span>
  3 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  4 |     | <span class='neutral'></span>
  5 |     | <span class='neutral'>import &quot;@openzeppelin/contracts/token/ERC20/ERC20.sol&quot;;</span>
  6 |     | <span class='neutral'></span>
  7 |     | <span class='neutral'>/**</span>
  8 |     | <span class='neutral'> * @title DamnValuableToken</span>
  9 |     | <span class='neutral'> * @author Damn Vulnerable DeFi (https://damnvulnerabledefi.xyz)</span>
 10 |     | <span class='neutral'> */</span>
 11 |     | <span class='unexecuted'>contract DamnValuableToken is ERC20 {</span>
 12 |     | <span class='neutral'></span>
 13 |     | <span class='neutral'>    // Decimals are set to 18 by default in `ERC20`</span>
 14 |     | <span class='unexecuted'>    constructor() ERC20(&quot;DamnValuableToken&quot;, &quot;DVT&quot;) {</span>
 15 |     | <span class='unexecuted'>        _mint(msg.sender, type(uint256).max);</span>
 16 |     | <span class='neutral'>    }</span>
 17 |     | <span class='neutral'>}</span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise6/EchidnaTest.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'></span>
  3 |     | <span class='neutral'>pragma solidity ^0.8.20;</span>
  4 |     | <span class='neutral'></span>
  5 |     | <span class='neutral'>import &quot;./ReceiverUnstoppable.sol&quot;;</span>
  6 |     | <span class='neutral'>// import {ERC20} from &quot;@openzeppelin/contracts/token/ERC20/ERC20.sol&quot;;</span>
  7 |     | <span class='neutral'>import &quot;./DamnValuableToken.sol&quot;;</span>
  8 |     | <span class='neutral'>import &quot;./UnstoppableLender.sol&quot;;</span>
  9 |     | <span class='neutral'></span>
 10 |     | <span class='neutral'></span>
 11 |     | <span class='unexecuted'>contract EchidnaTest {</span>
 12 |     | <span class='neutral'></span>
 13 |     | <span class='unexecuted'>    address setOwner = msg.sender;</span>
 14 |     | <span class='unexecuted'>    IERC20 public damnValuableToken;</span>
 15 |     | <span class='unexecuted'>    ReceiverUnstoppable public receiverUnstoppable;</span>
 16 |     | <span class='unexecuted'>    UnstoppableLender public unstoppableLender;</span>
 17 |     | <span class='unexecuted'>    uint256 public INITIAL_BAL_In_POOL = 100000;</span>
 18 |     | <span class='unexecuted'>    uint256 public BAL_OF_USER = 100;</span>
 19 |     | <span class='neutral'>    uint256 balanceBefore ;</span>
 20 |     | <span class='neutral'></span>
 21 |     | <span class='unexecuted'>    constructor(){</span>
 22 |     | <span class='unexecuted'>        damnValuableToken = new DamnValuableToken();</span>
 23 |     | <span class='unexecuted'>        unstoppableLender = new UnstoppableLender(address(damnValuableToken));</span>
 24 |     | <span class='unexecuted'>        receiverUnstoppable = new ReceiverUnstoppable(address(unstoppableLender));</span>
 25 |     | <span class='neutral'></span>
 26 |     | <span class='unexecuted'>        damnValuableToken.approve(address(unstoppableLender), INITIAL_BAL_In_POOL);</span>
 27 |     | <span class='unexecuted'>        unstoppableLender.depositTokens(INITIAL_BAL_In_POOL);</span>
 28 |     | <span class='neutral'></span>
 29 |     | <span class='unexecuted'>        damnValuableToken.transfer(setOwner,BAL_OF_USER);</span>
 30 |     | <span class='unexecuted'>        balanceBefore = damnValuableToken.balanceOf(address(unstoppableLender));</span>
 31 |     | <span class='neutral'>    }</span>
 32 |     | <span class='neutral'></span>
 33 |     | <span class='unexecuted'>    function receiveTokens(address tokenAddress, uint256 amount) external {</span>
 34 |     | <span class='unexecuted'>        require(msg.sender == address(unstoppableLender), &quot;Sender must be pool&quot;);</span>
 35 |     | <span class='neutral'>        // Return all tokens to the pool</span>
 36 |     | <span class='unexecuted'>        require(</span>
 37 |     | <span class='unexecuted'>            IERC20(tokenAddress).transfer(msg.sender, amount),</span>
 38 |     | <span class='neutral'>            &quot;Transfer of tokens failed&quot;</span>
 39 |     | <span class='neutral'>        );</span>
 40 |     | <span class='neutral'>    }</span>
 41 |     | <span class='neutral'></span>
 42 |     | <span class='unexecuted'>    function echidna_poolBal_is_always_equal_to_intialBal() public  returns(bool)  {</span>
 43 |     | <span class='neutral'>        // assert(unstoppableLender.poolBalance() == balanceBefore);</span>
 44 |     | <span class='neutral'>        // require(msg.sender == )</span>
 45 |     | <span class='unexecuted'>        unstoppableLender.flashLoan(10);</span>
 46 |     | <span class='neutral'>        // receiverUnstoppable.executeFlashLoan(10);</span>
 47 |     | <span class='unexecuted'>        return true;</span>
 48 |     | <span class='neutral'>    }</span>
 49 |     | <span class='neutral'></span>
 50 |     | <span class='neutral'></span>
 51 |     | <span class='neutral'></span>
 52 |     | <span class='neutral'></span>
 53 |     | <span class='neutral'>}</span>
 54 |     | <span class='neutral'></span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise6/ReceiverUnstoppable.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'></span>
  3 |     | <span class='neutral'>pragma solidity ^0.8.17;</span>
  4 |     | <span class='neutral'></span>
  5 |     | <span class='neutral'>import &quot;./UnstoppableLender.sol&quot;;</span>
  6 |     | <span class='neutral'>import {IERC20} from &quot;@openzeppelin/contracts/token/ERC20/IERC20.sol&quot;;</span>
  7 |     | <span class='neutral'></span>
  8 |     | <span class='neutral'>/**</span>
  9 |     | <span class='neutral'> * @title ReceiverUnstoppable</span>
 10 |     | <span class='neutral'> * @author Damn Vulnerable DeFi (https://damnvulnerabledefi.xyz)</span>
 11 |     | <span class='neutral'> */</span>
 12 |     | <span class='unexecuted'>contract ReceiverUnstoppable {</span>
 13 |     | <span class='neutral'></span>
 14 |     | <span class='neutral'>    UnstoppableLender private immutable pool;</span>
 15 |     | <span class='neutral'>    address private immutable owner;</span>
 16 |     | <span class='neutral'></span>
 17 |     | <span class='unexecuted'>    constructor(address poolAddress) {</span>
 18 |     | <span class='unexecuted'>        pool = UnstoppableLender(poolAddress);</span>
 19 |     | <span class='unexecuted'>        owner = msg.sender;</span>
 20 |     | <span class='neutral'>    }</span>
 21 |     | <span class='neutral'></span>
 22 |     | <span class='neutral'>    // Pool will call this function during the flash loan</span>
 23 |     | <span class='unexecuted'>    function receiveTokens(address tokenAddress, uint256 amount) external {</span>
 24 |     | <span class='unexecuted'>        require(msg.sender == address(pool), &quot;Sender must be pool&quot;);</span>
 25 |     | <span class='neutral'>        // Return all tokens to the pool</span>
 26 |     | <span class='unexecuted'>        require(IERC20(tokenAddress).transfer(msg.sender, amount), &quot;Transfer of tokens failed&quot;);</span>
 27 |     | <span class='neutral'>    }</span>
 28 |     | <span class='neutral'></span>
 29 |     | <span class='unexecuted'>    function executeFlashLoan(uint256 amount) external {</span>
 30 |     | <span class='unexecuted'>        require(msg.sender == owner, &quot;Only owner can execute flash loan&quot;);</span>
 31 |     | <span class='unexecuted'>        pool.flashLoan(amount);</span>
 32 |     | <span class='neutral'>    }</span>
 33 |     | <span class='neutral'>}</span>

</code>
<br />

<b>/Users/gurkiratsingh/Desktop/Fuzzing Exercises/src/Exercise6/UnstoppableLender.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'></span>
  3 |     | <span class='neutral'>pragma solidity ^0.8.20;</span>
  4 |     | <span class='neutral'></span>
  5 |     | <span class='neutral'>import {IERC20} from &quot;@openzeppelin/contracts/token/ERC20/IERC20.sol&quot;;</span>
  6 |     | <span class='neutral'>import {ReentrancyGuard} from &quot;@openzeppelin/contracts/utils/ReentrancyGuard.sol&quot;;</span>
  7 |     | <span class='neutral'></span>
  8 |     | <span class='neutral'>interface IReceiver {</span>
  9 |     | <span class='neutral'>    function receiveTokens(address tokenAddress, uint256 amount) external;</span>
 10 |     | <span class='neutral'>}</span>
 11 |     | <span class='neutral'></span>
 12 |     | <span class='neutral'>/**</span>
 13 |     | <span class='neutral'> * @title UnstoppableLender</span>
 14 |     | <span class='neutral'> * @author Damn Vulnerable DeFi (https://damnvulnerabledefi.xyz)</span>
 15 |     | <span class='neutral'> */</span>
 16 |     | <span class='unexecuted'>contract UnstoppableLender is ReentrancyGuard {</span>
 17 |     | <span class='neutral'></span>
 18 |     | <span class='unexecuted'>    IERC20 public immutable damnValuableToken;</span>
 19 |     | <span class='unexecuted'>    uint256 public poolBalance;</span>
 20 |     | <span class='neutral'></span>
 21 |     | <span class='unexecuted'>    constructor(address tokenAddress) {</span>
 22 |     | <span class='unexecuted'>        require(tokenAddress != address(0), &quot;Token address cannot be zero&quot;);</span>
 23 |     | <span class='unexecuted'>        damnValuableToken = IERC20(tokenAddress);</span>
 24 |     | <span class='neutral'>    }</span>
 25 |     | <span class='neutral'></span>
 26 |     | <span class='unexecuted'>    function depositTokens(uint256 amount) external nonReentrant {</span>
 27 |     | <span class='unexecuted'>        require(amount &gt; 0, &quot;Must deposit at least one token&quot;);</span>
 28 |     | <span class='neutral'>        // Transfer token from sender. Sender must have first approved them.</span>
 29 |     | <span class='unexecuted'>        damnValuableToken.transferFrom(msg.sender, address(this), amount);</span>
 30 |     | <span class='unexecuted'>        poolBalance = poolBalance + amount;</span>
 31 |     | <span class='neutral'>    }</span>
 32 |     | <span class='neutral'></span>
 33 |     | <span class='unexecuted'>    function flashLoan(uint256 borrowAmount) external nonReentrant {</span>
 34 |     | <span class='unexecuted'>        require(borrowAmount &gt; 0, &quot;Must borrow at least one token&quot;);</span>
 35 |     | <span class='neutral'></span>
 36 |     | <span class='unexecuted'>        uint256 balanceBefore = damnValuableToken.balanceOf(address(this));</span>
 37 |     | <span class='unexecuted'>        require(balanceBefore &gt;= borrowAmount, &quot;Not enough tokens in pool&quot;);</span>
 38 |     | <span class='neutral'></span>
 39 |     | <span class='neutral'>        // Ensured by the protocol via the `depositTokens` function</span>
 40 |     | <span class='unexecuted'>        assert(poolBalance == balanceBefore);</span>
 41 |     | <span class='neutral'>        </span>
 42 |     | <span class='unexecuted'>        damnValuableToken.transfer(msg.sender, borrowAmount);</span>
 43 |     | <span class='neutral'>        </span>
 44 |     | <span class='unexecuted'>        IReceiver(msg.sender).receiveTokens(address(damnValuableToken), borrowAmount);</span>
 45 |     | <span class='neutral'>        </span>
 46 |     | <span class='unexecuted'>        uint256 balanceAfter = damnValuableToken.balanceOf(address(this));</span>
 47 |     | <span class='unexecuted'>        require(balanceAfter &gt;= balanceBefore, &quot;Flash loan hasn&#39;t been paid back&quot;);</span>
 48 |     | <span class='neutral'>    }</span>
 49 |     | <span class='neutral'>}</span>
 50 |     | <span class='neutral'></span>

</code>
<br />

